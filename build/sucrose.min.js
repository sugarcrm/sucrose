/*
Copyright 2018 SugarCRM, Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e(t.sucrose={},t.d3)})(this,function(t,Nt){"use strict";function i(e,n,r){return function(){var t=r.apply(n,arguments);return t===n?e:t}}Nt=Nt&&Nt.hasOwnProperty("default")?Nt.default:Nt;var zt={identity:function(t){return t},functor:function t(e){return"function"==typeof e?e:function(){return e}},isFunction:function(t){var e;return t&&"[object Function]"=={}.toString.call(t)},rebind:function(t,e){for(var n=1,r=arguments.length,a;++n<r;)t[a=arguments[n]]=i(t,e,e[a]);return t},optionsFunc:function(t){return t&&Nt.map(t).each(function(t,e){var n=this[e],r=zt.toNative(t);zt.isFunction(n)&&(Array.isArray(r)?n.apply(r):n(r))}.bind(this)),this},windowSize:function(){var t={};return window.innerWidth&&window.innerHeight?(t.width=window.innerWidth,t.height=window.innerHeight):document.body&&document.body.offsetWidth?(t.width=document.body.offsetWidth,t.height=document.body.offsetHeight):"CSS1Compat"===document.compatMode&&document.documentElement&&document.documentElement.offsetWidth?(t.width=document.documentElement.offsetWidth,t.height=document.documentElement.offsetHeight):(t.width=640,t.height=480),t},windowResize:function(t){window.attachEvent?window.attachEvent("onresize",t):window.addEventListener&&window.addEventListener("resize",t,!0)},windowUnResize:function(t){window.detachEvent?window.detachEvent("onresize",t):window.removeEventListener&&window.removeEventListener("resize",t,!0)},resizeOnPrint:function(e){var t;window.matchMedia?window.matchMedia("print").addListener(function(t){t.matches&&e()}):window.attachEvent?window.attachEvent("onbeforeprint",e):window.onbeforeprint=e},unResizeOnPrint:function(e){var t;window.matchMedia?window.matchMedia("print").removeListener(function(t){t.matches&&e()}):window.detachEvent?window.detachEvent("onbeforeprint",e):window.onbeforeprint=null},getColor:function(n){return arguments.length?Array.isArray(n)?function(t,e){return t.color||n[e%n.length]}:"[object String]"===Object.prototype.toString.call(n)?function(t){return t.color||"#"+n.replace("#","")}:n:zt.defaultColor()},defaultColor:function(){var n=Nt.scaleOrdinal(Nt.schemeCategory20).range();return function(t,e){return t.color||n[e%n.length]}},getTextContrast:function(t,e,n){var r=t,a=Nt.lab(r),i=a.l,o=60<i?a.darker(4+(i-75)/25).l:a.brighter(4+(18-i)/25).l,l=Nt.lab(o,0,0),s=l.toString();return n&&n(a,l),s},customTheme:function(n,r,a){var i;return r=r||function(t){return t.key},a=a||Nt.scaleOrdinal(Nt.schemeCategory20).range(),i=a.length,function(t){var e=r(t);return i||(i=a.length),void 0!==n[e]?"function"==typeof n[e]?n[e]():n[e]:a[--i]}},colorLinearGradient:function(t,e,n,r,a){var i="lg_gradient_"+e,o;return a.select("#"+i).empty()&&("middle"===n.position?zt.createLinearGradient(i,n,a,[{offset:"0%","stop-color":Nt.rgb(r).darker().toString(),"stop-opacity":1},{offset:"20%","stop-color":Nt.rgb(r).toString(),"stop-opacity":1},{offset:"50%","stop-color":Nt.rgb(r).brighter().toString(),"stop-opacity":1},{offset:"80%","stop-color":Nt.rgb(r).toString(),"stop-opacity":1},{offset:"100%","stop-color":Nt.rgb(r).darker().toString(),"stop-opacity":1}]):zt.createLinearGradient(i,n,a,[{offset:"0%","stop-color":Nt.rgb(r).darker().toString(),"stop-opacity":1},{offset:"50%","stop-color":Nt.rgb(r).toString(),"stop-opacity":1},{offset:"100%","stop-color":Nt.rgb(r).brighter().toString(),"stop-opacity":1}])),"url(#"+i+")"},createLinearGradient:function(t,e,n,r){var a="horizontal"===e.orientation?"0%":"100%",i="horizontal"===e.orientation?"100%":"0%",o,l,s=n.append("linearGradient");s.attr("id",t).attr("x1","0%").attr("y1","0%").attr("x2",a).attr("y2",i).attr("spreadMethod","pad");for(var c=0;c<r.length;c+=1)o=r[c],l=s.append("stop"),Object.getOwnPropertyNames(o).forEach(function(t){l.attr(t,o[t])})},colorRadialGradient:function(t,e,n,r,a){var i="rg_gradient_"+e,o;return a.select("#"+i).empty()&&zt.createRadialGradient(i,n,a,[{offset:n.s,"stop-color":Nt.rgb(r).brighter().toString(),"stop-opacity":1},{offset:"100%","stop-color":Nt.rgb(r).darker().toString(),"stop-opacity":1}]),"url(#"+i+")"},createRadialGradient:function(t,e,n,r){var a,i,o;o=n.append("radialGradient").attr("id",t).attr("r",e.r).attr("cx",e.x).attr("cy",e.y).attr("gradientUnits",e.u).attr("spreadMethod","pad");for(var l=0;l<r.length;l+=1)a=r[l],i=o.append("stop"),Object.getOwnPropertyNames(a).forEach(function(t){i.attr(t,a[t])})},roundedRectangle:function(t,e,n,r,a){var i;return"M"+t+","+e+"h"+(n-2*a)+"a"+a+","+a+" 0 0 1 "+a+","+a+"v"+(r-2-2*a)+"a"+a+","+a+" 0 0 1 "+-a+","+a+"h"+(2*a-n)+"a"+-a+","+a+" 0 0 1 "+-a+","+-a+"v"+(2*a-r+2)+"a"+a+","+a+" 0 0 1 "+a+","+-a+"z"},dropShadow:function(t,e,n){var r=n||{},a=r.height||"130%",i=r.offset||2,o=r.blur||1,l,s;return e.select("#"+t).empty()&&((l=e.append("filter").attr("id",t).attr("height",a)).append("feOffset").attr("in","SourceGraphic").attr("result","offsetBlur").attr("dx",i).attr("dy",i),l.append("feColorMatrix").attr("in","offsetBlur").attr("result","matrixOut").attr("type","matrix").attr("values","1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0"),l.append("feGaussianBlur").attr("in","matrixOut").attr("result","blurOut").attr("stdDeviation",o),(s=l.append("feMerge")).append("feMergeNode"),s.append("feMergeNode").attr("in","SourceGraphic")),"url(#"+t+")"},createTexture:function(t,e,n,r){var a="#sc-diagonalHatch-"+e,i="#sc-textureMask-"+e;return t.append("pattern").attr("id","sc-diagonalHatch-"+e).attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).append("path").attr("d","M-1,1 l2,-2 M0,8 l8,-8 M7,9 l1,-1").attr("class","texture-line").attr("stroke","#fff").attr("stroke-linecap","square"),t.append("mask").attr("id","sc-textureMask-"+e).attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").append("rect").attr("x",n||0).attr("y",r||-1).attr("width","100%").attr("height","100%").attr("fill","url("+a+")"),i},stringSetLengths:function(t,e,n){var r=[],a=e.select(".tmp-text-strings").select("text");return a.empty()&&(a=e.append("g").attr("class","tmp-text-strings").append("text")),a.classed(n,!0),a.style("display","inline"),t.forEach(function(t){a.text(t),r.push(a.node().getBoundingClientRect().width)}),a.text("").attr("class","tmp-text-strings").style("display","none"),r},stringSetThickness:function(t,e,n){var r=[],a=e.select(".tmp-text-strings").select("text");return a.empty()&&(a=e.append("g").attr("class","tmp-text-strings").append("text")),a.classed(n,!0),a.style("display","inline"),t.forEach(function(t){a.text(t),r.push(a.node().getBoundingClientRect().height)}),a.text("").attr("class","tmp-text-strings").style("display","none"),r},maxStringSetLength:function(t,e,n,r){var a=zt.stringSetLengths(t,e,n,r);return Nt.max(a)},stringEllipsify:function(t,e,n){var r=e.select(".tmp-text-strings").select("text"),a=t,i=0,o=0,l=0;for(r.empty()&&(r=e.append("g").attr("class","tmp-text-strings").append("text")),r.style("display","inline"),r.text("..."),o=r.node().getBoundingClientRect().width,r.text(a),l=i=r.node().getBoundingClientRect().width;n<i&&30<i;)a=a.slice(0,-1),r.text(a),i=r.node().getBoundingClientRect().width+o;return r.text(""),a+(n<l?"...":"")},getTextBBox:function(t,e){var n=t.node().getBoundingClientRect(),r;return{width:e?n.width:parseInt(n.width,10),height:e?n.height:parseInt(n.height,10),top:e?n.top:parseInt(n.top,10),left:e?n.left:parseInt(n.left,10)}},strip:function(t){return t.replace(/(\s|&)/g,"")},isRTLChar:function(t){var e,n;return new RegExp("["+"֑-߿יִ-﷿ﹰ-ﻼ"+"]").test(t)},NaNtoZero:function(t){return zt.isNumeric(t)?t:0},polarToCartesian:function(t,e,n,r){var a=zt.angleToRadians(r),i,o;return[t+n*Math.cos(a),e+n*Math.sin(a)]},angleToRadians:function(t){return t*Math.PI/180},angleToDegrees:function(t){return 180*t/Math.PI},getAbsoluteXY:function(t){var e=document.documentElement,n=t.getBoundingClientRect(),r=e.scrollLeft+document.body.scrollLeft,a=e.scrollTop+document.body.scrollTop,i,o;return{left:n.left+r,top:n.top+a}},translation:function(t,e){return"translate("+t+","+e+")"},isNumeric:function(t){var e=parseFloat(t);return!isNaN(e)&&"number"==typeof e&&isFinite(e)},toNative:function(t){var e;return zt.isNumeric(parseFloat(t))?parseFloat(t):"true"===t||"false"!==t&&t},toBoolean:function(t){var e;return zt.isNumeric(parseFloat(t))?!!parseFloat(t):"true"===t||"false"!==t&&t},round:function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n},countSigFigsAfter:function(t){var e=/^[^\d]*([\d.,\s]+)[^\d]*$/,n=t.toString().match(e)[1].replace(/[,\s]/,"."),r=0;return Math.floor(n)!==parseFloat(n)&&(r=parseFloat(n).toString().split(".").pop().length||0),r},countSigFigsBefore:function(t){return Math.floor(t).toString().replace(/0+$/g,"").length},siDecimal:function(t){return Math.pow(10,Math.floor(Math.log(t)*Math.LOG10E))},siValue:function(t){return zt.isNumeric(t)?zt.siDecimal(t):{y:1e-24,yocto:1e-24,z:1e-21,zepto:1e-21,a:1e-18,atto:1e-18,f:1e-15,femto:1e-15,p:1e-12,pico:1e-12,n:1e-9,nano:1e-9,"µ":1e-6,micro:1e-6,m:.001,milli:.001,k:1e3,kilo:1e3,M:1e6,mega:1e6,G:1e9,giga:1e9,T:1e12,tera:1e12,P:1e15,peta:1e15,E:1e18,exa:1e18,Z:1e21,zetta:1e21,Y:1e24,yotta:1e24}[t]||0;var e},numberFormat:function(t,e,n,r){var a,i,o,l,s,c;return a=parseFloat(t),i="boolean"==typeof n&&n,!zt.isNumeric(a)||0===a&&!i?t.toString():(o=zt.countSigFigsAfter(a),l=zt.isNumeric(e)?Math.floor(e):void 0!==r?r.precision:i?2:null,l=zt.isNumeric(l)?o&&i?l:Math.min(l,o):o,c=i?"$,":",",(s=void 0===r?Nt.format:Nt.formatLocale(r).format)(c+=o?"."+l+"f":"")(a))},numberFormatFixed:function(t,e,n,r){var a,i;return zt.isNumeric(t)?(n="boolean"==typeof n&&n,e=zt.isNumeric(e)?e:n?2:0,i=n?"$,":",",(a=void 0===r?Nt.format:Nt.formatLocale(r).format)(i+="."+e+"f")(t)):t.toString()},numberFormatSI:function(t,e,n,r){var a,i,o;if(!zt.isNumeric(t))return t;if(n="boolean"==typeof n&&n,e=zt.isNumeric(e)?e:0,a=void 0===r?Nt.format:Nt.formatLocale(r).format,o=zt.countSigFigsAfter(t),i=n?"$,":",",n&&o&&t<1e3)t=zt.round(t,e),o=zt.countSigFigsAfter(t),1===(e=Math.min(o,e))&&(e=2),i+="."+e+"f";else if(Math.abs(t)<1)i+=0==+t.toFixed(e)?".1s":"."+Math.min(e,o)+"f";else{if(!(Math.abs(t)<1e3)){if(a=void 0===r?Nt.formatPrefix:Nt.formatLocale(r).formatPrefix,0!==e){var l,s=a("."+e+"s",t)(t).split(".").pop().replace(/[^\d]+$/,"").match(/0+$/g);Array.isArray(s)&&(e-=s.pop().length)}return a(i+="."+e+"s",t)(t)}t=zt.round(t,e)}return a(i)(t)},numberFormatSIFixed:function(t,e,n,r,a){var i,o;return zt.isNumeric(t)?(n="boolean"==typeof n&&n,e=zt.isNumeric(e)?e:n?2:0,o=n?"$,":",",(i=void 0===r?Nt.formatPrefix:Nt.formatLocale(r).formatPrefix)(o+="."+e+"s",a=zt.siValue(a))(t)):t.toString()},numberFormatPercent:function(t,e,n){var r,a,i,o;return r=parseFloat(e),a=zt.isNumeric(r)&&0<r?100*t/r:100,o=n&&void 0!==n.precision?n.precision:1,(i=zt.numberFormat(a,o,!1,n))+"%"},daysInMonth:function(t,e){return new Date(e,t+1,0).getDate()},isValidDate:function(t){return!!t&&(t instanceof Date&&!isNaN(t.valueOf()))},parseDatetime:function(t){var e;return zt.isNumeric(Math.floor(t))&&4===t.toString().length?e=new Date(Math.floor(t)+"-1-1 GMT"):parseInt(t,10).toString()===t||parseInt(t,10)===t?e=new Date(parseInt(t,10)):(e=new Date(t),"Z"===t.toString().substr(-1)||-1!==t.toString().indexOf("GMT")||t.toString().match(/\d\d\d\d-\d\d-\d\dT/)||e.setUTCMilliseconds(e.getUTCMilliseconds()-6e4*e.getTimezoneOffset())),zt.isValidDate(e)||(e=t),e},getDateFormat:function(t,r){var e,n;return["multi","%x, %I:%M:%S.%L %p","%x, %I:%M:%S %p","%x, %I:%M %p","%x, %I %p","%x","%b %d","%B %Y","%Y"][t.length?Nt.min(t,function(t){!0===r&&t.setUTCMilliseconds(t.getUTCMilliseconds()+6e4*t.getTimezoneOffset());var e=new Date(t),n;return n=+Nt.timeSecond(t)<+e?1:+Nt.timeMinute(t)<+e?2:+Nt.timeHour(t)<+e?3:+Nt.timeDay(t)<+e?4:+Nt.timeMonth(t)<+e?5:+Nt.timeYear(t)<+e?7:8}):8]},getDateFormatUTC:function(t){var e,n;return["multi","%x, %I:%M:%S.%L %p","%x, %I:%M:%S %p","%x, %I:%M %p","%x, %I %p","%x","%b %d","%B %Y","%Y"][t.length?Nt.min(t,function(t){var e=new Date(t),n;return n=+Nt.utcSecond(t)<+e?1:+Nt.utcMinute(t)<+e?2:+Nt.utcHour(t)<+e?3:+Nt.utcDay(t)<+e?4:+Nt.utcMonth(t)<+e?5:+Nt.utcYear(t)<+e?7:8}):8]},multiFormat:function(t,e){return!1===e?zt.getDateFormat([t]):zt.getDateFormatUTC([t])},dateFormat:function(t,e,n){var r,a,i,o=zt.parseDatetime(t);return zt.isValidDate(o)?(n&&n.hasOwnProperty("utcFormat")?(a=n.utcFormat,i=e?-1!==e.indexOf("%")?e:zt.multiFormat(o):"%Y"):(r=zt.buildLocality(n),a=Nt.timeFormatLocale(r).utcFormat,i=e?-1!==e.indexOf("%")?e:r[e]||zt.multiFormat(o):"%Y"),a(i)(o)):t},buildLocality:function(t,e){var n=t||{},r=!!e,a=function(t){return t.join("|").split("|").map(function(t){return t?isNaN(t)?t:+t:""})},i={decimal:".",thousands:",",grouping:[3],currency:["$",""],precision:2,periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],date:"%b %-d, %Y",time:"%-I:%M:%S %p",dateTime:"%B %-d, %Y at %X GMT%Z",full:"%A, %c",long:"%c",medium:"%x, %X",short:"%-m/%-d/%y, %-I:%M %p",yMMMEd:"%a, %x",yMEd:"%a, %-m/%-d/%Y",yMMMMd:"%B %-d, %Y",yMMMd:"%x",yMd:"%-m/%-d/%Y",yMMMM:"%B %Y",yMMM:"%b %Y",MMMd:"%b %-d",MMMM:"%B",MMM:"%b",y:"%Y"};return Object.getOwnPropertyNames(n).forEach(function(t){var e=n[t];i[t]=r&&Array.isArray(e)?a(e):e}),i},displayNoData:function(t,e,n,r,a){var i=t?[]:[n],o=e.selectAll(".sc-no-data").data(i),l=o.enter().append("text").attr("class","sc-no-data").attr("dy","-.7em").style("text-anchor","middle"),s=e.selectAll(".sc-no-data").merge(l);return o.exit().remove(),!!i.length&&(s.attr("x",r).attr("y",a).text(zt.identity),e.selectAll(".sc-chart-wrap").remove(),!0)}},xt=function(){function r(t,n,r){return t.replace(/>\s+</gm,"><").replace(/{{(\w+)}}/gm,function(t,e){return n[e]||e}).replace(/{{str\s([\w.]+)}}/gm,function(t,e){return r.translate(e)})}return{show:function(t,e,n,r,a,i){var o=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div");return n=n||"s",r=r||5,l.className="tooltip-inner",s.className="tooltip-arrow",l.innerHTML=e,o.style.left=0,o.style.top=-1e3,o.style.opacity=0,o.className=(i||"sc-tooltip")+" tooltip xy-tooltip in",o.appendChild(l),o.appendChild(s),a.appendChild(o),xt.position(a,o,t,n,r),o.style.opacity=1,o},cleanup:function(){for(var t=document.getElementsByClassName("tooltip"),e=[],n=t.length;0<n;)-1!==t[n-=1].className.indexOf("xy-tooltip")&&(e.push(t[n]),t[n].style.transitionDelay="0 !important",t[n].style.opacity=0,t[n].className="sctooltip-pending-removal out");setTimeout(function(){for(var t;e.length;)(t=e.pop()).parentNode.removeChild(t)},500)},position:function(t,r,e,n,a){n=n||"s",a=a||5;var i=t.getBoundingClientRect(),o=[e.clientX-i.left,e.clientY-i.top],l=parseInt(r.offsetWidth,10),s=parseInt(r.offsetHeight,10),c=t.clientWidth,u=t.clientHeight,d=t.scrollLeft,f=t.scrollTop,h=r.className.replace(/ top| right| bottom| left/g,""),p,g;function m(){var t=o[0]-l/2;return t<d&&(t=d),c<t+l&&(t=c-l),t}function v(){var t=o[1]-s/2;return t<f&&(t=f),f+u<t+s&&(t=f-s),t}function y(t){var e=o[0]-l/2-t-5,n;r.getElementsByClassName("tooltip-arrow")[0].style.marginLeft=e+"px"}function b(t){var e=o[1]-s/2-t-5,n;r.getElementsByClassName("tooltip-arrow")[0].style.marginTop=e+"px"}switch(n){case"e":g=v(),p=o[0]-l-a,b(g),p<d?(p=o[0]+a,h+=" right"):h+=" left";break;case"w":g=v(),p=o[0]+a,b(g),c<p+l?(p=o[0]-l-a,h+=" left"):h+=" right";break;case"n":p=m(),g=o[1]+a,y(p),f+u<g+s?(g=o[1]-s-a,h+=" top"):h+=" bottom";break;case"s":p=m(),g=o[1]-s-a,y(p),g<f?(g=o[1]+a,h+=" bottom"):h+=" top"}r.style.left=p+"px",r.style.top=g+"px",r.className=h},single:function(t,e){var n;return r('<div class="tooltip-header">             <b>{{key}}</b>         </div>         <div class="tooltip-grid">             <p><span>{{label}}</span> <span>{{value}}</span></p>'+(void 0!==t.percent&&String(t.percent).length?"<p><span>{{str tooltip.percent}}</span> <span>{{percent}}%</span></p>":"")+"</div>"+(void 0!==t.msg&&t.msg.length?'<div class="tooltip-status"><i>{{msg}}</i></div>':""),t,e)},multi:function(t,e){var n;return r('<div class="tooltip-grid">             <p><span>{{groupName}}</span> <span>{{groupLabel}}</span></p>'+(void 0!==t.seriesName&&String(t.seriesName).length?"<p><span>{{seriesName}}</span> <span>{{seriesLabel}}</span></p>":"")+"<p><span>{{valueName}}</span> <span>{{valueLabel}}</span></p>"+(void 0!==t.percent&&String(t.percent).length?"<p><span>{{str tooltip.percent}}</span> <span>{{percent}}%</span></p>":"")+"</div>"+(void 0!==t.msg&&t.msg.length?'<div class="tooltip-status"><i>{{msg}}</i></div>':""),t,e)}}}(),c=function(){function i(r,a){var t=r?Object.getOwnPropertyNames(r):[];t.length&&t.forEach(function(t){var e=r[t];if("string"==typeof e||e instanceof String)a[t]=e.toString();else{var n=a[t]||(a[t]={});!(n instanceof Object)||n instanceof Date||n instanceof Function||i(e,n)}})}return function(t){var r={legend:{close:"Hide legend",open:"Show legend",noLabel:"undefined"},controls:{close:"Hide controls",open:"Show controls"},tooltip:{amount:"Amount",count:"Count",date:"Date",group:"Group",key:"Key",percent:"Percent"},noData:"No Data Available.",noLabel:"undefined",displayError:"The chart cannot be displayed due to its configuration.",translate:function(t){var e=t.split("."),n=r[e[0]];return"string"==typeof n?n:2===e.length?n[e[1]]:t}};return i(t,r),r}}();function a(){var N={top:0,right:0,bottom:0,left:0},z=960,P=500,e=function(t){return t.x},n=function(t){return t.y},O=Math.floor(1e5*Math.random()),_=Nt.scaleLinear(),H=Nt.scaleLinear(),B=!1,r=0,R=0,a=zt.buildLocality(),i="ltr",o="stack",V="zero",G="default",W="linear",l=null,s=null,c=[],u=[],Y=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},q=zt.colorLinearGradient,X=Y,j=function(t,e){return"sc-area sc-series-"+t.seriesIndex},K=Nt.dispatch("tooltipShow","tooltipHide","tooltipMove","elementClick","elementMouseover","elementMouseout","elementMousemove"),Z,U=H.copy();function $(t){return t.each(function(r){var t=Nt.select(this),o=z-N.left-N.right,n=P-N.top-N.bottom,e="linear"===W?Nt.curveLinear:"cardinal"===W?Nt.curveCardinal:"monotone"===W?Nt.curveMonotoneX:"basis"===W?Nt.curveBasis:Nt.curveNatural,a=[["zero","wiggle","expand","silhouette"].indexOf(V)],i=[Nt.stackOffsetNone,Nt.stackOffsetWiggle,Nt.stackOffsetExpand,Nt.stackOffsetSilhouette][a],l=[["default","inside-out"].indexOf(G)],s=[Nt.stackOrderNone,Nt.stackOrderInsideOut][l],c=Nt.stack().offset(i).order(s).value(function(t,e){return t[e]}),u={};r.forEach(function(t,e){t.values.forEach(function(t,e){var n=t.x,r=t.y;u[n]||(u[n]=[],u[n].x=n),u[n].push(r)})});var d,f=Nt.keys(u).map(function(t){return parseInt(t,10)}),h=c.keys(Nt.range(0,r.length))(Nt.values(u)),p=Nt.min(h,function(t){return Nt.min(t,function(t){return Nt.min(t,function(t){return t})})}),g=Nt.max(h,function(t){return Nt.max(t,function(t){return Nt.max(t,function(t){return t})})});h.forEach(function(t,n){t.key=r[n].key,t.seriesIndex=r[n].seriesIndex,t.total=r[n].total,t.color=r[n].color,t.class=r[n].classes,t.forEach(function(t,e){t.seriesIndex=r[n].seriesIndex,t.si0=n-1,p&&(t[0]-=p,t[1]-=p)})});var m=Nt.area().curve(e).x(function(t){return _(t.data.x)}).y0(function(t,e){var n=Z?Z[t.si0]:null;return n&&n[e]?U(n[e][1]):U(0)}).y1(function(t,e){var n=Z?Z[t.si0]:null;return n&&n[e]?U(n[e][1]):U(0)}),v=Nt.area().curve(e).x(function(t){return _(t.data.x)}).y0(function(t){return H(t[0])}).y1(function(t){return H(t[1])}),y=Nt.area().curve(e).x(function(t){return _(t.data.x)}).y0(function(t,e){var n=h[t.si0];return n&&n[e]?H(n[e][1]):H(0)}).y1(function(t,e){var n=h[t.si0];return n&&n[e]?H(n[e][1]):H(0)}),b=Nt.transition("area").duration(R).ease(Nt.easeLinear);_.domain(Nt.extent(f)).range([0,o]),H.domain([0,g-p]).range([n,0]),$.resetDimensions=function(t,e){P=e,o=(z=t)-N.left-N.right,n=e-N.top-N.bottom,_.range([0,o]),H.range([n,0])};var x,w=t.selectAll("g.sc-wrap.sc-area").data([h]).enter().append("g").attr("class","sc-wrap sc-area"),k=t.select(".sc-wrap.sc-area").merge(w),M=w.append("defs"),A=k.select("defs");w.append("g").attr("class","sc-group");var I=k.select(".sc-group");k.attr("transform",zt.translation(N.left,N.top)),M.append("clipPath").attr("id","sc-edge-clip-"+O).append("rect"),A.select("#sc-edge-clip-"+O+" rect").attr("width",o).attr("height",n),k.attr("clip-path",B?"url(#sc-edge-clip-"+O+")":""),$.gradientFill=function(t,e,n){var r=O+"-"+e,a=Y(t,e);return q(t,r,n,a,A)};var C=I.selectAll("g.sc-series").data(h,function(t){return t.seriesIndex}),S=C.enter().append("g").attr("class","sc-series").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),F=I.selectAll(".sc-series").merge(S);F.attr("fill",X).attr("stroke",Y).attr("class",j).classed("hover",function(t){return t.hover}),F.transition(b).style("stroke-opacity",1).style("fill-opacity",.5),C.exit().transition(b).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove();var D,L=F.selectAll("path.sc-area").data(function(t){return[t]}).enter().append("path").attr("class","sc-area sc-enter"),T=F.selectAll(".sc-area").merge(L);function E(t,e,n){return{point:e,seriesKey:e.key,seriesIndex:e.seriesIndex,e:t}}T.filter(function(t){return Nt.select(this).classed("sc-enter")}).attr("d",m),T.transition(b).attr("d",v).on("end",function(t){Nt.select(this).classed("sc-enter",!1),Z=h.map(function(t){return t.map(function(t){return[t[0],t[1]]})}),U=H.copy()}),C.exit().transition(b).selectAll(".sc-area").attr("d",y).remove(),T.on("mouseover",function(t,e){var n=E(Nt.event,t,e);K.call("elementMouseover",this,n),Nt.select(this).classed("hover",!0)}).on("mousemove",function(t,e){var n=E(Nt.event,t,e),r=k.select("#sc-edge-clip-"+O+" rect").node().getBoundingClientRect(),a=Nt.event.clientX-r.left,i=Math.round(a*f.length/o)-1;n.data=h.map(function(t,e){var n=[t[i].data.x,t[i][1]];return n.seriesKey=t.key,n.seriesIndex=t.seriesIndex,n}),n.pointIndex=i,n.origin=r,K.call("elementMousemove",this,n)}).on("mouseout",function(t,e){K.call("elementMouseout",this),Nt.select(this).classed("hover",!1)}).on("click",function(t,e){var n=E(Nt.event,t,e);Nt.event.stopPropagation(),Nt.select(this).classed("hover",!1),K.call("elementClick",this,n)}),U=H.copy()}),$}return $.dispatch=K,$.id=function(t){return arguments.length?(O=t,$):O},$.color=function(t){return arguments.length?(Y=t,$):Y},$.fill=function(t){return arguments.length?(X=t,$):X},$.classes=function(t){return arguments.length?(j=t,$):j},$.gradient=function(t){return arguments.length?(q=t,$):q},$.margin=function(t){if(!arguments.length)return N;for(var e in t)t.hasOwnProperty(e)&&(N[e]=t[e]);return $},$.width=function(t){return arguments.length?(z=t,$):z},$.height=function(t){return arguments.length?(P=t,$):P},$.clipEdge=function(t){return arguments.length?(B=t,$):B},$.x=function(t){return arguments.length?(e=t,$):e},$.y=function(t){return arguments.length?(n=t,$):n},$.xScale=function(t){return arguments.length?(_=t,$):_},$.yScale=function(t){return arguments.length?(H=t,$):H},$.xDomain=function(t){return arguments.length?(l=t,$):l},$.yDomain=function(t){return arguments.length?(s=t,$):s},$.forceX=function(t){return arguments.length?(c=t,$):c},$.forceY=function(t){return arguments.length?(u=t,$):u},$.delay=function(t){return arguments.length?(r=t,$):r},$.duration=function(t){return arguments.length?(R=t,$):R},$.locality=function(t){return arguments.length?(a=zt.buildLocality(t),$):a},$.direction=function(t){return arguments.length?(i=t,$):i},$.interpolate=function(t){return arguments.length?(W=t,$):W},$.offset=function(t){return arguments.length?(V=t,$):V},$.order=function(t){return arguments.length?(G=t,$):G},$.style=function(t){if(!arguments.length)return o;switch(o=t){case"stack":$.offset("zero"),$.order("default");break;case"stream":$.offset("wiggle"),$.order("inside-out");break;case"stream-center":$.offset("silhouette"),$.order("inside-out");break;case"expand":$.offset("expand"),$.order("default")}return $},$}function v(){var tt=Nt.scaleLinear(),et=null,nt=!0,rt=!0,at="ltr",it="bottom",ot=!1,lt=!1,st=30,e=!1,ct=!0,ut=!1,dt=null,ft=null,n=4,ht=function(t){return t},pt=8,r,a,i,o,l,gt={top:0,right:0,bottom:0,left:0},mt=0,vt=Nt.axisBottom(),yt;function bt(t){return t.each(function(t){var e=Nt.select(this),d=vt.scale().copy(),f={top:0,right:0,bottom:0,left:0},h=H(),r=Math.abs(h[1]-h[0]);yt=yt||vt.scale();var o="left"===it||"right"===it,p="left"===it||"top"===it?-1:1,n=0,a=0,l=6,i=0,s=0,g=[],c={},u={},m={};mt=0,null!==ft?vt.ticks(ft):o?vt.ticks(Math.ceil(r/48)):vt.ticks(Math.ceil(r/100)),vt.tickFormat(function(t,e,n){return ht(t,e,n,"axis")}),st&&!zt.isNumeric(String(st))&&(st=30),ut&&(nt=!1);var v,y=e.selectAll("g.sc-wrap.sc-axis").data([t]).enter().append("g").attr("class","sc-wrap sc-axis").append("g").attr("class","sc-axis-inner"),b=e.select(".sc-axis-inner").merge(y);b.call(vt);var x=b.selectAll("g.tick"),w=nt?Nt.extent(tt.domain()):[],k=b.selectAll("g.sc-axisMaxMin").data(w),M=k.enter().append("g").attr("class","sc-axisMaxMin");k.exit().remove();var A=b.selectAll("g.sc-axisMaxMin").merge(M);M.append("text").style("opacity",1);var I=A.select("text"),C=b.selectAll("g.tick, g.sc-axisMaxMin").select("text").filter(function(t){return this.getBoundingClientRect().width}),S=et?[et]:[],F=b.selectAll("text.sc-axislabel").data(S),D=F.enter().append("text").attr("class","sc-axislabel");F.exit().remove();var L=b.selectAll("text.sc-axislabel").merge(D);L.text(zt.identity);var T=!1,E=!1,N=!1;if(o?(U(!0),C.style("text-anchor",W(dt||(Y()?"start":"end")))):(U(!1),Z(),K(1)&&(ot&&(U(!1),$(),Z(),$(),K(1)||(T=!0)),!T&&lt&&(U(!1),J(),Z(),J(),K(2)||(E=!0)),T||E||(st||(st=30),U(!0),o||(s=a/Math.sin(st*Math.PI/180)),Q(st),Z(st),Q(st),N=!0))),nt?x.each(function(t,e){var n=Nt.select(this),r=c["key-"+t.toString()],a=!1,i=d(t)===h[0]||d(t)===h[1];i?a=!0:void 0!==r&&(a=o?u.top-r.bottom+1<0||r.top-m.bottom<0:N?r.left-s/2<u.left||r.left+s/2>m.left:E?(r.left-l<u.right||r.right+l>m.left)&&(r.bottom===u.bottom||r.bottom<u.top||r.top>m.bottom):r.left-l<u.right||r.right+l>m.left),n.select("line").classed("extent",i),n.select("text").style("opacity",1-a)}):x.select("line").style("stroke-opacity",function(t){return d(t)===h[0+Y()]?0:null}),x.filter(function(t){return t<1e-10&&-1e-10<t&&d(t)!==h[0]&&d(t)!==h[1]}).select("line").classed("zero",rt),et){var z=o?ct?r/-2:(mt+pt)*p:r/2,P=o?ct?(mt+pt)*p:r/2:(mt+pt)*p;L.attr("x",z).attr("y",P).attr("dy",.355+.355*p+"em").attr("transform",o&&ct?"rotate(-90)":"").style("text-anchor",o&&!ct?W("end"):"middle"),L.each(function(t,e){i+=o?parseInt(this.getBoundingClientRect().width/1.3,10):parseInt(this.getBoundingClientRect().height/1.3,10)}),mt+=i+pt}function O(){return 1<d.range().length?Math.abs(d.range()[1]-d.range()[0]):0}function _(){return 1<d.range().length?Math.max(.25,1-zt.round(d.bandwidth()/O(),2)):0}function H(){return"function"==typeof d.rangeExtent?d.rangeExtent():d.range()}function B(){return ut?d.bandwidth():0}function R(){return ut?d.range()[0]:0}function V(){return R()/G()}function G(){var t=0,e;return ut?t=1<d.range().length?Math.abs(d.range()[1]-d.range()[0]):Nt.max(H())/2:(e=d.ticks(x.size()),t=d(e[e.length-1])-d(e[e.length-2])),t}function W(t){if("rtl"===at){if("start"===t)return"end";if("end"===t)return"start"}return t}function Y(){return"left"!==it&&"bottom"!==it}function q(t){t=t||1,mt=vt.tickPadding()+(o?n:a)*t}function X(){j(),n=Nt.max(g,function(t){return t.width}),a=Nt.max(g,function(t){return t.height})}function j(){g=[],c={},nt&&A.attr("transform",function(t,e){var n;return"translate("+(o?"0,"+d(t):d(t)+",0")+")"}),C.each(function(t,e){var n=this.getBoundingClientRect();0<n.width&&g.push({key:t,width:parseInt(n.width,10),height:parseInt(n.height,10),left:n.left,right:n.right,top:n.top,bottom:n.bottom})}),g.sort(function(t,e){return t.key-e.key}).forEach(function(t,e){t.index=e,c["key-"+t.key.toString()]=t}),u=g[0],m=g[g.length-1]}function K(t){j();for(var e=nt?2:t||1,n=nt?1:0,r=g.length-e;n<r;n+=1)if(g[n].right+l>g[n+t].left)return!0;return!1}function Z(t){var l=t?(t+180)%180:0,s=90<l,c=null,u=null;if(g.forEach(function(t,e){var n=null===c||t.left<=c,r=null===u||t.right>=u,a=0,i=0,o=0;(n||r)&&(o=l?t.width-6:t.width/2,a=d(t.key)+ut*B()/2,!n||l&&!s||(c=t.left,i=Math.abs(h[0]-a),f.left=Math.max(o-i,0)),!r||l&&s||(u=t.right,i=Math.abs(h[1]-a),f.right=Math.max(o-i,0)))}),!ut){var e=gt.right-Math.max(gt.right,f.right);e+=gt.left-Math.max(gt.left,f.left);var n=[h[0],h[1]+e];d.range(n),h=H(),r=Math.abs(h[1]-h[0]),vt.scale(d),b.call(vt)}}function U(){f={top:0,right:0,bottom:0,left:0},d=tt.copy(),h=H(),r=Math.abs(h[1]-h[0]),vt.scale(tt),b.call(vt),C.selectAll("tspan").remove(),C.attr("dy",o?".32em":.355+.355*p+"em").attr("x",o?vt.tickPadding()*p:0).attr("y",o?0:vt.tickPadding()*p).attr("transform","translate(0,0)").style("text-anchor","middle").style("opacity",1),I.text(function(t,e,n){return ht(t,e,n,"maxmin")}),X(),q()}function $(){var f=G();C.each(function(t,e,n){var r=ht(t,e,n,"no-ellipsis"),a=Nt.select(this),i=zt.isValidDate(zt.parseDatetime(r)),o=1===p?.71:-1,l=0,s=(r&&""!==r?i?r:r.replace("/","/ "):[]).split(" "),c=s.length;this.textContent="";var u,d=a.append("tspan").text(s[l]+" ").attr("dy",o+"em").attr("x",0);for(l+=1,o=1;l<c;)for(d=a.append("tspan").text(s[l]+" ").attr("dy",o+"em").attr("x",0),l+=1;l<c;){if(u=d.text(),d.text(u+" "+s[l]),!(this.getBoundingClientRect().width<=f)){d.text(u);break}l+=1}}),X(),q()}function J(){C.attr("transform",function(t,e){var n;return"translate(0,"+c["key-"+t.toString()].index%2*a+")"}),X(),q(2)}function Q(t){var e=(t+180)%180,n=90<e,r=(e-(n?180:0))*p,a=W(n?"end":"start"),i=Math.abs(Math.cos(t*Math.PI/180));C.attr("transform",function(t,e,n){return"translate(0,"+vt.tickPadding()*p+") rotate("+r+")"}).attr("y","0").style("text-anchor",a),X(),q()}yt=tt.copy(),(gt={top:f.top,right:f.right,bottom:f.bottom,left:f.left})[it]=mt,bt.resizeTickLines=function(t){b.selectAll("g.tick, g.sc-axisMaxMin").select("line").attr(o?"x2":"y2",t*p)},bt.labelThickness=function(){return i}}),bt}return bt.axis=vt,zt.rebind(bt,tt,"domain","range"),bt.width=function(t){return arguments.length?bt:mt},bt.height=function(t){return arguments.length?bt:mt},bt.margin=function(t){return arguments.length?(gt=t,bt):gt},bt.ticks=function(t){return arguments.length?(ft=t,bt):ft},bt.axisLabel=function(t){return arguments.length?(et=t,bt):et},bt.showMaxMin=function(t){return arguments.length?(nt=t,bt):nt},bt.highlightZero=function(t){return arguments.length?(rt=t,bt):rt},bt.wrapTicks=function(t){return arguments.length?(ot=t,bt):ot},bt.rotateTicks=function(t){return arguments.length?(st=t,bt):st},bt.staggerTicks=function(t){return arguments.length?(lt=t,bt):lt},bt.reduceXTicks=function(t){return arguments.length?(e=t,bt):e},bt.rotateYLabel=function(t){return arguments.length?(ct=t,bt):ct},bt.axisLabelDistance=function(t){return arguments.length?(pt=t,bt):pt},bt.textAnchor=function(t){return arguments.length?(dt=t,bt):dt},bt.direction=function(t){return arguments.length?(at=t,bt):at},bt.orient=function(t){return arguments.length?(vt="bottom"===(it=t)?Nt.axisBottom():"right"===it?Nt.axisRight():"left"===it?Nt.axisLeft():"top"===it?Nt.axisTop():Nt.axisBottom(),bt):it},bt.scale=function(t){return arguments.length?(tt=t,vt.scale(tt),ut="function"==typeof tt.padding,zt.rebind(bt,tt,"domain","range"),bt):tt},bt.valueFormat=function(t){return arguments.length?(ht=t,bt):ht||vt.tickFormat()},bt.tickFormat=function(t){return arguments.length?(r=t,vt.tickFormat(t),bt):r||vt.tickFormat()},bt.tickValues=function(t){return arguments.length?(a=t,vt.tickValues(t),bt):a},bt.tickSize=function(t){return arguments.length?(i=t,vt.tickSize(t),bt):i},bt.tickPadding=function(t){return arguments.length?(n=t,vt.tickPadding(t),bt):n},bt.tickSizeInner=function(t){return arguments.length?(o=t,vt.tickSizeInner(t),bt):o},bt.tickSizeOuter=function(t){return arguments.length?(l=t,vt.tickSizeOuter(t),bt):l},bt}function r(){var Q={top:0,right:0,bottom:0,left:0},tt=960,et=500,nt=Math.floor(1e4*Math.random()),e=function(t){return(t.series||t).key},rt=function(t,e){return(t.series||t).value},at=function(t,e){return(t.series||t).count},it=function(t){return e(t)},ot=function(t){return rt(t)},lt=function(t){return isNaN(at(t))?"":" ("+at(t)+")"},n=zt.buildLocality(),r="ltr",a=0,st=0,ct=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},ut=zt.colorLinearGradient,dt=ct,ft=!1,ht=function(t,e){return"sc-series sc-series-"+t.seriesIndex},pt=.3,gt=Nt.scaleLinear(),mt=null,vt=[0],yt=!0,bt=75,xt=Nt.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),wt=0,kt=0,Mt=0;function At(t){return t.each(function(o){var c=tt-Q.left-Q.right,u=et-Q.top-Q.bottom,l=Nt.select(this),m=5,s=5,v=0,d=0,y=0;function t(){wt=H(y),kt=B(),Mt=R(y)}function e(){var n=_(kt,wt),r=0,t=4,a=wt-2*pt*kt,i=kt;o.forEach(function(t,e){t.values.forEach(function(t){t._height=0<d?O(n*t.value/d,a):0,t._height<4?(r+=t._height-4,t._height=4):r<0&&4<t._height+r&&(t._height+=r,r=0),t._base=a,t._bottom=i,t._top=t._bottom-t._height,a+=2*pt*t._height,i-=t._height})});var e=mt||Nt.extent(Nt.merge(o.map(function(t){return t.values.map(function(t){return t._top})})).concat(vt));gt.domain(e).range([kt,0])}d=Nt.sum(o,function(t){return t.value}),t(),e();var n,r=l.selectAll("g.sc-wrap").data([o]).enter().append("g").attr("class","sc-wrap sc-funnel"),a=l.select(".sc-wrap.sc-funnel").merge(r),i=r.append("defs"),f=a.select("defs");if(a.attr("transform",zt.translation(Q.left,Q.top)),ft)var h=zt.createTexture(i,nt);At.gradientFill=function(t,e,n){var r=nt+"-"+e,a=ct(t,e);return ut(t,r,n,a,f)};var p=a.selectAll(".sc-series").data(o,function(t){return t.seriesIndex}),g=p.enter().append("g").attr("class","sc-series");p.exit().remove();var b=a.selectAll(".sc-series").merge(g);g.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",1).on("mouseover",function(t,e,n){Nt.select(this).classed("hover",!0)}).on("mouseout",function(t,e,n){Nt.select(this).classed("hover",!1)}),b.attr("class",function(t){return ht(t,t.seriesIndex)}).attr("fill",function(t){return dt(t,t.seriesIndex)}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active}),b.transition().duration(st).style("stroke-opacity",1).style("fill-opacity",1);var x=b.selectAll("g.sc-slice").data(function(t){return t.values},function(t){return t.seriesIndex});x.exit().remove();var w=x.enter().append("g").attr("class","sc-slice"),k=b.selectAll("g.sc-slice").merge(w);w.append("polygon").attr("class","sc-base"),k.select("polygon.sc-base").attr("points",function(t){return P(t,0,wt)}),ft&&(w.append("polygon").attr("class","sc-texture").style("mask","url("+h+")"),k.select("polygon.sc-texture").attr("points",function(t){return P(t,0,wt)})),w.on("mouseover",function(t,e){Nt.select(this).classed("hover",!0);var n=L(Nt.event,t,e);xt.call("elementMouseover",this,n)}).on("mousemove",function(t,e){var n=Nt.event;xt.call("elementMousemove",this,n)}).on("mouseout",function(t,e){Nt.select(this).classed("hover",!1),xt.call("elementMouseout",this)}).on("click",function(t,e){Nt.event.stopPropagation();var n=L(Nt.event,t,e);xt.call("elementClick",this,n)}).on("dblclick",function(t,e){Nt.event.stopPropagation();var n=L(Nt.event,t,e);xt.call("elementDblClick",this,n)});var M=b.selectAll(".sc-label-value").data(function(t){return t.values},function(t){return t.seriesIndex});M.exit().remove();var A=M.enter().append("g").attr("class","sc-label-value"),I=b.selectAll("g.sc-label-value").merge(A);I.attr("transform","translate("+Mt+",0)");var C=I.filter(".sc-label-side");function S(){I.selectAll("polyline").remove(),I.selectAll("rect").remove(),I.selectAll("text").remove(),I.append("rect").attr("class","sc-label-box").attr("x",0).attr("y",0).attr("width",0).attr("height",0).attr("rx",2).attr("ry",2).style("pointer-events","none").style("stroke-width",0).style("fill-opacity",0),I.append("text").text(it).call(U,"sc-label",.85,"middle",K),I.select(".sc-label").call(E,yt?T:N,V,function(t,e){U(t,"sc-label",e,"middle",K)}),I.append("text").text(ot).call(U,"sc-value",.85,"middle",K),I.select(".sc-value").append("tspan").text(lt),I.call($).call(Y).call(J),I.classed("sc-label-side",function(t){return t.tooTall||t.tooWide})}function F(){var e=0,t=0,n,r,a,i;for((C=I.filter(".sc-label-side")).selectAll(".sc-label").remove(),C.selectAll("rect").remove(),C.selectAll("polyline").remove(),C.append("text").text(it).call(U,"sc-label",.85,"start","#555"),C.select(".sc-label").call(E,yt?T:N,yt?G:z,function(t,e){U(t,"sc-label",e,"start","#555")}),C.call($),C.select(".sc-value").style("text-anchor","start").style("fill","#555"),C.call(q),a=(n=C.nodes()).length-1;0<=a;a-=1)if(t=Nt.select(n[a]).data()[0]){if(!e){t.labelBottom=t.labelTop+t.labelHeight+s,e=t.labelBottom;continue}t.labelTop=Math.max(e,t.labelTop),t.labelBottom=t.labelTop+t.labelHeight+s,e=t.labelBottom}if(e&&e-s>Nt.max(gt.range())){for(r=e=0,i=(n=C.nodes()).length;r<i;r+=1)if(t=Nt.select(n[r]).data()[0]){if(!e){t.labelBottom=kt-1,t.labelTop=t.labelBottom-t.labelHeight,e=t.labelTop;continue}t.labelBottom=Math.min(e,t.labelBottom),t.labelTop=t.labelBottom-t.labelHeight-s,e=t.labelTop}e<0&&C.each(function(t){t.labelTop-=e,t.labelBottom-=e})}e=0,C.call(j)}function D(){S(),F()}function L(t,e,n){return{id:nt,key:it(e),value:rt(e),count:at(e),data:e,series:e.series,seriesIndex:e.series.seriesIndex,e:t}}function T(t,e,n,r){var a=e.text(),i=parseFloat(e.attr("dy")),o,l=a.split(/\s+/).reverse(),s=[],c=0,u=n(t,0),d=Nt.select(e.node().parentNode);for(e.text(null);o=l.pop();)s.push(o),e.text(s.join(" ")),e.node().getBoundingClientRect().width>u&&1<s.length&&(s.pop(),e.text(s.join(" ")),s=[o],(e=d.append("text")).text(o).call(r,1.1*++c+i))}function E(t,n,r,a){t.each(function(t){var e=Nt.select(this);n(t,e,r,a)})}function N(t,e,n,r){var a=e.text(),i=parseFloat(e.attr("dy")),o=n(t);e.text(zt.stringEllipsify(a,l,o)).call(r,i)}function z(t){var e=Math.max(c-u/1.1,bt),n=t._bottom,r,a=e+n*pt,i=Math.abs(t.labelBottom-n),o,l,s=a-(m+i*pt+m+m);return Math.max(s,bt)}function P(t,e,n){var r=t._bottom,a=t._top,i=n/2-pt*r,o=n/2-pt*a,l=Mt;return Mt-i+","+r*e+" "+(Mt-o)+","+a*e+" "+(Mt+o)+","+a*e+" "+(Mt+i)+","+r*e}function O(t,e){var n=e/pt/2;return Math.abs(Math.sqrt(t/pt+n*n))-n}function _(t,e){return t*(e-t*pt)}function H(t){return Math.round(Math.max(Math.min(u/1.1,c-t),40))}function B(){return Math.min(1.1*wt,(wt-wt*pt)/(2*pt))}function R(t){return wt/2+t}function V(t){var e,n;return wt-(t._bottom-t._height/2)*pt*2}function G(t,e){var n,r;return Math.max((c-wt)/2,e)+t._top*pt}function W(t){return Nt.select(t).node().getBoundingClientRect()}function Y(t){t.each(function(t){var e=W(this);t.labelHeight=e.height,t.labelWidth=e.width,t.labelTop=t._bottom-t._height/2-t.labelHeight/2,t.labelBottom=t.labelTop+t.labelHeight+s,t.tooWide=t.labelWidth>V(t),t.tooTall=t.labelHeight>t._height-4})}function q(t){t.each(function(t){var e=W(this);t.labelHeight=e.height,t.labelWidth=e.width,t.labelTop=t._top,t.labelBottom=t.labelTop+t.labelHeight+s})}function X(t){for(var e=t.size(),n=t.nodes(),r=n.length-1;0<=r;--r){var a=Nt.select(n[r]),i=a.data()[0],o=r<e-1?Nt.select(n[r+1]).data()[0]:null,l=r?Nt.select(n[r-1]).data()[0]:null,s=Math.round(i.labelHeight)+.5,c=Math.round(i._bottom-i.labelTop)-.5,u=o?o.labelWidth-(i.labelBottom-o.labelBottom)*pt:0,d=i.labelWidth,f=l&&s<c?l.labelWidth:0,h=Math.round(Math.max(u,d,f))+m,p=Math.round(G(i,y))-v-m,g="0,"+s+" "+h+","+s+" "+(h+Math.abs(s-c)*pt)+","+c+" "+p+","+c;i.labelWidth=h,a.attr("points",g)}}function j(t){var e=(c-wt)/2,i=0;t.each(function(t){var e=t._bottom,n=Math.abs(t.labelBottom+m-e)*pt,r=e*pt,a=t.labelWidth+n+3*m-r;i<=a&&(i=a)}),(i=Math.round(10*i)/10)<=0?y=v=e:0<i&&i<e?(v=e-i,y=e):(v=0,y=i)}function K(t,e,n){var r=t.series||t,a=r.seriesIndex||e,i=dt(r),o="inherit"===i?Nt.select("."+ht(r,a).split(" ").join(".")).style("color"):i;return zt.getTextContrast(o,a)}function Z(t){return zt.isRTLChar(t.slice(-1))?"rtl":"ltr"}function U(t,e,n,r,a){t.attr("x",0).attr("y",0).attr("dy",n+"em").attr("class",e).attr("direction",function(){return"ltr"}).style("pointer-events","none").style("text-anchor",r).style("fill",a)}function $(t){t.each(function(t){var e=Nt.select(this),n,r=.85+(e.selectAll(".sc-label").size()+1)-1+"em";e.select(".sc-value").attr("dy",r)})}function J(t){t.each(function(t,e){var n;Nt.select(this).select(".sc-label-box").attr("x",(t.labelWidth+6)/-2).attr("y",-2).attr("width",t.labelWidth+6).attr("height",t.labelHeight+4).attr("rx",2).attr("ry",2).style("fill-opacity",1)})}D(),t(),e(),D(),t(),e(),D(),t(),e(),k.select(".sc-base").attr("points",function(t){return P(t,1,wt)}),ft&&k.selectAll(".sc-texture").attr("points",function(t){return P(t,1,wt)}).style("fill",K),I.attr("transform",function(t){var e,n;return"translate("+(t.tooTall?0:Mt)+","+(t.tooTall?0:t.labelTop)+")"}),C.attr("transform",function(t){return"translate("+v+","+t.labelTop+")"}),C.append("polyline").attr("class","sc-label-leader").style("fill-opacity",0).style("stroke","#999").style("stroke-width",1).style("stroke-opacity",.5),C.selectAll("polyline").call(X)}),At}return At.dispatch=xt,At.id=function(t){return arguments.length?(nt=t,At):nt},At.color=function(t){return arguments.length?(ct=t,At):ct},At.fill=function(t){return arguments.length?(dt=t,At):dt},At.classes=function(t){return arguments.length?(ht=t,At):ht},At.gradient=function(t){return arguments.length?(ut=t,At):ut},At.margin=function(t){return arguments.length?(Q.top=void 0!==t.top?t.top:Q.top,Q.right=void 0!==t.right?t.right:Q.right,Q.bottom=void 0!==t.bottom?t.bottom:Q.bottom,Q.left=void 0!==t.left?t.left:Q.left,At):Q},At.width=function(t){return arguments.length?(tt=t,At):tt},At.height=function(t){return arguments.length?(et=t,At):et},At.getKey=function(t){return arguments.length?(e=t,At):e},At.getValue=function(t){return arguments.length?(rt=t,At):rt},At.getCount=function(t){return arguments.length?(at=t,At):at},At.fmtKey=function(t){return arguments.length?(it=t,At):it},At.fmtValue=function(t){return arguments.length?(ot=t,At):ot},At.fmtCount=function(t){return arguments.length?(lt=t,At):lt},At.direction=function(t){return arguments.length?(r=t,At):r},At.delay=function(t){return arguments.length?(a=t,At):a},At.duration=function(t){return arguments.length?(st=t,At):st},At.locality=function(t){return arguments.length?(n=zt.buildLocality(t),At):n},At.textureFill=function(t){return arguments.length?(ft=t,At):ft},At.yScale=function(t){return arguments.length?(gt=t,At):gt},At.yDomain=function(t){return arguments.length?(mt=t,At):mt},At.forceY=function(t){return arguments.length?(vt=t,At):vt},At.wrapLabels=function(t){return arguments.length?(yt=t,At):yt},At.minLabelWidth=function(t){return arguments.length?(bt=t,At):bt},At}function o(){var V={top:0,right:0,bottom:0,left:0},G=null,W=null,Y=Math.floor(1e4*Math.random()),e=function(t){return t.key},n=function(t){return zt.isNumeric(t.y)?parseFloat(t.y):null},r=function(t){return t.hasOwnProperty("key")?t.key:t},a=function(t){return zt.isNumeric(t.value)?t.value:n(t)},i=function(t){return zt.isNumeric(t.count)?t.count:t},o=function(t){return r(t)},l=function(t){return a(t)},s=function(t){return(" ("+i(t)+")").replace(" ()","")},c=zt.buildLocality(),u="ltr",d=0,q=0,X=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},j=zt.colorRadialGradient,K=X,Z=function(t,e){return"sc-slice sc-series-"+t.seriesIndex},U=Nt.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),$=50,f=!0,J=!0,Q=.01,tt=5,h=5,et=90,nt=0,rt=0,at=0,it=-90,ot=90,lt=10;function st(t){return t.each(function(t){var e=G-V.left-V.right,n=W-V.top-V.bottom,r=Nt.select(this),i=Math.min(e/2,n)/((100+lt)/100),a=ot-it,o=Nt.scaleLinear().range([0,1]).domain([rt,at]),l=function(t){return t*i/100},s,c=r.selectAll("g.sc-wrap").data([t]).enter().append("g").attr("class","sc-wrap sc-gauge"),u=r.select(".sc-wrap.sc-gauge").merge(c),d=c.append("defs"),f=u.select("defs");c.append("g").attr("class","sc-group");var h=u.select(".sc-group");c.append("g").attr("class","sc-labels");var p=u.select(".sc-labels");c.append("g").attr("class","sc-pointer");var g=u.select(".sc-pointer"),m=c.append("g").attr("class","sc-odometer"),v=u.select(".sc-odometer");u.attr("transform","translate("+(V.left/2+V.right/2+l(lt))+","+(V.top+l(lt))+")"),st.gradientFill=function(t,e){var n=Y+"-"+e,r={x:0,y:0,r:i,s:$/100,u:"userSpaceOnUse"},a=X(t,e);return j(t,n,r,a,f)},h.attr("transform",B);var y=h.selectAll(".sc-series").data(t),b=y.enter().append("g").attr("class","sc-series");y.exit().remove();var x=h.selectAll(".sc-series").merge(b);b.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",0).on("mouseover",function(t,e,n){Nt.select(this).classed("hover",!0)}).on("mouseout",function(t,e,n){Nt.select(this).classed("hover",!1)}),x.attr("class",function(t){return Z(t,t.seriesIndex)}).attr("fill",function(t){return K(t,t.seriesIndex)}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active});var w=Nt.arc().innerRadius(l($)).outerRadius(i).startAngle(_).endAngle(H),k=x.selectAll("g.sc-slice").data(function(t){return t.values},function(t){return t.seriesIndex});k.exit().remove();var M=k.enter().append("g").attr("class","sc-slice"),A=x.selectAll("g.sc-slice").merge(M);function I(t,e,n){return{point:e,index:n,e:Nt.event,id:Y}}M.append("path").attr("class","sc-base").attr("d",w).on("mouseover",function(t,e){Nt.select(this).classed("hover",!0);var n=I(Nt.event,t,e);U.call("elementMouseover",this,n)}).on("mousemove",function(t,e){var n=Nt.event;U.call("elementMousemove",this,n)}).on("mouseout",function(t,e){Nt.select(this).classed("hover",!1),U.call("elementMouseout",this)}).on("click",function(t,e){Nt.event.stopPropagation();var n=I(Nt.event,t,e);U.call("elementClick",this,n)}).on("dblclick",function(t,e){Nt.event.stopPropagation();var n=I(Nt.event,t,e);U.call("elementDblClick",this,n)}),A.select(".sc-base").attr("d",w).style("stroke-opacity",1);var C=[{x:0,y:rt,y0:rt,y1:rt}].concat(t.map(function(t){return t.values[0]}));p.attr("transform",B);var S=p.selectAll("text").data(C),F=S.enter().append("text"),D;if(S.exit().remove(),p.selectAll("text").merge(F).attr("transform",function(t){return"rotate("+O(t.y1)+") translate(0,"+(l(-1.5)-i)+")"}).text(function(t){return t.y1}).style("fill-opacity",R).style("text-anchor","middle").style("font-size",l(.6)+"em"),J){var L=[[Math.round(l(tt)/2),0],[0,-Math.round(l(et))],[-Math.round(l(tt)/2),0],[0,Math.round(l(tt))],[Math.round(l(tt)/2),0]];g.attr("transform",B);var T=g.selectAll("path").data([L]),E=T.enter().append("path").attr("transform","rotate("+it+")");T.exit().remove();var N=g.selectAll("path").merge(E);N.attr("d",Nt.line()),m.append("text").attr("class","sc-odom sc-odomText").attr("x",0).attr("y",0).style("text-anchor","middle").style("stroke","none").style("fill","black"),v.select(".sc-odomText").style("font-size",l(.7)+"em").text(nt),m.insert("path",".sc-odomText").attr("class","sc-odom sc-odomBox").attr("fill","#EFF").attr("stroke","black").attr("stroke-width","2px").attr("opacity",.8),v.call(P)}else g.selectAll("path").remove(),v.select(".sc-odomText").remove(),v.select(".sc-odomBox").remove();function z(t){nt=t,N.transition().duration(q).ease(Nt.easeElastic).attr("transform","rotate("+O(t)+")"),v.select(".sc-odomText").text(nt),v.call(P)}function P(t){var e=t.select(".sc-odomText").node().getBoundingClientRect();t.select(".sc-odomBox").attr("d",zt.roundedRectangle(-e.width/2,-e.height+l(1.5),e.width+l(4),e.height+l(2),l(2))),t.attr("transform","translate("+i+","+(V.top+l(70)+e.height)+")")}function O(t){return it+o(t)*a}function _(t){return zt.angleToRadians(O(t.y0))}function H(t){return zt.angleToRadians(O(t.y1))}function B(){return"translate("+i+","+i+")"}function R(t,e){var n=(H(t)-_(t))/(2*Math.PI);return 0===e||Q<n?1:0}st.setGaugePointer=z}),st}return st.dispatch=U,st.id=function(t){return arguments.length?(Y=t,st):Y},st.color=function(t){return arguments.length?(X=t,st):X},st.fill=function(t){return arguments.length?(K=t,st):K},st.classes=function(t){return arguments.length?(Z=t,st):Z},st.gradient=function(t){return arguments.length?(j=t,st):j},st.margin=function(t){return arguments.length?(V.top=void 0!==t.top?t.top:V.top,V.right=void 0!==t.right?t.right:V.right,V.bottom=void 0!==t.bottom?t.bottom:V.bottom,V.left=void 0!==t.left?t.left:V.left,st):V},st.width=function(t){return arguments.length?(G=t,st):G},st.height=function(t){return arguments.length?(W=t,st):W},st.x=function(t){return arguments.length?(e=t,st):e},st.y=function(t){return arguments.length?(n=zt.functor(t),st):n},st.getKey=function(t){return arguments.length?(r=t,st):r},st.getValue=function(t){return arguments.length?(a=t,st):a},st.getCount=function(t){return arguments.length?(i=t,st):i},st.fmtKey=function(t){return arguments.length?(o=t,st):o},st.fmtValue=function(t){return arguments.length?(l=t,st):l},st.fmtCount=function(t){return arguments.length?(s=t,st):s},st.direction=function(t){return arguments.length?(u=t,st):u},st.delay=function(t){return arguments.length?(d=t,st):d},st.duration=function(t){return arguments.length?(q=t,st):q},st.locality=function(t){return arguments.length?(c=zt.buildLocality(t),st):c},st.showLabels=function(t){return arguments.length?(f=t,st):f},st.labelThreshold=function(t){return arguments.length?(Q=t,st):Q},st.ringWidth=function(t){return arguments.length?($=t,st):$},st.pointerWidth=function(t){return arguments.length?(tt=t,st):tt},st.pointerTailLength=function(t){return arguments.length?(h=t,st):h},st.pointerHeadLength=function(t){return arguments.length?(et=t,st):et},st.setPointer=function(t){return arguments.length?(st.setGaugePointer(t),st):st.setGaugePointer},st.showPointer=function(t){return arguments.length?(J=t,st):J},st.minValue=function(t){return arguments.length?(rt=t,st):rt},st.maxValue=function(t){return arguments.length?(at=t,st):at},st.minAngle=function(t){return arguments.length?(it=t,st):it},st.maxAngle=function(t){return arguments.length?(ot=t,st):ot},st.labelInset=function(t){return arguments.length?(lt=t,st):lt},st}function z(){var q={top:10,right:10,bottom:15,left:10},e=0,X=0,j="right",y="ltr",K="start",Z=6,U=2*Z,$=10,J=12,Q=5,tt=!0,et=!1,nt=!1,rt=!1,at=3,b=!1,x=c(),it=Math.floor(1e4*Math.random()),w=function(t){return 0<t.key.length||!isNaN(parseFloat(t.key))&&zt.isNumeric(t.key)?t.key:x.noLabel},k=function(t){return zt.defaultColor()(t,t.seriesIndex)},M=function(t){return"sc-series sc-series-"+t.seriesIndex},A=Nt.dispatch("legendClick","legendMouseover","legendMouseout","toggleMenu","closeMenu"),ot=0,lt=!1,st=!0,ct=0,ut=function(){};function dt(t){return t.each(function(t){var e=Nt.select(this),C=[],S=0,F=0,D="",L="start"===K,T="rtl"===y,E=J*(L?1:.6),N=$+(L?U+Q:0);if(!t||!t.length||!t.filter(function(t){return!t.values||t.values.length}).length)return dt;var n=t.filter(function(t){return t.hasOwnProperty("seriesIndex")}).length;t.filter(function(t){return!t.hasOwnProperty("seriesIndex")}).map(function(t){t.seriesIndex=n,n+=1}),b=!0,D=t[0].type&&"bar"!==t[0].type?"line":"bar",j=T&&"center"!==j?"left"===j?"right":"left":j;var r,a=e.selectAll("g.sc-wrap").data([t]).enter().append("g").attr("class","sc-wrap sc-menu"),i=e.select("g.sc-wrap").merge(a);i.attr("transform","translate(0,0)");var o=a.append("defs"),l=i.select("defs");o.append("clipPath").attr("id","sc-edge-clip-"+it).append("rect");var z=i.select("#sc-edge-clip-"+it+" rect");a.append("rect").attr("class","sc-menu-background");var P=i.select(".sc-menu-background"),O=zt.dropShadow("menu_back_"+it,l,{blur:2});a.append("text").attr("class","sc-menu-link");var _=i.select(".sc-menu-link"),s=a.append("g").attr("class","sc-menu-mask"),H=i.select(".sc-menu-mask");s.append("g").attr("class","sc-group");var B=i.select(".sc-group"),c=B.selectAll(".sc-series").data(zt.identity,function(t){return t.seriesIndex});c.exit().remove();var u=c.enter().append("g").attr("class","sc-series").on("mouseover",function(t){A.call("legendMouseover",this,t)}).on("mouseout",function(t){A.call("legendMouseout",this,t)}).on("click",function(t){Nt.event.preventDefault(),Nt.event.stopPropagation(),A.call("legendClick",this,t)}),R=B.selectAll(".sc-series").merge(u);R.attr("class",M).attr("fill",k).attr("stroke",k);var d=u.append("rect").attr("x",(U+Q)/-2).attr("y",(U+E)/-2).attr("width",U+Q).attr("height",U+E).style("fill","#FFE").style("stroke-width",0).style("opacity",.1),V=R.selectAll("rect").merge(d),f=u.selectAll("circle").data(function(t){return"line"===D?[t,t]:[t]});f.exit().remove();var h=f.enter().append("circle").attr("r",Z).style("stroke-width","2px"),G=R.selectAll("circle").merge(h),p=u.selectAll("line").data("line"===D?function(t){return[t]}:[]);p.exit().remove();var g=p.enter().append("line").attr("x0",0).attr("y0",0).attr("y1",0).style("stroke-width","4px"),W=R.selectAll("line").merge(g),m=u.append("text").attr("dx",0),Y=R.selectAll("text").merge(m);function v(){P.style("opacity",.9*ot).style("display",ot?"inline":"none"),B.style("opacity",ot).style("display",ot?"inline":"none"),_.text(1===ot?x.close:x.open)}Y.attr("dy",L?".36em":".71em").text(w),z.attr("x",.5).attr("y",.5).attr("width",0).attr("height",0),P.attr("x",.5).attr("y",.5).attr("width",0).attr("height",0).style("opacity",0).style("pointer-events","all").on("click",function(){Nt.event.stopPropagation()}),_.text(1===ot?x.close:x.open).attr("text-anchor","left"===j?T?"end":"start":T?"start":"end").attr("dy",".36em").attr("dx",0).style("opacity",0).on("click",function(t,e){Nt.event.preventDefault(),Nt.event.stopPropagation(),A.call("toggleMenu",this,t,e)}),R.classed("disabled",function(t){return t.disabled}),dt.calcMaxWidth=function(){return C=[],B.style("display","inline"),Y.each(function(){var t=Nt.select(this).node().getBoundingClientRect().width;C.push(Math.max(Math.floor(t),"line"===D?50:20))}),dt.width(Nt.sum(C)+C.length*N-$),dt.width()},dt.getLineHeight=function(){var t;return B.style("display","inline"),Math.floor(Y.node().getBoundingClientRect().height)},dt.arrange=function(t){function n(t){return C[t]+N}function e(t){return C[t]+N-$}function r(t){return t?1:-1}0===C.length&&this.calcMaxWidth();var a=C.length,i=1,o=a,l=[],s=[],c=t-q.left-q.right,u=X,d=0,f=this.getLineHeight(),h=U+(L?0:f)+E,p=7,g=7,m=7,v=7,y=0,b=0,x,w,k;if(tt){for(;0<o;){for(l=[],x=0;x<a;x+=1)n(x)>(l[x%o]||0)&&(l[x%o]=n(x));if(Nt.sum(l)-$<c)break;o-=1}for(o=o||1,i=Math.ceil(a/o),d=Nt.sum(l)-$,x=0;x<a;x+=1)w=x%o,L?0===w?y=T?d:0:y+=l[w-1]*r(!T):0===w?y=(T?d:0)+(l[w]-$)/2*r(!T):y+=(l[w-1]+l[w])/2*r(!T),b=Math.floor(x/o)*h,s[x]={x:y,y:b}}else if(T)for(y=c,x=0;x<a;x+=1)y-e(x)<0&&(d=Math.max(d,e(x)),y=c,x&&(i+=1)),y-e(x)>d&&(d=y-e(x)),s[x]={x:y,y:(i-1)*(E+U)},y-=n(x);else for(x=y=0;x<a;x+=1)x&&y+e(x)>c&&(y=0,i+=1),y+e(x)>d&&(d=y+e(x)),s[x]={x:y,y:(i-1)*(E+U)},y+=n(x);if(!nt&&(et||i<=at)){switch(ot=0,lt=rt=!1,dt.width(q.left+d+q.right).height(q.top+i*h-E+q.bottom),j){case"left":k=0;break;case"center":k=(t-dt.width())/2;break;case"right":k=0}z.attr("y",0).attr("width",dt.width()).attr("height",dt.height()),P.attr("x",k).attr("width",dt.width()).attr("height",dt.height()).attr("rx",0).attr("ry",0).attr("filter","none").style("display","inline").style("opacity",0),H.attr("clip-path","none").attr("transform",function(){var t,e;return"translate("+(k+q.left+(L?Z*r(!T):0))+","+(q.top+p)+")"}),B.style("opacity",1).style("display","inline"),R.attr("transform",function(t){var e=s[t.seriesIndex];return"translate("+e.x+","+e.y+")"}),V.attr("x",function(t){var e=0;return L?(e=(U+$)/2*r(T),e-=T?n(t.seriesIndex):0):e=n(t.seriesIndex)/-2,e}).attr("width",function(t){return n(t.seriesIndex)}).attr("height",h),G.attr("r",function(t){return"dash"===t.type?0:Z}).attr("transform",function(t,e){var n;return"translate("+(L||"bar"===D?0:3*Z*r(e))+",0)"}),W.attr("x1",function(t){return"dash"===t.type?8*Z:4*Z}).attr("transform",function(t){var e;return"translate("+Z*("dash"===t.type?-4:-2)+",0)"}).style("stroke-dasharray",function(t){return"dash"===t.type?"8, 8":"none"}).style("stroke-dashoffset",-4),Y.attr("dy",L?".36em":".71em").attr("text-anchor",K).attr("transform",function(){var t,e;return"translate("+(L?(Z+Q)*r(!T):0)+","+(L?0:(U+E)/2)+")"})}else lt=rt=!0,dt.width(v+Nt.max(C)+U+Q+g).height(q.top+U+q.top),S=p+U*a+J*(a-1)+m,F=Math.min(u-dt.height(),S),z.attr("x",.5-p-Z).attr("y",.5-p-Z).attr("width",dt.width()).attr("height",F),P.attr("x",.5).attr("y",.5+dt.height()).attr("width",dt.width()).attr("height",F).attr("rx",2).attr("ry",2).attr("filter",O).style("opacity",.9*ot).style("display",ot?"inline":"none"),_.attr("transform",function(){var t,e;return"translate("+("left"===j?.5:.5+dt.width())+","+(q.top+Z)+")"}).style("opacity",1),H.attr("clip-path","url(#sc-edge-clip-"+it+")").attr("transform",function(){var t,e;return"translate("+(v+Z)+","+(dt.height()+p+Z)+")"}),B.style("opacity",ot).style("display",ot?"inline":"none").attr("transform",function(){var t;return"translate("+(T?Nt.max(C)+Z:0)+",0)"}),R.attr("transform",function(t,e){var n;return"translate(0,"+e*(U+J)+")"}),V.attr("x",function(t){var e=(U+$)/2*r(T);return e-=T?n(t.seriesIndex):0}).attr("width",function(t){return n(t.seriesIndex)}).attr("height",U+E),G.attr("r",function(t){return"dash"===t.type?0:"line"===t.type?Z-2:Z}).attr("transform",""),W.attr("x1",16).attr("transform","translate(-8,0)").style("stroke-dasharray",function(t){return"dash"===t.type?"6, 4, 6":"none"}).style("stroke-dashoffset",0),Y.attr("text-anchor","start").attr("dy",".36em").attr("transform",function(){var t;return"translate("+(Z+Q)*r(!T)+",0)"});if(st){var M=F-S,A=function(t){if(t){var e=Nt.zoom().on("zoom",I);P.call(e),B.call(e)}else P.on(".zoom",null),B.on(".zoom",null)},I=function(){var t=Nt.event,e,n=0,r=0,a=0,i="";!t||"click"!==t.type&&"zoom"!==t.type||(e=t.sourceEvent,"zoom"===t.type&&e&&("wheel"===e.type?(n=-e.deltaX,r=-e.deltaY,a=ct+(Math.abs(n)>Math.abs(r)?n:r)):"mousemove"===e.type?(n=e.movementX,r=e.movementY,a=ct+(Math.abs(n)>Math.abs(r)?n:r)):"touchmove"===e.type&&(n=t.transform.x,r=t.transform.y,a=Math.abs(n)>Math.abs(r)?n:r)),ct=Math.min(Math.max(a,M),0),i="translate("+(T?Nt.max(C)+Z:0)+","+ct+")",(0<a||a<M)&&ut(Math.abs(r)>Math.abs(n)?r:0),B.attr("transform",i))};A(lt)}},A.on("toggleMenu",function(){Nt.event.stopPropagation(),ot=1-ot,v()}),A.on("closeMenu",function(){1===ot&&(ot=0,v())})}),dt}return dt.dispatch=A,dt.margin=function(t){return arguments.length?(q.top=void 0!==t.top?t.top:q.top,q.right=void 0!==t.right?t.right:q.right,q.bottom=void 0!==t.bottom?t.bottom:q.bottom,q.left=void 0!==t.left?t.left:q.left,dt):q},dt.width=function(t){return arguments.length?(e=Math.round(t),dt):e},dt.height=function(t){return arguments.length?(X=Math.round(t),dt):X},dt.id=function(t){return arguments.length?(it=t,dt):it},dt.key=function(t){return arguments.length?(w=t,dt):w},dt.color=function(t){return arguments.length?(k=zt.getColor(t),dt):k},dt.classes=function(t){return arguments.length?(M=t,dt):M},dt.align=function(t){return arguments.length?(j=t,dt):j},dt.position=function(t){return arguments.length?(K=t,dt):K},dt.showAll=function(t){return arguments.length?(et=t,dt):et},dt.showMenu=function(t){return arguments.length?(nt=t,dt):nt},dt.collapsed=function(){return rt},dt.rowsCount=function(t){return arguments.length?(at=t,dt):at},dt.spacing=function(t){return arguments.length?(J=t,dt):J},dt.gutter=function(t){return arguments.length?($=t,dt):$},dt.radius=function(t){return arguments.length?(Z=t,dt):Z},dt.strings=function(t){return arguments.length?(x=t,dt):x},dt.equalColumns=function(t){return arguments.length?(tt=t,dt):tt},dt.enabled=function(t){return arguments.length?(b=t,dt):b},dt.direction=function(t){return arguments.length?(y=t,dt):y},dt}function s(){var y=960,b=500,x=null,w=z(),k=z(),M="",A=[],I=[],C=!1,S=!1,F=!1,D="left",L="right",T="ltr",E=c();function N(t){return t.each(function(){var t=Nt.select(this),e=t.select(".sc-chart-wrap"),n=e.select(".sc-title-wrap"),r=e.select(".sc-controls-wrap"),a=e.select(".sc-legend-wrap"),i=x.margin(),o=0,l=0,s=0,c=0,u=0,d={width:0,height:0,top:0,left:0},f=0,h=0,p=0;if(C=C&&M&&0<M.length,n.select(".sc-title").remove(),C&&(n.append("text").attr("class","sc-title").attr("x","rtl"===T?y:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(M),(d=zt.getTextBBox(n.select(".sc-title"),!0)).top-=t.node().getBoundingClientRect().top,f=d.height),S&&(w.id("controls_"+x.id()).strings(E.controls).color(["#444"]).align(D).height(b-f),r.datum(A).call(w),s=w.calcMaxWidth()),F&&(k.id("legend_"+x.id()).strings(E.legend).align(L).height(b-f),a.datum(I).call(k),c=k.calcMaxWidth()),u=y/(s+c),s=Math.floor(s*u),c=Math.floor(c*u),S&&(w.arrange(s),c=y-w.width()),F&&(k.arrange(c),s=y-k.width()),S&&(o="rtl"===T?y-w.width():0,l=C?d.height-i.top+d.top:0-w.margin().top,r.attr("transform",zt.translation(o,l)),h=w.height()-(C?0:w.margin().top)),F){var g=zt.getTextBBox(a.select(".sc-menu-link")),m=y-d.width-6,v=!!(C&&!S&&k.collapsed()&&m>g.width);o="rtl"===T||!k.collapsed()&&"center"===L?0:y-k.width(),v?(l=d.height-k.height()/2-g.height/2,l-=i.top-d.top):l=C?d.height-i.top+d.top:0-k.margin().top,a.attr("transform",zt.translation(o,l)),p=v?k.margin().bottom:k.height()-(C?0:k.margin().top)}N.getHeight=function(){var t;return f+Math.max(h,p,10)}}),N}return N.controls=w,N.legend=k,N.chart=function(t){return arguments.length?(x=t,N):x},N.width=function(t){return arguments.length?(y=t,N):y},N.height=function(t){return arguments.length?(b=t,N):b},N.title=function(t){return arguments.length?(M=t,N):M},N.controlsData=function(t){return arguments.length?(A=t,N):A},N.legendData=function(t){return arguments.length?(I=t,N):I},N.showTitle=function(t){return arguments.length?(C=t,N):C},N.showControls=function(t){return arguments.length?(S=t,N):S},N.showLegend=function(t){return arguments.length?(F=t,N):F},N.alignControls=function(t){return arguments.length?(D=t,N):D},N.alignLegend=function(t){return arguments.length?(L=t,N):L},N.direction=function(t){return arguments.length?(T=t,k.direction(t),w.direction(t),N):T},N.strings=function(t){return arguments.length?(E=c(t),k.strings(E.legend),w.strings(E.controls),N):E},N}function l(){var k=Math.floor(1e5*Math.random()),M=960,A=500,I={top:0,right:0,bottom:0,left:0},C=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},S=zt.colorRadialGradient,F=C,D=function(t,e){return"sc-series sc-series-"+t.seriesIndex},L=Nt.scaleLinear(),T=Nt.scaleLinear(),E=Nt.scaleLinear(),N=function(t){return t.x},z=function(t){return t.y},P=function(t){return t.size||1},O=[],_=[],H=[],B=null,R=null,V=null,G=[1*Math.PI,25*Math.PI],W=function(t,e){return Math.sqrt(E(P(t,e))/Math.PI)},Y=function(t,e){return E(P(t,e))},q=function(t){return t.shape||"circle"},e=zt.buildLocality(),X=!0,j=!0,K=function(t){return!t.notActive},Z=!1,U=.1,n="ltr",$=!1,r=0,J=0,Q=!0,tt=!0,et=!1,nt=Nt.dispatch("elementClick","elementMouseover","elementMouseout","elementMousemove"),rt=!1,at,it,ot,lt,st=!1;function ct(t){return t.each(function(s){var n=M-I.left-I.right,r=A-I.top-I.bottom,e=Nt.select(this),t=Nt.transition("scatter").duration(J).ease(Nt.easeLinear);st=!0;var a=B&&R&&V?[]:Nt.merge(s.map(function(t){return t.values.map(function(t,e){return{x:N(t,e),y:z(t,e),size:P(t,e)}})}));function i(){if(L.domain(B||Nt.extent(a.map(N).concat(O))),T.domain(R||Nt.extent(a.map(z).concat(_))),Z&&s[0])if(-1===U){var t=Math.sqrt(G[1]/Math.PI);L.range([0+t,n-t]),T.range([r-t,0+t])}else U<1?(L.range([(n*U+n)/(2*s[0].values.length),n-n*(1+U)/(2*s[0].values.length)]),T.range([r,0])):(L.range([U,n-U]),T.range([r-U,U]));else L.range([0,n]),T.range([r,0]);rt&&T.nice(),et=L.domain()[0]===L.domain()[1]||T.domain()[0]===T.domain()[1],L.domain()[0]===L.domain()[1]&&(L.domain()[0]?L.domain([L.domain()[0]-.1*L.domain()[0],L.domain()[1]+.1*L.domain()[1]]):L.domain([-1,1])),T.domain()[0]===T.domain()[1]&&(T.domain()[0]?T.domain([T.domain()[0]-.1*T.domain()[0],T.domain()[1]+.1*T.domain()[1]]):T.domain([-1,1])),E.domain(V||Nt.extent(a.map(function(t){return t.size}).concat(H))).range(G),E.domain().length<2&&E.domain([0,E.domain()]),at=at||L,it=it||T,ot=ot||E}ct.resetDimensions=function(t,e){A=e,n=(M=t)-I.left-I.right,r=e-I.top-I.bottom,i()},i();var o,l=e.selectAll("g.sc-wrap.sc-scatter").data([s]).enter().append("g").attr("class","sc-wrap sc-scatter"),c=e.select(".sc-wrap.sc-scatter").merge(l),u=l.append("defs"),d=c.select("defs");l.append("g").attr("class","sc-group");var f=c.select(".sc-group");l.append("g").attr("class","sc-point-paths");var h=c.select(".sc-point-paths");c.classed("sc-single-point",et).attr("transform",zt.translation(I.left,I.top)),u.append("clipPath").attr("id","sc-edge-clip-"+k).append("rect"),u.append("clipPath").attr("id","sc-points-clip-"+k).attr("class","sc-point-clips"),d.select("#sc-edge-clip-"+k+" rect").attr("width",n).attr("height",r),c.attr("clip-path",$?"url(#sc-edge-clip-"+k+")":""),ct.gradientFill=function(t,e){var n=k+"-"+e,r={x:.5,y:.5,r:.5,s:0,u:"objectBoundingBox"},a=C(t,e);return S(t,n,r,a,d)};var p=f.selectAll(".sc-series").data(zt.identity,function(t){return t.seriesIndex}),g=p.enter().append("g").attr("class","sc-series").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),m=f.selectAll(".sc-series").merge(g),v,y,b;function x(t,e,n,r){var a;return{pointIndex:n,point:e,seriesIndex:r.seriesIndex,series:r,groupIndex:e.group,id:k,e:t}}function w(){if(!j)return!1;if(!0===Q){var n=Nt.merge(s.map(function(t,i){return t.values.map(function(t,e){var n=N(t,e),r=z(t,e),a=t.group;return[L(n)+1e-4*Math.random(),T(r)+1e-4*Math.random(),t,i,a,e]}).filter(function(t,e){return K(t[4],e)})}));n.length<=3&&(n.push([L.range()[0]-20,T.range()[0]-20,null,null,null,null]),n.push([L.range()[1]+20,T.range()[1]+20,null,null,null,null]),n.push([L.range()[0]-20,T.range()[0]+20,null,null,null,null]),n.push([L.range()[1]+20,T.range()[1]-20,null,null,null,null]));try{var t=Nt.voronoi().extent([[-10,-10],[M+10,A+10]]).polygons(n).map(function(t,e){return{data:t,seriesIndex:n[e][3],groupIndex:n[e][4],pointIndex:n[e][5]}}).filter(function(t){return null!==t.seriesIndex})}catch(t){Q=!1,console.warn("Sucrose: [ERROR] D3 Voronoi paths in line chart are disabled due to error.")}}if(Q){if(tt){var e=c.select("#sc-points-clip-"+k).selectAll("circle").data(n),r=e.enter().append("circle"),a=c.select("#sc-points-clip-"+k).selectAll("circle").merge(r);e.exit().remove(),a.attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]}).attr("r",function(t,e){return t[2]?W(t[2],e):25}),h.attr("clip-path","url(#sc-points-clip-"+k+")")}var i=h.selectAll("path").data(t),o=i.enter().append("path").attr("class",function(t,e){return"sc-path-"+e}),l=h.selectAll("path").merge(o);i.exit().remove(),l.attr("d",function(t){return t?"M"+t.data.join("L")+"Z":null}).on("mouseover",function(t){var e=s[t.seriesIndex],n=t.pointIndex,r=e.values[n];if(st||!e)return 0;var a=x(Nt.event,r,n,e);nt.call("elementMouseover",this,a)}).on("mousemove",function(t){var e=Nt.event;nt.call("elementMousemove",this,e)}).on("mouseout",function(t){var e=s[t.seriesIndex],n=t.pointIndex,r=e.values[n];if(st||!e)return 0;var a=x(Nt.event,r,n,e);nt.call("elementMouseout",this,a)}).on("click",function(t){var e=s[t.seriesIndex],n=t.pointIndex,r=e.values[n];if(st||!e)return 0;var a=x(Nt.event,r,n,e);nt.call("elementClick",this,a)})}else m.selectAll(".sc-point").style("pointer-events","auto").on("mouseover",function(t,e){var n=Nt.select(this.parentNode).datum(),r=n.values[e];if(st||!n)return 0;var a=x(Nt.event,r,e,n);nt.call("elementMouseover",this,a)}).on("mousemove",function(t,e){var n=Nt.event;nt.call("elementMousemove",this,n)}).on("mouseout",function(t,e){var n=Nt.select(this.parentNode).datum(),r=n.values[e];if(st||!n)return 0;var a=x(Nt.event,r,e,n);nt.call("elementMouseout",this,a)}).on("click",function(t,e){var n=Nt.select(this.parentNode).datum(),r=n.values[e];if(st||!n)return 0;var a=x(Nt.event,r,e,n);nt.call("elementClick",this,a)});st=!1}m.attr("class",function(t,e){return D(t,t.seriesIndex)}).attr("fill",function(t,e){return F(t,t.seriesIndex)}).attr("stroke",function(t,e){return F(t,t.seriesIndex)}).classed("hover",function(t){return t.hover}),m.transition(t).style("stroke-opacity",1).style("fill-opacity",1),p.exit().transition(t).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),X?(y=(v=m.selectAll("circle.sc-point").data(function(t){return t.values})).enter().append("circle").attr("class",function(t,e){return"sc-point sc-enter sc-point-"+e}).attr("r",W),(b=m.selectAll(".sc-point").merge(y)).filter(function(t){return Nt.select(this).classed("sc-enter")}).attr("cx",function(t,e){return L(N(t,e))}).attr("cy",function(t,e){return T(0)}),b.transition(t).attr("cx",function(t,e){return L(N(t,e))}).attr("cy",function(t,e){return T(z(t,e))}).on("end",function(t){Nt.select(this).classed("sc-enter",!1).classed("sc-active",function(t){return"active"===t.active})}),p.exit().transition(t).selectAll(".sc-point").attr("cx",function(t,e){return L(N(t,e))}).attr("cy",function(t,e){return T(0)}).remove()):(y=(v=m.selectAll("path.sc-point").data(function(t){return t.values})).enter().append("path").attr("class",function(t,e){return"sc-point sc-enter sc-point-"+e}).attr("d",Nt.symbol().type(q).size(Y)),(b=m.selectAll(".sc-point").merge(y)).filter(function(t){return Nt.select(this).classed("sc-enter")}).attr("transform",function(t,e){return"translate("+at(N(t,e))+","+T(0)+")"}),b.transition(t).attr("transform",function(t,e){return"translate("+L(N(t,e))+","+T(z(t,e))+")"}).attr("d",Nt.symbol().type(q).size(Y)).on("end",function(t){Nt.select(this).classed("sc-enter",!1).classed("active",function(t){return"active"===t.active})}),p.exit().transition(t).selectAll(".sc-point").attr("transform",function(t,e){return"translate("+L(N(t,e))+","+T(0)+")"}).remove()),clearTimeout(lt),lt=setTimeout(w,300),at=L.copy(),it=T.copy(),ot=E.copy(),nt.on("elementMouseover.point",function(t){j&&e.select(".sc-series-"+t.seriesIndex+" .sc-point-"+t.pointIndex).classed("hover",!0)}),nt.on("elementMouseout.point",function(t){j&&e.select(".sc-series-"+t.seriesIndex+" .sc-point-"+t.pointIndex).classed("hover",!1)})}),ct}return ct.dispatch=nt,ct.id=function(t){return arguments.length?(k=t,ct):k},ct.color=function(t){return arguments.length?(C=t,ct):C},ct.fill=function(t){return arguments.length?(F=t,ct):F},ct.classes=function(t){return arguments.length?(D=t,ct):D},ct.gradient=function(t){return arguments.length?(S=t,ct):S},ct.x=function(t){return arguments.length?(N=zt.functor(t),ct):N},ct.y=function(t){return arguments.length?(z=zt.functor(t),ct):z},ct.z=function(t){return arguments.length?(P=zt.functor(t),ct):P},ct.xScale=function(t){return arguments.length?(L=t,ct):L},ct.yScale=function(t){return arguments.length?(T=t,ct):T},ct.zScale=function(t){return arguments.length?(E=t,ct):E},ct.xDomain=function(t){return arguments.length?(B=t,ct):B},ct.yDomain=function(t){return arguments.length?(R=t,ct):R},ct.zDomain=function(t){return arguments.length?(V=t,ct):V},ct.forceX=function(t){return arguments.length?(O=t,ct):O},ct.forceY=function(t){return arguments.length?(_=t,ct):_},ct.forceZ=function(t){return arguments.length?(H=t,ct):H},ct.size=function(t){return arguments.length?(P=zt.functor(t),ct):P},ct.sizeRange=function(t){return arguments.length?(G=t,ct):G},ct.sizeDomain=function(t){return arguments.length?(V=t,ct):V},ct.forceSize=function(t){return arguments.length?(H=t,ct):H},ct.margin=function(t){if(!arguments.length)return I;for(var e in t)t.hasOwnProperty(e)&&(I[e]=t[e]);return ct},ct.width=function(t){return arguments.length?(M=t,ct):M},ct.height=function(t){return arguments.length?(A=t,ct):A},ct.interactive=function(t){return arguments.length?(j=t,ct):j},ct.pointActive=function(t){return arguments.length?(K=t,ct):K},ct.padData=function(t){return arguments.length?(Z=t,ct):Z},ct.padDataOuter=function(t){return arguments.length?(U=t,ct):U},ct.clipEdge=function(t){return arguments.length?($=t,ct):$},ct.clipVoronoi=function(t){return arguments.length?(tt=t,ct):tt},ct.useVoronoi=function(t){return arguments.length?(!1===(Q=t)&&(tt=!1),ct):Q},ct.circleRadius=function(t){return arguments.length?(W=t,ct):W},ct.clipRadius=function(t){return arguments.length?(W=t,ct):W},ct.shape=function(t){return arguments.length?(q=t,ct):q},ct.onlyCircles=function(t){return arguments.length?(X=t,ct):X},ct.singlePoint=function(t){return arguments.length?(et=t,ct):et},ct.delay=function(t){return arguments.length?(r=t,ct):r},ct.duration=function(t){return arguments.length?(J=t,ct):J},ct.direction=function(t){return arguments.length?(n=t,ct):n},ct.nice=function(t){return arguments.length?(rt=t,ct):rt},ct.locality=function(t){return arguments.length?(e=zt.buildLocality(t),ct):e},ct}function y(){var I=l(),C={top:0,right:0,bottom:0,left:0},S=960,F=500,D=function(t){return t.x},L=function(t){return t.y},T,E,N=function(t,e){return!isNaN(L(t,e))&&null!==L(t,e)},z=function(t){return t&&t.area||!1},P="linear",O=!1,e=0,_=0,H=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},B=null,n=H,R=function(t,e){return"sc-series sc-series-"+t.seriesIndex};function V(t){return t.each(function(t){var e=Nt.select(this),n=S-C.left-C.right,r=F-C.top-C.bottom,a="linear"===P?Nt.curveLinear:"cardinal"===P?Nt.curveCardinal:"monotone"===P?Nt.curveMonotoneX:"basis"===P?Nt.curveBasis:Nt.curveNatural,i=Nt.area().curve(a).defined(N).x(function(t,e){return T(D(t,e))}).y0(function(t,e){return E(L(t,e))}).y1(function(t,e){return E(E.domain()[0]<=0?0<=E.domain()[1]?0:E.domain()[1]:E.domain()[0])}),o=Nt.area().curve(a).defined(N).x(function(t,e){return T(D(t,e))}).y0(function(t,e){return E(0)}).y1(function(t,e){return E(E.domain()[0]<=0?0<=E.domain()[1]?0:E.domain()[1]:E.domain()[0])}),l=Nt.transition("points").duration(_).ease(Nt.easeLinear),s=I.id();B=function(t,e,n){return zt.colorLinearGradient(t,I.id()+"-"+e,n,H(t,e),d.select("defs"))},T=I.xScale(),E=I.yScale(),V.resetDimensions=function(t,e){F=e,n=(S=t)-C.left-C.right,r=e-C.top-C.bottom,I.resetDimensions(t,e)};var c,u=e.selectAll("g.sc-wrap.sc-line").data([t]).enter().append("g").attr("class","sc-wrap sc-line"),d=e.select(".sc-wrap.sc-line").merge(u),f=u.append("defs");u.append("g").attr("class","sc-group");var h=d.select(".sc-group");u.append("g").attr("class","sc-scatter-wrap");var p=d.select(".sc-scatter-wrap");d.attr("transform",zt.translation(C.left,C.top)),f.append("clipPath").attr("id","sc-edge-clip-"+s).append("rect"),d.select("#sc-edge-clip-"+s+" rect").attr("width",n).attr("height",r),d.attr("clip-path",O?"url(#sc-edge-clip-"+s+")":""),p.attr("clip-path",O?"url(#sc-edge-clip-"+s+")":"");var g=h.selectAll("g.sc-series").data(t,function(t){return t.seriesIndex}),m=g.enter().append("g").attr("class","sc-series").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),v=h.selectAll(".sc-series").merge(m);v.classed("hover",function(t){return t.hover}).attr("class",R).attr("fill",H).attr("stroke",H),v.transition(l).style("stroke-opacity",1).style("fill-opacity",.5),g.exit().transition(l).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),I.clipEdge(O).width(n).height(r),p.call(I);var y=v.selectAll("path.sc-area").data(function(t){return z(t)?[t]:[]}),b=y.enter().append("path").attr("class","sc-area sc-enter"),x=v.selectAll(".sc-area").merge(b);function w(r){return r.values&&r.values.length?1<r.values.length?[r.values]:[T.domain().map(function(t,e){if(Array.isArray(r.values[0]))return[t,r.values[0][1]];var n=JSON.parse(JSON.stringify(r.values[0]));return n.x=t,n})]:[null];var t}x.filter(function(t){return Nt.select(this).classed("sc-enter")}).attr("d",function(t){return o.apply(this,[t.values])}),x.transition(l).attr("d",function(t){return i.apply(this,[t.values])}).on("end",function(t){Nt.select(this).classed("sc-enter",!1)}),y.exit().remove(),g.exit().transition(l).selectAll(".sc-area").attr("d",function(t){return o.apply(this,[t.values])}).remove();var k,M=v.selectAll("path.sc-line").data(w,function(t){return t.seriesIndex}).enter().append("path").attr("class","sc-line sc-enter"),A=v.selectAll(".sc-line").merge(M);A.filter(function(t){return Nt.select(this).classed("sc-enter")}).attr("d",Nt.line().curve(a).defined(N).x(function(t,e){return T(D(t,e))}).y(function(t,e){return E(0)})),A.transition(l).attr("d",Nt.line().curve(a).defined(N).x(function(t,e){return T(D(t,e))}).y(function(t,e){return E(L(t,e))})).on("end",function(t){Nt.select(this).classed("sc-enter",!1)}),g.exit().transition(l).selectAll(".sc-line").attr("d",Nt.line().curve(a).defined(N).x(function(t,e){return T(D(t,e))}).y(function(t,e){return E(0)})).remove()}),V}return V.dispatch=I.dispatch,V.scatter=I,zt.rebind(V,I,"id","interactive","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","sizeRange","forceX","forceY","forceSize","useVoronoi","clipVoronoi","clipRadius","padData","padDataOuter","singlePoint","direction","nice","locality"),V.color=function(t){return arguments.length?(H=t,I.color(H),V):H},V.fill=function(t){return arguments.length?(n=t,I.fill(n),V):n},V.classes=function(t){return arguments.length?(R=t,I.classes(R),V):R},V.gradient=function(t){return arguments.length?(B=t,V):B},V.margin=function(t){if(!arguments.length)return C;for(var e in t)t.hasOwnProperty(e)&&(C[e]=t[e]);return V},V.width=function(t){return arguments.length?(S=t,V):S},V.height=function(t){return arguments.length?(F=t,V):F},V.x=function(t){return arguments.length?(D=t,I.x(t),V):D},V.y=function(t){return arguments.length?(L=t,I.y(t),V):L},V.delay=function(t){return arguments.length?(e=t,V):e},V.duration=function(t){return arguments.length?(_=t,I.duration(t),V):_},V.clipEdge=function(t){return arguments.length?(O=t,V):O},V.interpolate=function(t){return arguments.length?(P=t,V):P},V.defined=function(t){return arguments.length?(N=t,V):N},V.isArea=function(t){return arguments.length?(z=zt.functor(t),V):z},V}function b(){var at={top:0,right:0,bottom:0,left:0},it=960,ot=500,lt=Nt.scaleBand(),st=Nt.scaleLinear(),ct=Math.floor(1e4*Math.random()),ut=function(t){return t.x},dt=function(t){return t.y},ft=function(t,e,n){return n||t},ht=function(t,e){return ft(t.y,e,t.label)},e=zt.buildLocality(),pt=[],gt=[0],mt=!0,n,vt=!1,yt=!1,bt=!0,xt=60,wt="ltr",kt=!1,r=0,a=0,i=null,o=null,Mt=!1,At=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},It=zt.colorLinearGradient,Ct=At,St=!1,l=null,Ft=function(t,e){return"sc-series sc-series-"+t.seriesIndex},Dt=Nt.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),Lt,Tt;function Et(t){return t.each(function(i){var t=Nt.select(this),f=it-at.left-at.right,h=ot-at.top-at.bottom,e=bt?"width":"height",n=bt?"height":"width",r=bt?"x":"y",a=bt?"y":"x",p=0,g=0,o=0,l=i.length-1,m=!1,v=!1,u=vt,y=!1,b=[],x=0,w=[],k=[],s=[];function d(t){return t?1:-1}function M(t){return t.reverse().filter(function(t,e,n){return-1===n.indexOf(t,e+1)}).reverse()}if(u&&(mt?"top"!==u&&!0!==u||(u="end"):"total"===u?u="top":!0===u&&(u="end"),m=bt,y="total"===u||"top"===u),mt&&(s=[],i[0].values.map(function(t,n){var r=0,a=0;i.map(function(t){var e=t.values[n];e.size=Math.abs(e.y),e.y<0?(e.y0=a-(bt?0:e.size),a-=e.size):(e.y0=r+(bt?e.size:0),r+=e.size)}),s[n]={neg:{label:ft(a,n),y:a},pos:{label:ft(r,n),y:r}}})),Et.resetDimensions=function(t,e){ot=e,f=(it=t)-at.left-at.right,h=e-at.top-at.bottom,A()},k=Nt.merge(i.map(function(t){return t.values})),p=i.length,g=i[0].values.length,vt){i.forEach(function(t,e){t.values.forEach(function(t,e){t.label=ht(t)})}),w="total"===u?Nt.merge(s.map(function(t){return[t.neg,t.pos]})):k,b=zt.stringSetLengths(w.map(ht),t,"sc-label-value"),x=zt.stringSetThickness(["Xy"],t,"sc-label-value")[0];var c=Nt.extent(i.map(function(t,e){return t.seriesIndex}));o=c[0],l=c[1]}function A(){var t=t||M(k.map(ut).concat(pt)),e=bt?f:h,n=bt?h:f,r=mt?xt:xt*p+xt,a=xt*(mt?.25:1),i=Math.max(.25,(e-g*r-a)/(2*r));lt.domain(t).range([0,e]).paddingInner(yt?.3:.25).paddingOuter(i);var o=o||Nt.extent(k.map(function(t){var e=t.y0+(bt?0:t.y),n=t.y0+(bt?t.y:0);return mt?0<t.y?e:n:t.y}).concat(gt)),l=bt?[n,0]:[0,n];if(st.domain(o).range(l),vt&&(m=bt&&Nt.max(b)+8>G(),v=m||!bt),y){var s=0,c=n,u=0,d=0;a=bt?m?2:-2:2,w.forEach(function(t,e){var n=v?b[e]:x,r=parseFloat(t.y),a=st(r),i=0;bt&&0<r||!bt&&r<0?(i=a-n)<s&&(d=n,s=i):c<(i=a+n)&&(u=n,c=i)}),bt?st.range([n-(st.domain()[0]<0?u+a+2:0),0<st.domain()[1]?d+a:0]):st.range([st.domain()[0]<0?d+a+4:0,n-(0<st.domain()[1]?u+a:0)])}Mt&&st.nice(),Lt=Lt||lt,Tt=Tt||st}A();var I,C=t.selectAll("g.sc-wrap.sc-multibar").data([i]).enter().append("g").attr("class","sc-wrap sc-multibar"),S=t.select(".sc-wrap.sc-multibar").merge(C),F=C.append("defs"),D=S.select("defs");if(S.attr("transform",zt.translation(at.left,at.top)),kt&&(F.append("clipPath").attr("id","sc-edge-clip-"+ct).append("rect"),D.select("#sc-edge-clip-"+ct+" rect").attr("width",f).attr("height",h)),S.attr("clip-path",kt?"url(#sc-edge-clip-"+ct+")":""),St)var L=zt.createTexture(F,ct);Et.gradientFill=function(t,e,n){var r=ct+"-"+e,a=At(t,e);return It(t,r,n,a,D)};var T=Ct===At,E=S.selectAll(".sc-series").data(zt.identity),N=E.enter().append("g").attr("class",Ft).style("stroke-opacity",1e-6).style("fill-opacity",1e-6);E.exit().remove();var z=S.selectAll(".sc-series").merge(N);z.attr("fill",Ct).attr("class",Ft).classed("hover",function(t){return t.hover}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active}).style("stroke-opacity",1).style("fill-opacity",1),z.on("mouseover",function(t,e,n){Nt.select(this).classed("hover",!0)}).on("mouseout",function(t,e,n){Nt.select(this).classed("hover",!1)});var P=z.selectAll(".sc-bar").data(function(t){return t.values}),O=P.enter().append("g").attr("class","sc-bar");P.exit().remove();var _=z.selectAll(".sc-bar").merge(O);O.append("rect").attr("class","sc-base").style("fill","inherit").attr("x",0).attr("y",0),St&&O.append("rect").attr("class","sc-texture").attr("x",0).attr("y",0).style("mask","url("+L+")"),O.append("rect").attr("class","sc-label-box").attr("x",0).attr("y",0).attr("width",0).attr("height",0).attr("rx",2).attr("ry",2).style("fill","transparent").style("stroke-width",0).style("fill-opacity",0);var H=_.select(".sc-label-box");O.append("text").attr("class","sc-label-value");var B=_.select(".sc-label-value");function R(t,e){var n=Ct(t),r="inherit"===n?Nt.select("."+Ft(t,e).split(" ").join(".")).style("color"):n;return zt.getTextContrast(r,e)}function V(t,e){return Math.max(Math.round(Math.abs(st(dt(t,e))-st(0))),0)}function G(){return lt.bandwidth()/(mt?1:i.length)}function W(t,e){var n;return"translate("+(n=mt?{x:Math.round(lt(ut(t,e))),y:Math.round(st(t.y0))}:{x:Math.round(t.seri*G()+lt(ut(t,e))),y:Math.round(dt(t,e)<0?st(bt?0:dt(t,e)):st(bt?dt(t,e):0))})[r]+","+n[a]+")"}function Y(t,e){var n="total"===u?s[e][dt(t,e)<0?"neg":"pos"]:t;return ht(n)}function q(t,e){var n=this.getBoundingClientRect(),r=Math.floor(n.width),a=Math.floor(n.height);t.labelWidth=t.labelWidth||(m?a:r)+4,t.labelHeight=t.labelHeight||(m?r:a),t.barLength=V(t,e),t.barThickness=G()}function X(t,e){var n="middle",r=dt(t,e)<0;if(v){switch(u){case"start":n=r?"end":"start";break;case"middle":n="middle";break;case"end":n=r?"start":"end";break;case"top":case"total":n=r?"end":"start"}n="rtl"===wt&&"middle"!==n?"start"===n?"end":"start":n}else n="middle";return n}function j(t,e){var n=0,r=dt(t,e)<0?-1:1,a=r<0,i=(4+2*v)*r;if(bt&&!m)n=t.barThickness/2;else switch(u){case"start":n=t.barLength*(a-m)+i;break;case"middle":n=t.barLength*(m?-1:1)/2;break;case"end":n=t.barLength*(!m-a)-i;break;case"top":case"total":n=t.barLength*(!m-a)+2*r}return n}function K(t,e){var n=0,r=dt(t,e)<0?-1:1,a=r<0,i=(t.labelHeight/2+(4+2*m)*!y)*r;if(v)n=t.barThickness/2;else switch(u){case"start":n=t.barLength*(1-a)-i;break;case"middle":n=t.barLength/2;break;case"end":n=t.barLength*(0+a)+i;break;case"top":case"total":n=t.barLength*(0+a)-i}return n}function Z(t,e,n){return y?"#000":R(t,e)}function U(t,e){if(y){if("total"===u&&mt){var n=dt(t,e);return n<0&&s[e].neg.y===t.y0+(bt?n:0)||0<=n&&s[e].pos.y===t.y0+(bt?0:n)?1:0}return 1}var r=t.barLength<(v?t.labelWidth:t.labelHeight)+8,a=t.barThickness<(v?t.labelHeight:t.labelWidth)+4;return r||a?0:1}function $(t,e){return Q(t,e,!0)}function J(t,e){return Q(t,e,!1)}function Q(t,e,n){var r,a,i,o,l,s,c;if(a=(r=0)<=dt(t,e),i=4*d(n)*d(a),o=n===a?0:1,!n^bt)r=(t.barThickness-(v?t.labelHeight:t.labelWidth))/2;else switch(s=t.barLength-(v?t.labelWidth:t.labelHeight),u){case"start":r=s*(0+o)+i;break;case"middle":r=s/2;break;case"end":r=s*(1-o)-i;break;case"top":case"total":l=m===n?t.labelHeight:t.labelWidth,r=t.barLength*(1-o)-l*(0+o)}return r}function tt(t){return m?t.labelHeight:t.labelWidth}function et(t){return m?t.labelWidth:t.labelHeight}function nt(t,e){return y?"#fff":At(t,e)}function rt(t,e,n){return{pointIndex:n,point:e,seriesIndex:e.seriesIndex,series:i[e.seri],groupIndex:e.groupIndex,id:ct,e:t}}_.attr("class",function(t,e){return"sc-bar "+(dt(t,e)<0?"negative":"positive")}).classed("sc-active",function(t){return"active"===t.active}).attr("transform",W).style("display",function(t,e){return 0!==V(t,e)?"inline":"none"}),_.select("rect.sc-base").attr(r,0).attr(n,V).attr(e,G),St&&_.select("rect.sc-texture").attr(r,0).attr(n,V).attr(e,G).style("fill",R),vt?(B.text(Y).attr("transform","rotate("+(0-90*m)+")").each(q),B.attr("dy","0.35em").attr("text-anchor",X).attr("x",j).attr("y",K).style("fill",Z).style("fill-opacity",U),H.attr("x",$).attr("y",J).attr("width",tt).attr("height",et).style("fill",nt).style("fill-opacity",U)):(B.text("").style("fill-opacity",0),_.select("rect.label-box").style("fill-opacity",0)),_.on("mouseover",function(t,e){var n=rt(Nt.event,t,e);Dt.call("elementMouseover",this,n)}).on("mousemove",function(t,e){var n=Nt.event;Dt.call("elementMousemove",this,n)}).on("mouseout",function(t,e){var n=rt(Nt.event,t,e);Dt.call("elementMouseout",this,n)}).on("click",function(t,e){Nt.event.stopPropagation();var n=rt(Nt.event,t,e);Dt.call("elementClick",this,n)}).on("dblclick",function(t,e){Nt.event.stopPropagation();var n=rt(Nt.event,t,e);Dt.call("elementDblClick",this,n)}),Lt=lt.copy(),Tt=st.copy()}),Et}return Et.dispatch=Dt,Et.color=function(t){return arguments.length?(At=t,Et):At},Et.fill=function(t){return arguments.length?(Ct=t,Et):Ct},Et.classes=function(t){return arguments.length?(Ft=t,Et):Ft},Et.gradient=function(t){return arguments.length?(It=t,Et):It},Et.x=function(t){return arguments.length?(ut=t,Et):ut},Et.y=function(t){return arguments.length?(dt=t,Et):dt},Et.margin=function(t){if(!arguments.length)return at;for(var e in t)t.hasOwnProperty(e)&&(at[e]=t[e]);return Et},Et.width=function(t){return arguments.length?(it=t,Et):it},Et.height=function(t){return arguments.length?(ot=t,Et):ot},Et.xScale=function(t){return arguments.length?(lt=t,Et):lt},Et.yScale=function(t){return arguments.length?(st=t,Et):st},Et.xDomain=function(t){return arguments.length?(i=t,Et):i},Et.yDomain=function(t){return arguments.length?(o=t,Et):o},Et.forceX=function(t){return arguments.length?(pt=t,Et):pt},Et.forceY=function(t){return arguments.length?(gt=t,Et):gt},Et.stacked=function(t){return arguments.length?(mt=t,Et):mt},Et.barColor=function(t){return arguments.length?(l=zt.getColor(t),Et):l},Et.disabled=function(t){return arguments.length?(n=t,Et):n},Et.id=function(t){return arguments.length?(ct=t,Et):ct},Et.delay=function(t){return arguments.length?(r=t,Et):r},Et.duration=function(t){return arguments.length?(a=t,Et):a},Et.clipEdge=function(t){return arguments.length?(kt=t,Et):kt},Et.showValues=function(t){return arguments.length?(vt=isNaN(parseInt(t,10))?t:!!parseInt(t,10),Et):vt},Et.valueFormat=function(t){return arguments.length?(ft=t,Et):ft},Et.withLine=function(t){return arguments.length?(yt=t,Et):yt},Et.vertical=function(t){return arguments.length?(bt=t,Et):bt},Et.baseDimension=function(t){return arguments.length?(xt=t,Et):xt},Et.direction=function(t){return arguments.length?(wt=t,Et):wt},Et.textureFill=function(t){return arguments.length?(St=t,Et):St},Et.nice=function(t){return arguments.length?(Mt=t,Et):Mt},Et.locality=function(t){return arguments.length?(e=zt.buildLocality(t),Et):e},Et}function u(){var X={top:0,right:0,bottom:0,left:0},j=500,K=500,Z=Math.floor(1e4*Math.random()),e=function(t){return(t.series||t).key},U=function(t,e){return(t.series||t).value},$=function(t,e){return(t.series||t).count},J=function(t){return e(t)},n=function(t){return U(t)},r=function(t){return isNaN($(t))?"":" ("+$(t)+")"},a=zt.buildLocality(),Q="ltr",i=0,o=0,tt=function(t,e){return zt.defaultColor()(t.series,t.seriesIndex)},et=zt.colorRadialGradient,nt=tt,rt=!1,at=function(t,e){return"sc-series sc-series-"+t.seriesIndex},it=!0,ot=!0,lt=!0,st=!0,ct=.01,ut=!1,dt=!1,ft=!1,ht=20,pt=5,l=360,s=0,gt=.447,mt=75,vt=250,yt=Nt.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),bt=function(t,e){var n=t.selectAll(".sc-hole-container").data(e),r;n.enter().append("g").attr("class","sc-hole-container").append("text").text(e).attr("class","sc-pie-hole-value").attr("dy",".35em").attr("text-anchor","middle").style("font-size","50px"),n.exit().remove()},xt=function(t){return t.startAngle*l/360+zt.angleToRadians(s)},wt=function(t){return t.endAngle*(l/360)+zt.angleToRadians(s)},kt=function(t){return null},Mt=Nt.pie().sort(null).value(U);function At(t){return t.each(function(t){var b=j-X.left-X.right,e=K-X.top-X.bottom,s=Nt.select(this),d=[],n=!(!it||!lt);n&&(d=zt.stringSetLengths(t.map(J),s,"sc-label"));var r,a=s.selectAll("g.sc-wrap").data([t]).enter().append("g").attr("class","sc-wrap sc-pie"),i=s.select(".sc-wrap.sc-pie").merge(a),o=a.append("defs"),l=i.select("defs");a.append("g").attr("class","sc-group");var c=i.select(".sc-group");a.append("g").attr("class","sc-hole-wrap");var u=i.select(".sc-hole-wrap");if(i.attr("transform",zt.translation(X.left,X.top)),rt)var f=zt.createTexture(o,Z,-b/2,-e/2);At.gradientFill=function(t,e){var n=Z+"-"+e,r={x:0,y:0,r:T,s:ut?100*gt+"%":"0%",u:"userSpaceOnUse"},a=tt(t,e);return et(t,n,r,a,l)};var h=c.selectAll(".sc-series").data(Mt),p=h.enter().append("g").attr("class","sc-series");h.exit().remove();var g=c.selectAll(".sc-series").merge(p);p.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",0).on("mouseover",function(t,e,n){Nt.select(this).classed("hover",!0)}).on("mouseout",function(t,e,n){Nt.select(this).classed("hover",!1)}),g.attr("class",function(t){return at(t.data,t.data.seriesIndex)}).attr("fill",function(t){return nt(t.data,t.data.seriesIndex)}).classed("sc-active",function(t){return"active"===t.data.active}).classed("sc-inactive",function(t){return"inactive"===t.data.active});var m=g.selectAll("g.sc-slice").data(function(n,r){return n.data.values.map(function(t,e){return t.endAngle=n.endAngle,t.padAngle=n.padAngle,t.startAngle=n.startAngle,t.index=r,t})},function(t){return t.seriesIndex});m.exit().remove();var v=m.enter().append("g").attr("class","sc-slice"),y=g.selectAll("g.sc-slice").merge(v);v.append("path").attr("class","sc-base").each(function(t,e){this._current=t}),rt&&v.append("path").attr("class","sc-texture").each(function(t,e){this._current=t}).style("mask","url("+f+")"),v.on("mouseover",function(t,e){Nt.select(this).classed("hover",!0);var n=H(Nt.event,t,e);yt.call("elementMouseover",this,n)}).on("mousemove",function(t,e){var n=Nt.event;yt.call("elementMousemove",this,n)}).on("mouseout",function(t,e){Nt.select(this).classed("hover",!1),yt.call("elementMouseout",this)}).on("click",function(t,e){Nt.event.stopPropagation();var n=H(Nt.event,t,e);yt.call("elementClick",this,n)}).on("dblclick",function(t,e){Nt.event.stopPropagation();var n=H(Nt.event,t,e);yt.call("elementDblClick",this,n)}),v.append("g").attr("class","sc-label").attr("transform","translate(0,0)"),v.select(".sc-label").append("rect").style("fill-opacity",0).style("stroke-opacity",0),v.select(".sc-label").append("text").style("fill-opacity",0),v.append("polyline").attr("class","sc-label-leader").style("stroke-opacity",0);var x=b/2,w=e/2,k=[],M=[],A=0,I=n?5:0,C=ht+pt,S=0;y.select(".sc-base").call(B,x,w),u.call(bt,dt?[dt]:[]),dt&&0<(S=V())&&(I+=S,A-=S/2);var F=b/2,D=e/2;n&&(ht=Math.max(Math.min(Math.min(R())/12,20),10)),kt(At)&&(mt=kt(At),vt=kt(At));var L=Math.min(Math.max(R(),mt),vt),T=L-(n?ht:0),E,N;D+=((Nt.max(M)-Nt.min(M))/2+Nt.min(M))*((L+A)/D)+A/2;var z=(Nt.max(k)-Nt.min(k))/2-Nt.max(k),P;F+=z*(L/F),c.attr("transform","translate("+F+","+D+")"),u.attr("transform","translate("+F+","+D+")"),c.select(f).attr("x",-T/2).attr("y",-T/2);var O=Nt.arc().innerRadius(ut?T*gt:0).outerRadius(T).startAngle(xt).endAngle(wt),_=Nt.arc().innerRadius(0).outerRadius(T).startAngle(xt).endAngle(wt);function H(t,e,n){return{id:Z,key:J(e),value:U(e),count:$(e),data:e,series:e.series,seriesIndex:e.series.seriesIndex,e:t}}function B(t,s,c){var u=[],d=[],f=2*Math.PI,h=0,p=Math.PI/2,g=Math.PI,m=3*Math.PI/2,v=0;function y(t){return(t+v)%f}t.each(function(t,e){var n=0===xt(t)?0:(xt(t)+f)%f,r=0===wt(t)?0:(wt(t)+f)%f,a=Math.round(1e4*Math.sin(n))/1e4,i=Math.round(1e4*Math.sin(r))/1e4,o=Math.round(1e4*Math.cos(n))/1e4,l=Math.round(1e4*Math.cos(r))/1e4;v=r<n?f-n:0,r===n?(n=0,r=f):(n=y(n),r=y(r)),h=y(h),p=y(p),g=y(g),m=y(m),n%f!=0&&r%f!=0||(d.push(c),ut&&d.push(c*gt)),n<=p&&p<=r&&(u.push(s),ut&&u.push(s*gt)),n<=g&&g<=r&&(d.push(-c),ut&&d.push(-c*gt)),n<=m&&m<=r&&(u.push(-s),ut&&u.push(-s*gt)),u.push(s*a),u.push(s*i),ut?(u.push(s*gt*a),u.push(s*gt*i)):u.push(0),d.push(c*o),d.push(c*l),ut?(d.push(c*gt*o),d.push(c*gt*l)):d.push(0)}),k=Nt.extent(u),M=Nt.extent(d),x*=b/(Nt.max(k)-Nt.min(k)),w*=e/(Nt.max(M)-Nt.min(M))}function R(){var c=[x],u=[w+ht],t;return g.select(".sc-base").each(function(t,e){if(G(t)){var n=(xt(t)+wt(t))/2,r=Math.sin(n),a=Math.cos(n),i=x-C-d[e],o=w-I,l=r?i/r:i,s=a?o/a:o;c.push(l),u.push(s)}}),Nt.min(c.concat(u).concat([]),function(t){return Math.abs(t)})}function V(){var t=.3*u.node().getBoundingClientRect().height,e=Math.abs(w*Nt.min(M)),n;return Math.round(t-e)}function G(t){var e=(wt(t)-xt(t))/(2*Math.PI);return ct<e?1:0}function W(t,e){var n=2*Math.PI,r=((xt(t)+wt(t))/2+n)%n;return 0<r&&r<Math.PI?1:-1}function Y(t){ut||(t.innerRadius=0);var n=Nt.interpolate(this._current,t);return this._current=n(0),function(t){var e=n(t);return O(e)}}function q(t){t.innerRadius=0;var e=Nt.interpolate({startAngle:0,endAngle:0},t);return function(t){return O(e(t))}}lt&&(!ut||st?_.innerRadius(L).outerRadius(L):_.outerRadius(T*gt)),y.select(".sc-base").attr("d",O).style("stroke-opacity",function(t){return xt(t)===wt(t)?0:1}),rt&&y.select(".sc-texture").attr("d",O).style("stroke-opacity",function(t){return xt(t)===wt(t)?0:1}).style("fill",function(t,e){var n=t.series||t,r=n.seriesIndex||e,a=nt(n),i="inherit"===a?Nt.select("."+at(n,r).split(" ").join(".")).style("color"):a;return zt.getTextContrast(i,r)}),it?(y.select(".sc-label").attr("transform",function(t){if(ft){t.outerRadius=T+10,t.innerRadius=T+15;var e=(xt(t)+wt(t))/2*(180/Math.PI);return e+=90*W(t,_),"translate("+_.centroid(t)+") rotate("+e+")"}var n=_.centroid(t),r=ot?(ht+pt)*W(t,_):0;return"translate("+[n[0]+r,n[1]]+")"}),y.select(".sc-label text").text(J).attr("dy",".35em").style("fill","#555").style("fill-opacity",G).style("text-anchor",function(t){if(!lt)return"middle";var e=1===W(t,_)?"start":"end";return"rtl"===Q&&(e="start"===e?"end":"start"),e}),y.each(function(t,e){var n,r,a,i,o,l;(d[e]>mt||L===mt)&&(n=(xt(t)+wt(t))/2,r=Math.abs(Math.sin(n)),a=d[t.index],(o=b/2-F+b/2-(i=L*r+ht+pt+a))<0&&(l=zt.stringEllipsify(J(t),s,a+o),Nt.select(this).select("text").text(l)))}),lt?ot&&y.select(".sc-label-leader").attr("points",function(t){if(!G(t))return"0,0 0,0";var e=Nt.arc().innerRadius(T).outerRadius(T).startAngle(xt).endAngle(wt),n=ot?ht*W(t,e):0,r=e.centroid(t),a=_.centroid(t),i;return r+" "+a+" "+[a[0]+n,a[1]]}).style("stroke","#AAA").style("fill","none").style("stroke-opacity",G):y.select(".sc-label").each(function(t){if(G(t)){var e=Nt.select(this),n=e.select("text").node().getBoundingClientRect();e.select("rect").attr("rx",3).attr("ry",3).attr("width",n.width+10).attr("height",n.height+10).attr("transform",function(){return"translate("+[n.x-5,n.y-5]+")"}).style("fill","#FFF").style("fill-opacity",G)}})):(y.select(".sc-label-leader").style("stroke-opacity",0),y.select(".sc-label rect").style("fill-opacity",0),y.select(".sc-label text").style("fill-opacity",0))}),At}return At.dispatch=yt,At.id=function(t){return arguments.length?(Z=t,At):Z},At.color=function(t){return arguments.length?(tt=t,At):tt},At.fill=function(t){return arguments.length?(nt=t,At):nt},At.classes=function(t){return arguments.length?(at=t,At):at},At.gradient=function(t){return arguments.length?(et=t,At):et},At.margin=function(t){return arguments.length?(X.top=void 0!==t.top?t.top:X.top,X.right=void 0!==t.right?t.right:X.right,X.bottom=void 0!==t.bottom?t.bottom:X.bottom,X.left=void 0!==t.left?t.left:X.left,At):X},At.width=function(t){return arguments.length?(j=t,At):j},At.height=function(t){return arguments.length?(K=t,At):K},At.getKey=function(t){return arguments.length?(e=t,At):e},At.getValue=function(t){return arguments.length?(U=t,At):U},At.getCount=function(t){return arguments.length?($=t,At):$},At.fmtKey=function(t){return arguments.length?(J=t,At):J},At.fmtValue=function(t){return arguments.length?(n=t,At):n},At.fmtCount=function(t){return arguments.length?(r=t,At):r},At.direction=function(t){return arguments.length?(Q=t,At):Q},At.delay=function(t){return arguments.length?(i=t,At):i},At.duration=function(t){return arguments.length?(o=t,At):o},At.locality=function(t){return arguments.length?(a=zt.buildLocality(t),At):a},At.textureFill=function(t){return arguments.length?(rt=t,At):rt},At.showLabels=function(t){return arguments.length?(it=t,At):it},At.labelSunbeamLayout=function(t){return arguments.length?(ft=t,At):ft},At.donutLabelsOutside=function(t){return arguments.length?(st=t,At):st},At.pieLabelsOutside=function(t){return arguments.length?(lt=t,At):lt},At.showLeaders=function(t){return arguments.length?(ot=t,At):ot},At.donut=function(t){return arguments.length?(ut=t,At):ut},At.hole=function(t){return arguments.length?(dt=t,At):dt},At.holeFormat=function(t){return arguments.length?(bt=zt.functor(t),At):bt},At.donutRatio=function(t){return arguments.length?(gt=t,At):gt},At.startAngle=function(t){return arguments.length?(xt=t,At):xt},At.endAngle=function(t){return arguments.length?(wt=t,At):wt},At.labelThreshold=function(t){return arguments.length?(ct=t,At):ct},At.arcDegrees=function(t){return arguments.length?(l=Math.max(Math.min(t,360),1),At):l},At.rotateDegrees=function(t){return arguments.length?(s=t%360,At):s},At.minRadius=function(t){return arguments.length?(mt=t,At):mt},At.maxRadius=function(t){return arguments.length?(vt=t,At):vt},At.fixedRadius=function(t){return arguments.length?(kt=zt.functor(t),At):kt},At}function d(){var S,F={},D,L,T,E,N,z,P;function O(e,n,r,c){var a=e.select("defs"),i=n.select("defs"),l=r.select(".sc-axis-wrap.sc-axis-x"),s=r.select(".sc-bars-wrap"),o,u,d,f,h=0;function t(){if(P){var t=Nt.zoom().on("zoom",N);r.call(t),u.call(t)}else r.on("zoom",null),u.on("zoom",null)}function p(){i.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-back-gradient-prev-"+S);var t=i.select("#sc-back-gradient-prev-"+S);i.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-back-gradient-more-"+S);var e=i.select("#sc-back-gradient-more-"+S);t.append("stop").attr("stop-color","#000").attr("stop-opacity","0.3").attr("offset",0),t.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",1),e.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",0),e.append("stop").attr("stop-color","#000").attr("stop-opacity","0.3").attr("offset",1),i.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-fore-gradient-prev-"+S);var n=i.select("#sc-fore-gradient-prev-"+S);i.append("linearGradient").attr("class","sc-scroll-gradient").attr("gradientUnits","objectBoundingBox").attr("x1",0).attr("y1",0).attr("id","sc-fore-gradient-more-"+S);var r=i.select("#sc-fore-gradient-more-"+S);n.append("stop").attr("stop-color","#FFF").attr("stop-opacity","1").attr("offset",0),n.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",1),r.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",0),r.append("stop").attr("stop-color","#FFF").attr("stop-opacity","1").attr("offset",1),a.selectAll(".sc-scroll-gradient").attr("gradientUnits","objectBoundingBox").attr("x1",0).attr("y1",0)}function g(){a.selectAll(".sc-scroll-gradient").attr("x2",D?1:0).attr("y2",D?0:1)}function m(){i.append("clipPath").attr("class","sc-scroll-mask").attr("id","sc-edge-clip-"+S).append("rect"),o=a.select(".sc-scroll-mask rect")}function v(){r.attr("clip-path",P?"url(#sc-edge-clip-"+S+")":"")}function y(t,e){o.attr("x",D?2:-F.left).attr("y",D?0:2).attr("width",t+(D?-2:F.left)).attr("height",e+(D?F.bottom:-2))}function b(){n.select(".sc-background-wrap").append("rect").attr("class","sc-scroll-target").attr("fill","transparent"),u=e.select(".sc-scroll-target")}function x(t,e,n,r){u.attr("x",t).attr("y",e).attr("width",n).attr("height",r)}function w(){var t=n.select(".sc-background-wrap").append("g").attr("class","sc-back-shadow-wrap");t.append("rect").attr("class","sc-back-shadow-prev"),t.append("rect").attr("class","sc-back-shadow-more"),d=e.select(".sc-back-shadow-wrap")}function k(){var t=D?"width":"height";d.select("rect.sc-back-shadow-prev").attr("fill",P?"url(#sc-back-gradient-prev-"+S+")":"transparent").attr(t,7),d.select("rect.sc-back-shadow-more").attr("fill",P?"url(#sc-back-gradient-more-"+S+")":"transparent").attr(t,7)}function M(t,e,n,r,a,i){d.select(".sc-back-shadow-prev").attr("x",t).attr("y",e).attr(a,i),d.select(".sc-back-shadow-more").attr("x",t+(D?n-5:1)).attr("y",e+(D?0:r-6)).attr(a,i)}function A(){var t=n.select(".sc-background-wrap").insert("g").attr("class","sc-fore-shadow-wrap");t.append("rect").attr("class","sc-fore-shadow-prev"),t.append("rect").attr("class","sc-fore-shadow-more"),f=e.select(".sc-fore-shadow-wrap")}function I(){var t=D?"width":"height";f.select(".sc-fore-shadow-prev").attr("fill",P?"url(#sc-fore-gradient-prev-"+S+")":"transparent").attr(t,20),f.select(".sc-fore-shadow-more").attr("fill",P?"url(#sc-fore-gradient-more-"+S+")":"transparent").attr(t,20)}function C(t,e,n,r){f.select(".sc-fore-shadow-prev").attr("x",t+(D?1:0)).attr("y",e+(D?0:1)).attr(n,r),f.select(".sc-fore-shadow-more").attr("x",t+(D?E-17:0)).attr("y",e+(D?0:E-19)).attr(n,r)}return p(),m(),b(),w(),A(),O.render=function(){t(),g(),v(),k(),I()},O.resize=function(t,e){var n,r,a,i,o,l,s;h=t,z=e,O.render(),P&&(n=c.labelThickness()+c.tickPadding()/2,r=D?F.left:n,a=F.top,i=L+(D?0:F[c.orient()]-n),o=T+(D?F[c.orient()]-n:0),l=D?"height":"width",s=D?o:i,y(L,T),x(r,a,i,o),M(r,a,L,T,l,s),C(r,a,l,s))},O.pan=function(t){var e=Nt.event,n,r=0,a=0,i=0,o="";return!e||"click"!==e.type&&"zoom"!==e.type?0:(n=e.sourceEvent,"zoom"===e.type&&n&&("wheel"===n.type?(r=-n.deltaX,a=-n.deltaY,i=h+(Math.abs(r)>Math.abs(a)?r:a)):"mousemove"===n.type?(r=n.movementX,a=n.movementY,i=h+(Math.abs(r)>Math.abs(a)?r:a)):"touchmove"===n.type&&(r=e.transform.x,a=e.transform.y,i=Math.abs(r)>Math.abs(a)?r:a)),h=Math.min(Math.max(i,t),-1),o="translate("+(D?h+",0":"0,"+h)+")",(0<i||i<t)&&z(Math.abs(a)>Math.abs(r)?a:0),f.attr("transform",o),s.attr("transform",o),l.select(".sc-wrap.sc-axis").attr("transform",o),h)},O}return O.id=function(t){return arguments.length?(S=t,O):S},O.margin=function(t){return arguments.length?(F.top=void 0!==t.top?t.top:F.top,F.right=void 0!==t.right?t.right:F.right,F.bottom=void 0!==t.bottom?t.bottom:F.bottom,F.left=void 0!==t.left?t.left:F.left,O):F},O.width=function(t){return arguments.length?(L=t,O):L},O.height=function(t){return arguments.length?(T=t,O):T},O.vertical=function(t){return arguments.length?(D=t,O):D},O.minDimension=function(t){return arguments.length?(E=t,O):E},O.panHandler=function(t){return arguments.length?(N=zt.functor(t),O):N},O.enable=function(t){return arguments.length?(P=t,O):P},O}function e(){var S={top:2,right:0,bottom:2,left:0},e=0,n=0,r=function(t){return t.x},F=function(t){return t.y},a=c(),i=zt.getColor(["#000"]);function D(t){return t.each(function(t){var a=Nt.select(this),e=t?t.properties:{},n=t&&t.data?t.data.map(function(t,e){return{key:t.key||"Undefined",type:t.type||null,disabled:t.disabled||!1,series:t.seriesIndex||e,values:t._values||t.values}}):null,i=parseInt(a.style("width"),10),o=parseInt(a.style("height"),10),r=e.groups||Nt.range(1,Nt.max(n.map(function(t){return t.values.length}))+1).map(function(t){return{group:t,l:"Group "+t}}),l=1===Nt.max(n.map(function(t){return t.values.length}));function s(t){var e=t&&t.length&&t.filter(function(t){return t.values.length}).length,n=(i-S.left-S.right)/2+S.left,r=(o-S.top-S.bottom)/2+S.top;return zt.displayNoData(e,a,D.strings().noData,n,r)}if(s(n))return D;var c=a.selectAll("table").data([n]),u=c.enter().append("table");c.exit().remove();var d=a.selectAll("table").merge(u),f=u.attr("class","sucrose"),h=f.append("thead").attr("class","sc-thead").append("tr").attr("class","sc-groups"),p=d.select(".sc-groups").merge(h);h.append("th").attr("class","sc-th sc-series-state").text("Enabled"),h.append("th").attr("class","sc-th sc-series-keys").text(e.key||"Series Key");var g=p.selectAll(".sc-group").data(r),m=g.enter().append("th").attr("class","sc-th sc-group");g.exit().remove(),p.selectAll(".sc-group").merge(m).text(function(t){return l?"Series Total":t.l}),l||h.append("th").attr("class","sc-th sc-series-totals").text("Series Total");var v=f.append("tfoot").attr("class","sc-tfoot").append("tr").attr("class","sc-sums"),y=d.select(".sc-sums").merge(v);v.append("th").attr("class","sc-th sc-group-sums").text(""),v.append("th").attr("class","sc-th sc-group-sums").text(l?"Sum":"Group Sums");var b=y.selectAll(".sc-sum").data(function(t){return t.filter(function(t){return!t.disabled}).map(function(t){return t.values.map(function(t){return F(t)})}).reduce(function(t,n){return t.map(function(t,e){return t+n[e]})})}),x=b.enter().append("th").attr("class","sc-sum");b.exit().remove(),y.selectAll(".sc-sum").merge(x).text(function(t){return t}),l||(v.append("th").attr("class","sc-th sc-sum-total"),y.select(".sc-sum-total").text(function(t){return t.filter(function(t){return!t.disabled}).map(function(t){return t.values.map(function(t){return F(t)}).reduce(function(t,e){return t+e})}).reduce(function(t,e){return t+e})})),f.append("tbody").attr("class","sc-tbody");var w=d.select(".sc-tbody"),k=w.selectAll(".sc-series").data(function(t){return t});k.exit().remove();var M=k.enter().append("tr").attr("class","sc-series");M.append("td").attr("class","sc-td sc-state").attr("tabindex",-1).attr("data-editable",!1).append("input").attr("type","checkbox"),M.append("td").attr("class","sc-td sc-key");var A=w.selectAll(".sc-series").merge(M).style("color",function(t){return t.disabled?"#ddd":"#000"}).style("text-decoration",function(t){return t.disabled?"line-through":"inherit"});A.select(".sc-state input").property("checked",function(t){return!t.disabled}),A.select(".sc-key").text(function(t){return t.key});var I=A.selectAll(".sc-val").data(function(t,r){return t.values.map(function(t,e){var n=Array.isArray(t)?{0:t[0],1:t[1]}:{x:t.x,y:t.y};return n.series=r,n.index=e,n})}),C=I.enter().append("td").attr("class","sc-td sc-val");I.exit().remove(),w.selectAll(".sc-val").merge(C).text(function(t){return F(t)}),l||(M.append("td").attr("class","sc-td sc-total").attr("tabindex",-1).attr("data-editable",!1),A.select(".sc-total").text(function(t){return t.values.map(function(t){return F(t)}).reduce(function(t,e){return t+e})}))}),D}return D.margin=function(t){if(!arguments.length)return S;for(var e in t)t.hasOwnProperty(e)&&(S[e]=t[e]);return D},D.width=function(t){return arguments.length?(e=t,D):e},D.height=function(t){return arguments.length?(n=t,D):n},D.x=function(t){return arguments.length?(r=zt.functor(t),D):r},D.y=function(t){return arguments.length?(F=zt.functor(t),D):F},D.strings=function(t){return arguments.length?(a=c(t),D):a},D.color=function(t){return arguments.length?(i=zt.getColor(t),D):i},D}function f(){var A={top:20,right:0,bottom:0,left:0},h=0,p=0,I=Nt.scaleLinear(),C=Nt.scaleLinear(),S=Math.floor(1e4*Math.random()),F=function(t){return t.size},D=function(t){return t.name},L=function(t){return D(t)},T=!0,E=0,e=0,n=function(t,e){return!1},N=Nt.scaleOrdinal().range(Nt.schemeCategory20.map(function(t){return(t=Nt.rgb(t)).opacity=.6,t})),z=zt.colorLinearGradient,P=N,O=!1,_=function(t,e){return"sc-child"},H="ltr",B=Nt.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),R,V,G=[];function W(t){var e=t.data?t.data:t,n=L(e).toLowerCase(),r,a;if(n&&-1===G.indexOf(n)&&(G.push(n),e.children))for(a=e.children.length,r=0;r<a;r+=1)W(e.children[r]);return G}function Y(t){return t.each(function(t){var e=h-A.left-A.right,n=p-A.top-A.bottom,i=Nt.select(this),o;function g(t,e){return t.colorIndex||G.indexOf(L(t).toLowerCase())||e}V=V||Nt.hierarchy(t[0]).sum(function(t){return F(t)}).sort(function(t,e){return e.height-t.height||e.value-t.value}),G=G.length?G:W(V),Nt.treemap().size([e,n]).round(!1)(V),R=R||V,I.domain([R.x0,R.x1]).range([0,e]),C.domain([R.y0,R.y1]).range([0,n]);var r,a=i.selectAll("g.sc-wrap.sc-treemap").data([V]).enter().append("g").attr("class","sc-wrap sc-treemap"),m=i.select(".sc-wrap.sc-treemap").merge(a),l=a.append("defs"),s=m.select("defs");if(l.append("clipPath").attr("id","sc-edge-clip-"+S).append("rect"),s.select("#sc-edge-clip-"+S+" rect").attr("width",h).attr("height",p),m.attr("clip-path",T?"url(#sc-edge-clip-"+S+")":""),O)var v=zt.createTexture(l,S);Y.gradientFill=function(t,e,n){var r=S+"-"+e,a=N(t,g(t.parent.data,e),G.length);return z(t,r,n,a,s)};var c,u=a.selectAll(".sc-treepath").data([V]).enter().append("g").attr("class","sc-treepath"),y=m.selectAll(".sc-treepath").merge(u);u.append("rect").attr("class","sc-target").on("click",function(t){B.call("chartClick",this,t),x.call(this,t.parent)}),u.append("text").attr("x","rtl"===H?h-6:6).attr("y",6).attr("dy",".75em"),y.select(".sc-target").attr("width",h).attr("height",A.top);var d=f();function f(){var t,e=m.selectAll(".sc-grandparent.sc-trans").data([R]).enter().append("g").attr("class","sc-grandparent sc-trans"),n=m.selectAll(".sc-grandparent.sc-trans").merge(e);n.attr("transform",zt.translation(A.left,A.top)).lower();var r=n.selectAll("g.sc-parent").data(R.children),a=r.enter().append("g").classed("sc-parent",!0),i=n.selectAll(".sc-parent").merge(a);r.exit().remove(),i.classed("sc-active",function(t){return"active"===t.active}).style("stroke-opacity",1).style("fill-opacity",1);var o=i.selectAll("rect.sc-child").data(function(t){return t.children||[t]}),l=o.enter().append("rect").attr("class","sc-child"),s=i.selectAll(".sc-child").merge(l);o.exit().remove(),O&&a.append("rect").attr("class","sc-texture").attr("x",0).attr("y",0).style("mask","url("+v+")"),s.attr("class",function(t,e){return _(t,g(t.parent.data,e))}).attr("fill",function(t,e){return this.getAttribute("fill")||P(t,g(t.parent.data,e),G.length)}).call(k),O&&i.select("rect.sc-texture").style("fill",function(t,e){var n=this.getAttribute("fill")||P(t,g(t.parent.data,e),G.length),r;return zt.getTextContrast(n,e)}).call(k);var c=i.selectAll("text.sc-label").data(function(t){return[t]}),u=c.enter().append("text").attr("class","sc-label").attr("dy",".75em"),d=i.selectAll(".sc-label").merge(u);c.exit().remove(),d.text(function(t){return D(t.data)}).style("fill",function(t,e){var n=this.getAttribute("fill")||P(t,g(t.data,e),G.length),r;return zt.getTextContrast(n,e)}).call(w);var f=i.selectAll("rect.sc-target").data(function(t){return[t]}),h=f.enter().append("rect").attr("class","sc-target"),p=i.selectAll(".sc-target").merge(h);return f.exit().remove(),p.call(k),y.selectAll("text").datum(R).text(M),y.selectAll("rect").datum(R),p.filter(function(t){return t.children}).on("click",function(t){t.parent&&B.call("chartClick",this,t.parent),x.call(this,t)}),p.filter(function(t){return!t.children}).on("click",function(t,e){Nt.event.stopPropagation();var n={d:t,i:e};B.call("elementClick",this,n)}),p.on("mouseover",function(t,e){Nt.select(this).classed("hover",!0);var n=b(Nt.event,t,e);B.call("elementMouseover",this,n)}).on("mousemove",function(t,e){var n=Nt.event;B.call("elementMousemove",this,n)}).on("mouseout",function(t,e){Nt.select(this).classed("hover",!1),B.call("elementMouseout",this)}),s.on("mouseover",function(t,e){Nt.select(this).classed("hover",!0);var n=b(Nt.event,t,e);B.call("elementMouseover",this,n)}).on("mouseout",function(t,e){Nt.select(this).classed("hover",!1),B.call("elementMouseout",this)}),n}function b(t,e,n){return{label:D(e),value:F(e),point:e,pointIndex:n,e:Nt.event,id:S}}function x(t){var e,n,r,a;B.call("elementMouseout",this),!o&&t&&(R=t,o=!0,d.classed("sc-trans",!1),e=Nt.select(this).classed("sc-target")?"out":"in",n=Nt.transition("treemap-out").duration(E).ease(Nt.easeCubicIn),r=Nt.transition("treemap-in").duration(E).ease(Nt.easeCubicIn),a=f(),I.domain([t.x0,t.x1]),C.domain([t.y0,t.y1]),i.style("shape-rendering",null),a.selectAll("text").style("fill-opacity",0),a.selectAll("text").transition(r).style("fill-opacity",1).call(w),a.selectAll("rect").transition(r).style("fill-opacity",1).call(k),d.selectAll("text").transition(n).style("fill-opacity",0).call(w).remove(),d.selectAll("rect").transition(n).style("fill-opacity",0).call(k).on("end",function(t,e){o=!1,i.style("shape-rendering","crispEdges"),d.selectAll("*").interrupt("treemap-out"),d.remove(),d=a}))}function w(t){t.attr("x",function(t){var e="rtl"===H?-1:1;return I(t.x0)+6*e}).attr("y",function(t){return C(t.y0)+6})}function k(t){t.attr("x",function(t){return I(t.x0)}).attr("y",function(t){return C(t.y0)}).attr("width",function(t){return I(t.x1)-I(t.x0)}).attr("height",function(t){return C(t.y1)-C(t.y0)})}function M(t){return t.parent?M(t.parent)+" / "+D(t.data):D(t.data)}}),Y}return Y.dispatch=B,Y.color=function(t){return arguments.length?(N=t,Y):N},Y.fill=function(t){return arguments.length?(P=t,Y):P},Y.classes=function(t){return arguments.length?(_=t,Y):_},Y.gradient=function(t){return arguments.length?(z=t,Y):z},Y.margin=function(t){return arguments.length?(A.top=void 0!==t.top?t.top:A.top,A.right=void 0!==t.right?t.right:A.right,A.bottom=void 0!==t.bottom?t.bottom:A.bottom,A.left=void 0!==t.left?t.left:A.left,Y):A},Y.width=function(t){return arguments.length?(h=t,Y):h},Y.height=function(t){return arguments.length?(p=t,Y):p},Y.xScale=function(t){return arguments.length?(I=t,Y):I},Y.yScale=function(t){return arguments.length?(C=t,Y):C},Y.leafClick=function(t){return arguments.length?(n=t,Y):n},Y.getValue=function(t){return arguments.length?(F=t,Y):F},Y.getKey=function(t){return arguments.length?(D=t,Y):D},Y.groupBy=function(t){return arguments.length?(L=t,Y):L},Y.groups=function(t){return arguments.length?(G=t,Y):G},Y.duration=function(t){return arguments.length?(E=t,Y):E},Y.delay=function(t){return arguments.length?(e=t,Y):e},Y.id=function(t){return arguments.length?(S=t,Y):S},Y.direction=function(t){return arguments.length?(H=t,Y):H},Y.textureFill=function(t){return arguments.length?(O=t,Y):O},Y}var n={area:a,axis:v,funnel:r,gauge:o,headers:s,line:y,menu:z,multibar:b,pie:u,scatter:l,scroller:d,table:e,treemap:f};function h(){var V={top:10,right:10,bottom:10,left:10},G=null,W=null,e="ltr",n=0,Y=0,q=!0,X={},j=c(),K=Nt.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),r=3,Z=function(t,e,n,r,a){var i=n||t;return r?(a=a&&0===a.indexOf("%")?a:"%x",zt.dateFormat(i,a,it.locality())):i},U=function(t,e,n,r,a){return a=isNaN(a)?2:a,zt.numberFormatSI(t,a,r,it.locality())},$=function(t,e){var n=t.seriesKey,r="currency"===e.yDataType,a;return"<p>"+n+": "+U(t[1],t.pointIndex,null,r,2)+"</p>"},J=a(),Q=s(),tt=v(),et=v(),nt=y(),rt=null,at=null;function it(t){return t.each(function(t){var m=this,v=Nt.select(this),e="area",y=t&&t.properties||{},r=t&&t.data||null,b=parseInt(v.style("width"),10),x=parseInt(v.style("height"),10),w=G,k=W,M="datetime"===y.xDataType||!1,i="currency"===y.yDataType||!1,n=y.groups,a=Array.isArray(n)&&0<n.length,o=[],l=0,s=!1,A=[],c=0,u=0,I=0,d=[{key:"Stacked",disabled:"zero"!==J.offset()},{key:"Stream",disabled:"wiggle"!==J.offset()},{key:"Expanded",disabled:"expand"!==J.offset()}],C,S;function F(t,e){var n=t&&t.length&&t.filter(function(t){return!t.disabled&&Array.isArray(t.values)&&t.values.length}).length,r=(b-V.left-V.right)/2+V.left,a=(x-V.top-V.bottom)/2+V.top;return zt.displayNoData(n,v,e||j.noData,r,a)}if(it.update=function(){v.transition().duration(Y).call(it)},it.container=this,F(r))return it;if(r.forEach(function(t,e){t.seriesIndex=e,t.key=t.key||j.noLabel,t.total=Nt.sum(t.values,function(t,e){return J.y()(t,e)}),t.disabled=t.disabled||0===t.total}),c=(A=r.filter(function(t){return!t.disabled}).map(function(t,e){return t.seri=e,t})).length,F(A))return it;function f(t){o=t.map(function(t){return t.label}),l=o.length,s=0<l}a?(n.forEach(function(n,r){var t=void 0===n.label||""===n.label?j.noLabel:M?zt.isNumeric(n.label)||-1!==n.label.indexOf("GMT")?new Date(n.label):new Date(n.label+" GMT"):n.label;n.group=r,n.label=t,n.total=0,A.forEach(function(t,e){t.values.filter(function(t,e){return t.group===r}).forEach(function(t,e){n.total+=t.y})})}),f(n),u=Nt.sum(n,function(t){return t.total})):(o=Nt.merge(A.map(function(t){return t.values})).reduce(function(t,e){return-1===t.indexOf(e.x)&&t.push(e.x),t},[]).map(function(t,e){return M?new Date(t):t}),l=Math.min(Math.ceil(innerWidth/100),o.length),u=Nt.sum(A,function(t){return t.total}));var D=75,h=null,p=null,g=null,L={axis:null,maxmin:null};function T(t,e){var n=e.map(function(t){return Nt.select(t).datum()}),r=Nt.max(Nt.extent(n),function(t){return zt.siDecimal(Math.abs(t))}),a=Nt.max(n,function(t){return zt.countSigFigsAfter(Nt.formatPrefix(".2s",r)(t))});return"maxmin"===t&&L.axis&&(a=Math.max(L.axis.precision,a)),L[t]={decimal:r,precision:a},L[t]}M&&(h=zt.getDateFormatUTC(o)),p=function(t,e,n,r){var a=s?o[e]:t,i=Z(t,e,a,M,h);return"no-ellipsis"===r?i:zt.stringEllipsify(i,v,D)},g=function(t,e,n,r){var a=L[r]||T(r,n);return U(t,e,null,i,a.precision,a.decimal)},X.disabled=A.map(function(t){return!!t.disabled}),X.style=J.style(),Q.chart(it).title(y.title).controlsData(d).legendData(r),J.xDomain(null).yDomain(null).xScale(M?Nt.scaleTime():Nt.scaleLinear()),C=J.xScale(),S=J.yScale(),tt.orient("bottom").ticks(null).tickValues(null).scale(C).tickPadding(6).valueFormat(p).highlightZero(!1).showMaxMin(M),et.orient("left").ticks(null).scale(S).tickPadding(6).valueFormat(g).highlightZero(!0).showMaxMin(!0),nt.id(J.id()).useVoronoi(!1).clipEdge(!1).xScale(C).yScale(S);var E,N=v.selectAll("g.sc-chart-wrap").data([A]).enter().append("g").attr("class","sc-chart-wrap sc-chart-"+e),z=v.select(".sc-chart-wrap").merge(N);N.append("defs");var P=z.select("defs");N.append("g").attr("class","sc-background-wrap");var O=z.select(".sc-background-wrap");N.append("g").attr("class","sc-title-wrap"),N.append("g").attr("class","sc-axis-wrap sc-axis-x");var _=z.select(".sc-axis-wrap.sc-axis-x");N.append("g").attr("class","sc-axis-wrap sc-axis-y");var H=z.select(".sc-axis-wrap.sc-axis-y");N.append("g").attr("class","sc-area-wrap");var B=z.select(".sc-area-wrap");N.append("g").attr("class","sc-controls-wrap"),N.append("g").attr("class","sc-legend-wrap"),N.append("g").attr("class","sc-guide-wrap");var R=z.select(".sc-guide-wrap");z.attr("transform",zt.translation(V.left,V.top)),N.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-V.left).attr("y",-V.top).attr("fill","#FFF"),it.render=function(){var t,e,n,r,a,i,o=0,l=0;if(b=parseInt(v.style("width"),10),x=parseInt(v.style("height"),10),e=W||x||400,w=(t=G||b||960)-V.left-V.right,k=e-V.top-V.bottom,r=w-(n={top:0,right:0,bottom:0,left:0}).left-n.right,a=k-n.top-n.bottom,O.select(".sc-background").attr("width",t).attr("height",e),D=Math.max(.2*w,75),Q.width(w).height(k),v.call(Q),i=Q.getHeight(),n.top+=i,(a=k-n.top-n.bottom)<100)return F(null,j.displayError),it;function s(t){return"width"===t?r:"height"===t?a:0}J.width(s("width")).height(s("height")),B.datum(A).call(J);var c={top:0,right:0,bottom:0,left:0},u={top:0,right:0,bottom:0,left:0};function d(){u=tt.margin(),c=et.margin(),n.left=Math.max(u.left,c.left),n.right=Math.max(u.right,c.right),n.top=Math.max(u.top,c.top),n.bottom=Math.max(u.bottom,c.bottom),f()}function f(){r=w-n.left-n.right,a=k-i-n.top-n.bottom,J.resetDimensions(s("width"),s("height"))}function h(){et.ticks("wiggle"===J.offset()?0:null).tickSize(I-r,0).margin(n),H.call(et),d()}function p(){tt.tickSize(I-a,0).margin(n),_.call(tt),d()}h(),p(),h(),p(),h(),B.transition().duration(Y).call(J);var g=Math.pow(3,2)*Math.PI;nt.width(r).height(a).size(g).sizeRange([g,g]).xDomain(C.domain()).yDomain(S.domain()),R.datum([{key:"guide",values:[{x:0,y:0},{x:0,y:S.domain()[1]}]}]).call(nt),it.showTooltip=function(t,e,n){var r=$(t,n);return xt.show(t.e,r,null,null,e)},it.moveGuide=function(t,e,r){var a=r.data[0][0],n=[{x:a,y:0}].concat(r.data.map(function(t,e){return{x:a,y:t[1]}})).concat([{x:a,y:S.domain()[1]}]),i={clientX:r.origin.left+C(a)},o=[a,0];o.e=r.e,o.seriesIndex=0,o.seriesKey="x",R.datum([{key:"guide",values:n,seriesIndex:0}]).call(nt),at||(at={},r.data.forEach(function(t,e){t.e=r.e,at[e]=it.showTooltip(t,m.parentNode,y)}),at.x=it.showTooltip(o,m.parentNode,y)),r.data.forEach(function(t,e){var n=$(t,y);i.clientY=r.origin.top+S(t[1]),Nt.select(at[e]).select(".tooltip-inner").html(n),xt.position(m.parentNode,at[e],i,"e")}),o.forEach(function(t,e){var n=Z(t,e,a,M);i.clientY=r.origin.top,Nt.select(at.x).select(".tooltip-inner").html(n),xt.position(m.parentNode,at.x,i,"s")})},n.top+=i,o=n.left,l=n.top+("bottom"===tt.orient()?a:0),_.attr("transform",zt.translation(o,l)),o=n.left+("left"===et.orient()?0:r),l=n.top,H.attr("transform",zt.translation(o,l)),B.attr("transform",zt.translation(n.left,n.top)),R.attr("transform",zt.translation(n.left,n.top))},it.render(),Q.legend.dispatch.on("legendClick",function(t,e){t.disabled=!t.disabled,r.filter(function(t){return!t.disabled}).length||r.forEach(function(t){t.disabled=!1}),X.disabled=r.map(function(t){return!!t.disabled}),t.active="inactive",it.update(),K.call("stateChange",this,X)}),Q.controls.dispatch.on("legendClick",function(t,e){if(t.disabled){switch(d.forEach(function(t){t.disabled=!0}),t.disabled=!1,t.key){case"Stacked":J.style("stack");break;case"Stream":J.style("stream");break;case"Expanded":J.style("expand")}X.style=J.style(),it.render(),K.call("stateChange",this,X)}}),K.on("tooltipShow",function(t){q&&(rt=!0,R.classed("hover",!0))}),K.on("tooltipMove",function(t){rt&&it.moveGuide(m.parentNode,v,t)}),K.on("tooltipHide",function(){q&&(rt=!1,xt.cleanup(),at=null,R.classed("hover",!1))}),J.dispatch.on("elementClick.toggle",function(n){r=1===r.filter(function(t){return!t.disabled}).length?r.map(function(t){return t.disabled=!1,t}):r.map(function(t,e){return t.disabled=e!==n.seriesIndex,t}),X.disabled=r.map(function(t){return!!t.disabled}),it.update(),K.call("stateChange",this,X),K.call("tooltipHide",this)}),K.on("changeState",function(n){void 0!==n.disabled&&(r.forEach(function(t,e){t.disabled=n.disabled[e]}),X.disabled=n.disabled),void 0!==n.style&&(J.style(n.style),X.style=n.style),it.update()}),K.on("chartClick",function(){Q.controls.enabled()&&Q.controls.dispatch.call("closeMenu",this),Q.legend.enabled()&&Q.legend.dispatch.call("closeMenu",this)}),v.on("click",function(){Nt.event.stopPropagation(),K.call("chartClick",this)})}),it}return J.clipEdge(!0),Q.showTitle(!0).showControls(!1).showLegend(!0),nt.duration(0),J.dispatch.on("elementMouseover.tooltip",function(t){K.call("tooltipShow",this,t)}),J.dispatch.on("elementMousemove.tooltip",function(t){K.call("tooltipMove",this,t)}),J.dispatch.on("elementMouseout.tooltip",function(t){K.call("tooltipHide",this,t)}),it.dispatch=K,it.area=J,it.legend=Q.legend,it.controls=Q.controls,it.xAxis=tt,it.xAxisLabel=tt.axisLabel,it.yAxis=et,it.yAxisLabel=et.axisLabel,it.options=zt.optionsFunc.bind(it),zt.rebind(it,J,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),zt.rebind(it,J,"offset","order","style"),zt.rebind(it,Q,"showTitle","showControls","showLegend"),zt.rebind(it,tt,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),it.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t){return zt.defaultColor()(t,t.seriesIndex)},a=function(t){return"sc-series sc-series-"+t.seriesIndex};switch(e){case"graduated":n=function(t){return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(t.seriesIndex/r.l)};break;case"class":n=function(){return"inherit"},a=function(t){var e=t.seriesIndex,n=e*(r.step||1)%14;return"sc-series sc-series-"+e+" sc-fill"+(n=(9<n?"":"0")+n)+" sc-stroke"+n};break;case"data":n=function(t){return zt.defaultColor()(t,t.seriesIndex)},a=function(t){var e;return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var i=r.gradient?function(t,e){var n={orientation:r.orientation||"horizontal",position:r.position||"base"};return J.gradientFill(t,t.seriesIndex,n)}:n;return J.color(n),J.fill(i),J.classes(a),Q.legend.color(n),Q.legend.classes(a),it},it.margin=function(t){if(!arguments.length)return V;for(var e in t)t.hasOwnProperty(e)&&(V[e]=t[e]);return it},it.width=function(t){return arguments.length?(G=t,it):G},it.height=function(t){return arguments.length?(W=t,it):W},it.tooltips=function(t){return arguments.length?(q=t,it):q},it.tooltipContent=function(t){return arguments.length?($=t,it):$},it.state=function(t){return arguments.length?(X=t,K.call("stateChange",this,X),it):X},it.strings=function(t){return arguments.length?(j=c(t),Q.strings(j),it):j},it.direction=function(t){return arguments.length?(e=t,J.direction(t),tt.direction(t),et.direction(t),Q.direction(t),it):e},it.duration=function(t){return arguments.length?(Y=t,J.duration(t),it):Y},it.delay=function(t){return arguments.length?(n=t,J.delay(t),it):n},it.xValueFormat=function(t){return arguments.length?(Z=t,it):Z},it.yValueFormat=function(t){return arguments.length?(U=t,it):U},it.pointRadius=function(t){return arguments.length?(r=t,it):r},it}function p(){var E={top:10,right:10,bottom:10,left:10},N=null,z=null,e="ltr",n=0,P=0,O=!0,_={},H=c(),B=Nt.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),R=function(t){return t.x},V=function(t){return t.y},G=[0],W=function(t){return t.y},Y=function(t){return t.y},q=function(t,e,n,r,a){var i=n||t;return r?(a=a&&0===a.indexOf("%")?a:"MM",zt.dateFormat(i,a,tt.locality())):i},X=function(t,e,n,r,a){return a=isNaN(a)?2:a,zt.numberFormatSI(n,a,r,tt.locality())},i=function(t,e){var n=t.series.key,r=t.point.x,a;return"<h3>"+n+"</h3><p>"+t.point.y+" on "+r+"</p>"},j=function(t,e,n,r){},K=l(),Z=s(),U=v(),$=v(),J=null,Q=function(t,e,n){var r=i(t,n),a=t.value<0?"n":"s";return xt.show(t.e,r,a,null,e)};function tt(t){return t.each(function(t){var e=this,f=Nt.select(this),n="bubble",r=t&&t.properties||{},a=t&&t.data||[],h=parseInt(f.style("width"),10),p=parseInt(f.style("height"),10),g=N,m=z,i="datetime"===r.xDataType||!1,o="currency"===r.yDataType||!1,v,l,y,b,s,x,c=function(t,e,n,r){return q(t,e,t,i,"%B")},u=function(t,e,n,r){var a=s&&Array.isArray(s)&&s[e].key||t,i=Math.max(.2*g,75);return isNaN(a)?zt.stringEllipsify(a,f,i):X(t,e,a,o)},d=[];function w(t,e){var n=t&&t.length,r=(h-E.left-E.right)/2+E.left,a=(p-E.top-E.bottom)/2+E.top;return zt.displayNoData(n,f,e||H.noData,r,a)}if(tt.update=function(){f.transition().duration(P).call(tt)},tt.container=this,w(a))return tt;function k(t){var e=Nt.extent(Nt.merge(t.map(function(t){return t.values.map(function(t,e){return Nt.timeParse("%Y-%m-%d")(R(t))})}))),n;return[Nt.timeMonth.floor(e[0]),Nt.timeDay.offset(Nt.timeMonth.ceil(e[1]),-1)]}function M(t){function e(t){return 32-new Date(t.getFullYear(),t.getMonth(),32).getDate()}var n,r;return Nt.timeMonth.range(t[0],t[1]).map(function(t){return Nt.timeDay.offset(Nt.timeMonth.floor(t),e(t)/2-1)})}function A(t){var e=Nt.nest().key(W).entries(t),n=1e3/e.length,r=x,a=[0,1],i=[0,1],o=Nt.scaleLinear().domain(a).range(i),l=[],s=0;return e.map(function(e,t){return e.total=0,e.values=e.values.sort(function(t,e){return e.y<t.y?-1:e.y>t.y?1:0}).map(function(t){return e.total+=t.y,t}),e.group=t,e}).sort(function(t,e){return t.total<e.total?-1:t.total>e.total?1:0}).map(function(e,t){return s+=e.total,a=Nt.extent(e.values.map(function(t){return t.y})),i=[n*t+r,n*(t+1)-r],o.domain(a).range(i),e.values=e.values.map(function(t){return t.group=e.group,t.opportunity=t.y,t.y=o(t.opportunity),t}),l.push({key:e.key,y:Nt.min(e.values.map(function(t){return t.y}))}),e}),l}_.disabled=a.map(function(t){return!!t.disabled}),l=Nt.nest().key(Y).entries(a),v=l.sort(function(t,e){return parseInt(t.key,10)<parseInt(e.key,10)?-1:parseInt(t.key,10)>parseInt(e.key,10)?1:0}).map(function(t,e){return t.seriesIndex=e,t.classes=t.values[0].classes,t.color=t.values[0].color,t}),x=Math.sqrt(K.sizeRange()[1]/Math.PI),Z.chart(tt).title(r.title).controlsData(d).legendData(v),Z.legend.key(function(t){return t.key+"%"}),y=k(v),s=A(a),b=Nt.extent(Nt.merge(v.map(function(t){return t.values.map(function(t,e){return V(t,e)})})).concat(G)),U.orient("bottom").scale(K.xScale()).valueFormat(c).ticks(Nt.timeMonths,1).tickValues(M(y)).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),$.orient("left").scale(K.yScale()).valueFormat(u).ticks(s.length).tickValues(s.map(function(t,e){return s[e].y})).tickPadding(7).highlightZero(!1).showMaxMin(!1);var I,C=f.selectAll("g.sc-chart-wrap").data([v]).enter().append("g").attr("class","sc-chart-wrap sc-chart-"+n),S=f.select(".sc-chart-wrap").merge(C);C.append("defs"),C.append("g").attr("class","sc-background-wrap");var F=S.select(".sc-background-wrap");C.append("g").attr("class","sc-title-wrap"),C.append("g").attr("class","sc-axis-wrap sc-axis-x");var D=S.select(".sc-axis-wrap.sc-axis-x");C.append("g").attr("class","sc-axis-wrap sc-axis-y");var L=S.select(".sc-axis-wrap.sc-axis-y");C.append("g").attr("class","sc-bubble-wrap");var T=S.select(".sc-bubble-wrap");C.append("g").attr("class","sc-controls-wrap"),C.append("g").attr("class","sc-legend-wrap"),S.attr("transform",zt.translation(E.left,E.top)),C.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-E.left).attr("y",-E.top).attr("fill","#FFF"),tt.render=function(){var t,e,n,r,a,i,o=0,l=0;if(h=parseInt(f.style("width"),10),p=parseInt(f.style("height"),10),e=z||p||400,g=(t=N||h||960)-E.left-E.right,m=e-E.top-E.bottom,r=g-(n={top:0,right:0,bottom:0,left:0}).left-n.right,a=m-n.top-n.bottom,F.select(".sc-background").attr("width",t).attr("height",e),Z.width(g).height(m),f.call(Z),i=Z.getHeight(),n.top+=i,n.top+=x,(a=m-n.top-n.bottom)<100)return w(null,H.displayError),tt;K.width(r).height(a).id(tt.id()).xDomain(y).yDomain(b),T.datum(v.filter(function(t){return!t.disabled})).transition().duration(P).call(K);var s={top:0,right:0,bottom:0,left:0},c={top:0,right:0,bottom:0,left:0};function u(){n.left=Math.max(c.left,s.left),n.right=Math.max(c.right,s.right),n.top=Math.max(c.top,s.top)+i,n.bottom=Math.max(c.bottom,s.bottom)}function d(){r=g-n.left-n.right,a=m-n.top-n.bottom,K.resetDimensions(r,a)}$.margin(n),L.call($),s=$.margin(),u(),d(),U.tickSize(0).margin(n),D.call(U),c=U.margin(),u(),d(),$.tickSize(-r,0).margin(n),L.call($),L.select("path.domain").attr("d","M0,0V0.5H0V"+a),T.transition().duration(tt.delay()).call(K),o=n.left,l=n.top+("bottom"===U.orient()?a:0),D.attr("transform",zt.translation(o,l)),o=n.left+("left"===$.orient()?0:r),l=n.top,L.attr("transform",zt.translation(o,l)),T.attr("transform",zt.translation(n.left,n.top))},tt.render(),Z.legend.dispatch.on("legendClick",function(t,e){t.disabled=!t.disabled,v.filter(function(t){return!t.disabled}).length||v.forEach(function(t){t.disabled=!1,f.selectAll(".sc-series").classed("disabled",!1)}),_.disabled=v.map(function(t){return!!t.disabled}),B.call("stateChange",this,_),tt.update()}),B.on("tooltipShow",function(t){O&&(J=Q(t,e.parentNode,r))}),B.on("tooltipMove",function(t){J&&xt.position(e.parentNode,J,t,"s")}),B.on("tooltipHide",function(){O&&xt.cleanup()}),B.on("changeState",function(n){void 0!==n.disabled&&(a.forEach(function(t,e){t.disabled=n.disabled[e]}),_.disabled=n.disabled),tt.update()}),B.on("chartClick",function(){B.call("tooltipHide",this),Z.controls.enabled()&&Z.controls.dispatch.call("closeMenu",this),Z.legend.enabled()&&Z.legend.dispatch.call("closeMenu",this)}),K.dispatch.on("elementClick",function(t){B.call("chartClick",this),j(a,t,tt)}),f.on("click",function(){Nt.event.stopPropagation(),B.call("chartClick",this)})}),tt}return K.padData(!0).padDataOuter(-1).size(function(t){return t.y}).sizeRange([256,1024]).singlePoint(!0),Z.showTitle(!0).showControls(!1).showLegend(!0).alignLegend("center"),K.dispatch.on("elementMouseover.tooltip",function(t){B.call("tooltipShow",this,t)}),K.dispatch.on("elementMousemove.tooltip",function(t){B.call("tooltipMove",this,t)}),K.dispatch.on("elementMouseout.tooltip",function(){B.call("tooltipHide",this)}),tt.dispatch=B,tt.scatter=K,tt.legend=Z.legend,tt.controls=Z.controls,tt.xAxis=U,tt.xAxisLabel=U.axisLabel,tt.yAxis=$,tt.yAxisLabel=$.axisLabel,tt.options=zt.optionsFunc.bind(tt),zt.rebind(tt,K,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),zt.rebind(tt,K,"size","zScale","sizeDomain","forceSize","interactive","clipVoronoi","clipRadius"),zt.rebind(tt,Z,"showTitle","showControls","showLegend"),zt.rebind(tt,U,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),tt.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t){return zt.defaultColor()(t,t.seriesIndex)},a=function(t){return"sc-series sc-series-"+t.seriesIndex};switch(e){case"graduated":n=function(t){return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(t.seriesIndex/r.l)};break;case"class":n=function(){return"inherit"},a=function(t){var e=t.seriesIndex,n=e*(r.step||1)%14;return"sc-series sc-series-"+e+" sc-fill"+(n=(9<n?"":"0")+n)+" sc-stroke"+n};break;case"data":n=function(t){return t.classes?"inherit":t.color||zt.defaultColor()(t,t.seriesIndex)},a=function(t){var e;return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var i=r.gradient?function(t,e){return K.gradientFill(t,t.seriesIndex)}:n;return K.color(n),K.fill(i),K.classes(a),Z.legend.color(n),Z.legend.classes(a),tt},tt.margin=function(t){if(!arguments.length)return E;for(var e in t)t.hasOwnProperty(e)&&(E[e]=t[e]);return tt},tt.width=function(t){return arguments.length?(N=t,tt):N},tt.height=function(t){return arguments.length?(z=t,tt):z},tt.tooltips=function(t){return arguments.length?(O=t,tt):O},tt.tooltipContent=function(t){return arguments.length?(i=t,tt):i},tt.state=function(t){return arguments.length?(_=t,B.call("stateChange",this,_),tt):_},tt.strings=function(t){return arguments.length?(H=c(t),Z.strings(H),tt):H},tt.direction=function(t){return arguments.length?(e=t,K.direction(t),U.direction(t),$.direction(t),Z.direction(t),tt):e},tt.duration=function(t){return arguments.length?(P=t,K.duration(t),tt):P},tt.delay=function(t){return arguments.length?(n=t,K.delay(t),tt):n},tt.xValueFormat=function(t){return arguments.length?(q=t,tt):q},tt.yValueFormat=function(t){return arguments.length?(X=t,tt):X},tt.seriesClick=function(t){return arguments.length?(j=t,tt):j},tt.groupBy=function(t){return arguments.length?(W=t,tt):W},tt.filterBy=function(t){return arguments.length?(Y=t,tt):Y},tt}function g(){var y={top:10,right:10,bottom:10,left:10},b=null,x=null,e="ltr",n=0,w=0,k=!0,M={},A=!0,I=c(),C=Nt.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),S=r(),F=s(),D=[],L=null,a=function(t,e){var n=S.getValue()(t),r=e.total?(100*n/e.total).toFixed(1):100,a="currency"===e.yDataType,i={key:S.fmtKey()(t),label:a?I.tooltip.amount:I.tooltip.count,value:zt.numberFormat(n,2,a,N.locality()),percent:zt.numberFormat(r,2,!1,N.locality())};return xt.single(i,I)},T=function(t,e,n){var r=a(t,n);return xt.show(t.e,r,null,null,e)},E=function(t,e,n){};function N(t){return t.each(function(t){var e=this,s=Nt.select(this),n="funnel",r=t&&t.properties||{},a=t&&t.data||null,c=parseInt(s.style("width"),10),u=parseInt(s.style("height"),10),i="datetime"===r.xDataType||!1,o="currency"===r.yDataType||!1;function d(t,e){var n=t&&t.length,r=(c-y.left-y.right)/2+y.left,a=(u-y.top-y.bottom)/2+y.top;return zt.displayNoData(n,s,e||I.noData,r,a)}if(N.update=function(){s.transition().duration(w).call(N)},N.container=this,d(a))return N;N.setActiveState=function(t,e){t.active=e},N.clearActive=function(e){a.forEach(function(t){N.setActiveState(t,e||"")}),delete M.active},N.seriesActivate=function(t){var e=t.series||a[t.seriesIndex],n;e&&(A?(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"",N.clearActive("active"===n?"inactive":""),N.setActiveState(e,n),M.active=a.map(function(t){return"active"===t.active})):N.dataSeriesActivate({series:e}))},N.dataSeriesActivate=function(t){var e=t.series;e.active=e.active&&"inactive"!==e.active?"inactive":"active","active"===e.active&&a.filter(function(t){return"active"!==t.active}).forEach(function(t){return t.active="inactive",t}),a.filter(function(t){return"active"===t.active}).length||N.clearActive()},a.forEach(function(n,t){n.seriesIndex=t,n.values||(n.value?isNaN(n.value)||(n.values=[{x:0,y:parseInt(n.value,10)}]):n.values=[]),n.values.forEach(function(t,e){t.index=e,t.series=n,void 0===t.value&&(t.value=t.y)}),n.key=n.key||I.noLabel,n.value=n.value||Nt.sum(n.values,function(t){return t.value}),n.count=n.count||n.values.length,n.disabled=n.disabled||0===n.value});var f=a.filter(function(t){return!t.disabled});if(f.length||(f=[{values:[]}]),r.count=Nt.sum(f,function(t){return t.count}),r.total=Nt.sum(f,function(t){return t.value}),M.disabled=a.map(function(t){return!!t.disabled}),!r.total)return d(),N;F.chart(N).title(r.title).controlsData(D).legendData(a);var l,h=s.selectAll("g.sc-chart-wrap").data([f]).enter().append("g").attr("class","sc-chart-wrap sc-chart-"+n),p=s.select(".sc-chart-wrap").merge(h);h.append("defs");var g=p.select("defs");h.append("g").attr("class","sc-background-wrap");var m=p.select(".sc-background-wrap");h.append("g").attr("class","sc-title-wrap"),h.append("g").attr("class","sc-funnel-wrap");var v=p.select(".sc-funnel-wrap");h.append("g").attr("class","sc-controls-wrap"),h.append("g").attr("class","sc-legend-wrap"),p.attr("transform",zt.translation(y.left,y.top)),h.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-y.left).attr("y",-y.top).attr("fill","#FFF"),N.render=function(){var t,e,n,r,a,i,o,l;if(c=parseInt(s.style("width"),10),u=parseInt(s.style("height"),10),e=x||u||400,n=(t=b||c||960)-y.left-y.right,r=e-y.top-y.bottom,i=n-(a={top:0,right:0,bottom:0,left:0}).left-a.right,o=r-a.top-a.bottom,m.select(".sc-background").attr("width",t).attr("height",e),F.width(n).height(r),s.call(F),l=F.getHeight(),a.top+=l,(o=r-a.top-a.bottom)<100)return d(null,I.displayError),N;S.width(i).height(o),v.datum(f).attr("transform",zt.translation(a.left,a.top)).transition().duration(w).call(S)},N.render(),F.legend.dispatch.on("legendClick",function(t,e){t.disabled=!t.disabled,t.active=!1,a.filter(function(t){return!t.disabled}).length||a.forEach(function(t){t.disabled=!1}),a.filter(function(t){return"active"===t.active}).length||a.forEach(function(t){t.active=""}),M.disabled=a.map(function(t){return!!t.disabled}),C.call("stateChange",this,M),N.update()}),C.on("tooltipShow",function(t){k&&(L=T(t,e.parentNode,r))}),C.on("tooltipMove",function(t){L&&xt.position(e.parentNode,L,t)}),C.on("tooltipHide",function(){k&&xt.cleanup()}),C.on("changeState",function(n){void 0!==n.disabled&&(f.forEach(function(t,e){t.disabled=n.disabled[e]}),M.disabled=n.disabled),N.update()}),C.on("chartClick",function(){F.controls.enabled()&&F.controls.dispatch.call("closeMenu",this),F.legend.enabled()&&F.legend.dispatch.call("closeMenu",this)}),S.dispatch.on("elementClick",function(t){C.call("chartClick",this),E(a,t,N)})}),N}return F.showTitle(!0).showControls(!1).showLegend(!0).alignLegend("center"),S.dispatch.on("elementMouseover.tooltip",function(t){C.call("tooltipShow",this,t)}),S.dispatch.on("elementMousemove.tooltip",function(t){C.call("tooltipMove",this,t)}),S.dispatch.on("elementMouseout.tooltip",function(){C.call("tooltipHide",this)}),N.dispatch=C,N.funnel=S,N.legend=F.legend,N.controls=F.controls,N.options=zt.optionsFunc.bind(N),zt.rebind(N,S,"id","color","fill","classes","gradient","locality","textureFill"),zt.rebind(N,S,"getKey","getValue","getCount","fmtKey","fmtValue","fmtCount"),zt.rebind(N,S,"yScale","yDomain","forceY","wrapLabels","minLabelWidth"),zt.rebind(N,F,"showTitle","showControls","showLegend"),N.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},a=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(e){case"graduated":n=function(t,e){return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(t.seriesIndex/r.l)};break;case"class":n=function(){return"inherit"},a=function(t,e){var n=t.seriesIndex*(r.step||1)%14;return n=(9<n?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n+" sc-stroke"+n};break;case"data":n=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},a=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var i=r.gradient?function(t,e){var n={orientation:r.orientation||"vertical",position:r.position||"middle"};return S.gradientFill(t,t.seriesIndex,n)}:n;return S.color(n),S.fill(i),S.classes(a),F.legend.color(n),F.legend.classes(a),N},N.margin=function(t){if(!arguments.length)return y;for(var e in t)t.hasOwnProperty(e)&&(y[e]=t[e]);return N},N.width=function(t){return arguments.length?(b=t,N):b},N.height=function(t){return arguments.length?(x=t,N):x},N.tooltips=function(t){return arguments.length?(k=t,N):k},N.tooltipContent=function(t){return arguments.length?(a=t,N):a},N.state=function(t){return arguments.length?(M=t,C.call("stateChange",this,M),N):M},N.strings=function(t){return arguments.length?(I=c(t),F.strings(I),N):I},N.direction=function(t){return arguments.length?(e=t,S.direction(t),F.direction(t),N):e},N.duration=function(t){return arguments.length?(w=t,S.duration(t),N):w},N.delay=function(t){return arguments.length?(n=t,S.delay(t),N):n},N.seriesClick=function(t){return arguments.length?(E=t,N):E},N}function m(){var y={top:10,right:10,bottom:10,left:10},b=null,x=null,e="ltr",n=0,w=0,k=!0,M={},A=c(),I=Nt.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),C=o(),S=s(),F=[],D=null,a=function(t,e){var n=C.fmtKey()(t.point.series),r=C.getCount()(t.point.series),a;return"<h3>"+n+"</h3><p>"+C.getValue()(t.point.series)+" on "+r+"</p>"},L=function(t,e,n){var r=a(t,n);return xt.show(t.e,r,null,null,e)};function T(t){return t.each(function(t){var e=this,s=Nt.select(this),n="gauge",c=t&&t.properties||{},r=t&&t.data||null,u=parseInt(s.style("width"),10),d=parseInt(s.style("height"),10),a="datetime"===c.xDataType||!1,i="currency"===c.yDataType||!1;function f(t,e){var n=t&&t.length,r=(u-y.left-y.right)/2+y.left,a=(d-y.top-y.bottom)/2+y.top;return zt.displayNoData(n,s,e||A.noData,r,a)}if(T.update=function(){s.transition().duration(w).call(T)},T.container=this,f(r))return T;var o=0;C.minValue(o),r.forEach(function(n,t){var r=C.getValue()(n);n.seriesIndex=t,r||n.values?zt.isNumeric(n.value)&&(n.values=[{x:0,y:r}]):n.values=[],n.values.forEach(function(t,e){t.index=e,t.series=n,t.y0=o,t.y1=o+r}),n.value=r||Nt.sum(n.values,function(t){return C.getValue()(t)}),n.count=n.count||n.values.length,n.disabled=n.disabled||0===n.value,o+=r});var h=r.filter(function(t,e){return!t.disabled});if(c.count=Nt.sum(h,function(t){return t.count}),C.maxValue(o),M.disabled=r.map(function(t){return!!t.disabled}),f(h))return T;S.chart(T).title(c.title).controlsData(F).legendData(r);var l,p=s.selectAll("g.sc-chart-wrap").data([h]).enter().append("g").attr("class","sc-chart-wrap sc-chart-"+n),g=s.select(".sc-chart-wrap").merge(p);p.append("defs"),p.append("g").attr("class","sc-background-wrap");var m=g.select(".sc-background-wrap");p.append("g").attr("class","sc-title-wrap"),p.append("g").attr("class","sc-gauge-wrap");var v=g.select(".sc-gauge-wrap");p.append("g").attr("class","sc-controls-wrap"),p.append("g").attr("class","sc-legend-wrap"),g.attr("transform",zt.translation(y.left,y.top)),p.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-y.left).attr("y",-y.top).attr("fill","#FFF"),T.render=function(){var t,e,n,r,a,i,o,l;if(u=parseInt(s.style("width"),10),d=parseInt(s.style("height"),10),e=x||d||400,n=(t=b||u||960)-y.left-y.right,r=e-y.top-y.bottom,i=n-(a={top:0,right:0,bottom:0,left:0}).left-a.right,o=r-a.top-a.bottom,m.select(".sc-background").attr("width",t).attr("height",e),S.width(n).height(r),s.call(S),l=S.getHeight(),a.top+=l,(o=r-a.top-a.bottom)<100)return f(null,A.displayError),T;C.width(i).height(o),v.datum(h).attr("transform",zt.translation(a.left,a.top)).transition().duration(w).call(C),C.setPointer(c.value)},T.render(),I.on("tooltipShow",function(t){k&&(D=L(t,e.parentNode,c))}),I.on("tooltipMove",function(t){D&&xt.position(e.parentNode,D,t)}),I.on("tooltipHide",function(){k&&xt.cleanup()}),I.on("changeState",function(n){void 0!==n.disabled&&(h.forEach(function(t,e){t.disabled=n.disabled[e]}),M.disabled=n.disabled),T.update()}),I.on("chartClick",function(){S.controls.enabled()&&S.controls.dispatch.call("closeMenu",this),S.legend.enabled()&&S.legend.dispatch.call("closeMenu",this)})}),T}return S.showTitle(!0).showControls(!1).showLegend(!0).alignLegend("center"),C.dispatch.on("elementMouseover.tooltip",function(t){I.call("tooltipShow",this,t)}),C.dispatch.on("elementMousemove.tooltip",function(t){I.call("tooltipMove",this,t)}),C.dispatch.on("elementMouseout.tooltip",function(){I.call("tooltipHide",this)}),T.dispatch=I,T.gauge=C,T.legend=S.legend,T.controls=S.controls,T.options=zt.optionsFunc.bind(T),zt.rebind(T,C,"id","x","y","color","fill","classes","gradient","locality"),zt.rebind(T,C,"getKey","getValue","getCount","fmtKey","fmtValue","fmtCount"),zt.rebind(T,C,"showLabels","showPointer","setPointer","ringWidth","labelThreshold","maxValue","minValue"),zt.rebind(T,S,"showTitle","showControls","showLegend"),T.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},a=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(e){case"graduated":n=function(t,e){return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(t.seriesIndex/r.l)};break;case"class":n=function(){return"inherit"},a=function(t,e){var n=t.seriesIndex*(r.step||1)%14;return n=(9<n?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n+" sc-stroke"+n};break;case"data":n=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},a=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var i=r.gradient?function(t,e){return C.gradientFill(t,t.seriesIndex)}:n;return C.color(n),C.fill(i),C.classes(a),S.legend.color(n),S.legend.classes(a),T},T.margin=function(t){if(!arguments.length)return y;for(var e in t)t.hasOwnProperty(e)&&(y[e]=t[e]);return T},T.width=function(t){return arguments.length?(b=t,T):b},T.height=function(t){return arguments.length?(x=t,T):x},T.tooltips=function(t){return arguments.length?(k=t,T):k},T.tooltipContent=function(t){return arguments.length?(a=t,T):a},T.state=function(t){return arguments.length?(M=t,T):M},T.strings=function(t){return arguments.length?(A=c(t),S.strings(A),T):A},T.direction=function(t){return arguments.length?(e=t,C.direction(t),S.direction(t),T):e},T.duration=function(t){return arguments.length?(w=t,C.duration(t),T):w},T.delay=function(t){return arguments.length?(n=t,C.delay(t),T):n},T}function x(){var Z=Math.floor(1e4*Math.random()),U={top:0,right:0,bottom:0,left:0},$=null,J=null,e=!1,n="ltr",Q=!0,tt=0,et=100,r={},nt=c(),a=!0,rt=!1,at=!0,it=null,ot=[],lt={},st={},ct=function(t,e){return zt.defaultColor()(t,e)},ut=function(t,e){return"sc-country-"+e},dt=ct,ft=Nt.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState","elementClick","elementDblClick","elementMouseover","elementMouseout"),ht=Nt.geoOrthographic().precision(.1),pt=Nt.geoPath().projection(ht),gt=Nt.geoGraticule(),mt=0,vt=null,i=function(t,e){return"<p><b>"+t.name+"</b></p><p><b>Amount:</b> $"+Nt.format(",.0f")(t.amount)+"</p>"};function yt(t,e,n){var r=i(t,n);return xt.show(t.e,r,null,null,e)}var o=function(t,e,n){};function bt(t){return t.each(function(t){var e=this,i=Nt.select(this),a=Nt.select("#"+Z+" svg").node(),n=t?t.properties:{},r=t?t.data:null,o=parseInt(i.style("width"),10),l=parseInt(i.style("height"),10),s=Q,c,u,d,f,h=!1,p={rotate:[et,tt],scale:1,zoom:1},g={rotate:[null,null],scale:null,zoom:null},m,v,y,b,x;function w(t,e){var n=t&&t.length,r=(o-U.left-U.right)/2+U.left,a=(l-U.top-U.bottom)/2+U.top;return zt.displayNoData(n,i,e||nt.noData,r,a)}if(bt.container=this,it=it||function(t,e){return zt.colorRadialGradient(t,e,0,0,"35%","35%",ct(t,e),C)},w(r))return bt;var k=r[0],M,A=i.selectAll("g.sc-chart-wrap").data([1]).enter().append("g").attr("class","sc-chart-wrap sc-chart-globe"),I=i.select(".sc-chart-wrap").merge(A);A.append("defs");var C=I.select("defs");A.append("svg:rect").attr("class","sc-chart-background").attr("transform",zt.translation(U.left,U.top));var S=I.select(".sc-chart-background"),F=A.append("g").attr("class","sc-globe"),D=I.select(".sc-globe");F.append("path").datum({type:"Sphere"}).attr("class","sphere");var L=Nt.select(".sphere");if(at){F.append("path").datum(gt).attr("class","graticule");var T=Nt.select(".graticule")}var E=Nt.zoom().on("start",N).on("zoom",z).on("end",P);function N(){c=O(Nt.event.sourceEvent),u=ht.invert(c),d=ht.rotate(),Q&&(xt.cleanup(),Q=!1),rt&&clearInterval(m)}function z(){if(c){var t=H(Nt.event.transform.k),e,n,r;e=O(Nt.event.sourceEvent),(n=ht.invert(e))[0]&&(r=[d[0]+n[0]-u[0],g.rotate[1]||p.rotate[1]],d=[r[0],r[1]],ht.rotate(r).scale(t),j())}}function P(){c=null,Q=s}function O(t){var e=a.getBoundingClientRect(),n,r;return[(t&&t.clientX||0)-e.left,(t&&t.clientY||0)-e.top]}function _(){v=$||parseInt(i.style("width"),10)||960,y=J||parseInt(i.style("height"),10)||400,b=v-U.left-U.right,x=y-U.top-U.bottom}function H(t){var e,n;return Math.min(Math.max(t,.75),3)*(Math.min(x,b)/2)}function B(){return[b/2+U.left,x/2+U.top]}function R(t,e){mt=k._total;var n,r=F.append("g").attr("class",e).selectAll("path").data(t).enter().append("path").attr("d",K).attr("class",ut).style("fill",function(t,e){return t.amount=Y(t),dt(t,t.properties.mapcolor13||e)});function a(t,e,n,r){var a;return{point:e,e:t,name:st[e.properties.iso_a2]||e.properties.name,amount:Y(e)}}f=D.selectAll("path").merge(r),r.on("click",V).on("mouseover",function(t,e,n){if(t.properties){var r=a(Nt.event,t,e,n);ft.call("tooltipShow",this,r)}}).on("mousemove",function(t,e,n){var r=Nt.event;ft.call("tooltipMove",this,r)}).on("mouseout",function(){ft.call("tooltipHide",this)})}function V(t){if(h!=Nt.select(this)&&(G(),lt[t.id])){Q&&xt.cleanup();var e=Nt.geoCentroid(t),n=pt.bounds(t),r=b/(n[1][0]-n[0][0]),a=x/(n[1][1]-n[0][1]),i=Math.min(b*r,x*a)/2,o=[-e[0],-e[1]];p={rotate:ht.rotate(),scale:ht.scale()},ht.rotate(o).scale(i),g={rotate:ht.rotate(),scale:ht.scale()};var l=W(t);l.parent=k,mt=(k=l)._total,h=Nt.select(this),R(lt[t.id],"states"),h.style("display","none"),j()}}function G(){h&&(ht.rotate(p.rotate).scale(p.scale),g={rotate:[null,null],scale:null},k=k.parent,mt=k._total,h.style("display","inline"),Nt.select(".states").remove(),h=!1,j())}function W(t){return k._values[t.id]||k._values[t.properties.name]||{_total:0}}function Y(t){return W(t)._total||0}function q(){var t,e=[10,0],n;X([ht.rotate()[0]+e[0]/8,tt])}function X(t){ht.rotate(t),j()}function j(t){D.selectAll("path").attr("d",K)}function K(t){return pt(t)||"M0,0Z"}D.call(E),L.on("click",function(){G()}),bt.update=function(){i.transition().call(bt)},bt.resize=function(){var t,e;_(),t=H(ht.scale()),e=B(),S.attr("width",b).attr("height",x),ht.scale(t).translate(e),j()},bt.render=function(){_(),ht.translate(B()).rotate(p.rotate).scale(H(p.scale)),pt.projection(ht),L.attr("d",pt),at&&T.attr("d",pt),S.attr("width",b).attr("height",x),j()},bt.render(),R(ot,"countries"),rt&&(m=setInterval(q,10)),ft.on("tooltipShow",function(t){Q&&(vt=yt(t,e.parentNode,n))}),ft.on("tooltipMove",function(t){vt&&xt.position(e.parentNode,vt,t,"s")}),ft.on("tooltipHide",function(){Q&&xt.cleanup()}),ft.on("changeState",function(t){i.transition().call(bt)})}),bt}return bt.dispatch=ft,bt.projection=ht,bt.path=pt,bt.graticule=gt,bt.options=zt.optionsFunc.bind(bt),bt.margin=function(t){if(!arguments.length)return U;for(var e in t)t.hasOwnProperty(e)&&(U[e]=t[e]);return bt},bt.width=function(t){return arguments.length?($=t,bt):$},bt.height=function(t){return arguments.length?(J=t,bt):J},bt.tooltips=function(t){return arguments.length?(Q=t,bt):Q},bt.tooltipContent=function(t){return arguments.length?(i=t,bt):i},bt.state=function(t){return arguments.length?(r=t,bt):r},bt.strings=function(t){return arguments.length?(nt=c(t),bt):nt},bt.showTitle=function(t){return arguments.length?(e=t,bt):e},bt.direction=function(t){return arguments.length?(n=t,bt):n},bt.id=function(t){return arguments.length?(Z=t,bt):Z},bt.color=function(t){return arguments.length?(ct=t,bt):ct},bt.fill=function(t){return arguments.length?(dt=t,bt):dt},bt.classes=function(t){return arguments.length?(ut=t,bt):ut},bt.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t,e){return zt.defaultColor()(t,e)},a=function(t,e){return"sc-country-"+e+(t.classes?" "+t.classes:"")};switch(e){case"graduated":n=function(t,e){return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(e/r.l)};break;case"class":n=function(){return""},a=function(t,e){var n=e*(r.step||1)%14;return"sc-country-"+e+" sc-fill"+(n=(9<n?"":"0")+n)};break;case"data":n=function(t,e){var n=t.amount||0;return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(n/mt)}}var i=r.gradient?function(t,e){return bt.gradient()(t,e)}:n;return bt.color(n),bt.classes(a),bt.fill(i),bt},bt.gradient=function(t){return arguments.length?(it=t,bt):it},bt.showLabels=function(t){return arguments.length?(a=t,bt):a},bt.autoSpin=function(t){return arguments.length?(rt=t,bt):rt},bt.worldMap=function(t){return arguments.length?(ot=t,bt):ot},bt.countryMap=function(t){return arguments.length?(lt=t,bt):lt},bt.countryLabels=function(t){return arguments.length?(st=t,bt):st},bt.seriesClick=function(t){return arguments.length?(o=t,bt):o},bt}function w(){var X={top:10,right:10,bottom:10,left:10},j=null,K=null,e="ltr",n=0,Z=0,U=!0,$={},J=c(),Q=Nt.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),tt=3,et={},nt=function(t,e,n,r,a){var i=n||t,o;return r?(o=a&&0===a.indexOf("%")?a:"%x",zt.dateFormat(i,o,et)):i},rt=function(t,e,n,r,a){return zt.numberFormatSIFixed(t,r,n,et,a)},i=function(t,e){var n=t.group||{},r=t.point.x,a=t.point.y,i="datetime"===e.xDataType,o="currency"===e.yDataType,l={seriesName:e.seriesName||J.tooltip.key,seriesLabel:t.series.key,groupName:e.groupName||(i?J.tooltip.date:J.tooltip.group),groupLabel:nt(r,t.pointIndex,n.label,i,"%x"),valueName:o?J.tooltip.amount:J.tooltip.count,valueLabel:zt.numberFormat(a,null,o,et)},s;return t.group&&zt.isNumeric(t.group._height)&&(s=Math.abs(100*a/t.group._height).toFixed(1),l.percent=zt.numberFormat(s,2,!1,et)),xt.multi(l,J)},at=function(t,e,n,r){},it=y(),ot=s(),lt=v(),st=v(),ct=null,ut=function(t,e,n){var r=i(t,n),a=t.value<0?"n":"s";return xt.show(t.e,r,a,null,e)};function dt(t){return t.each(function(t){var e=this,g=Nt.select(this),n="line",r=t&&t.properties||{},a=t&&t.data||null,m=parseInt(g.style("width"),10),v=parseInt(g.style("height"),10),y=j,b=K,o="datetime"===r.xDataType||!1,i="numeric"===r.xDataType||!1,l="currency"===r.yDataType||!1,s=r.groups,c=Array.isArray(s)&&0<s.length,u=[],d=0,f=!1,x=[],h=0,p=0,w=it.padData()?tt:0,k=!1,M=[{key:"Linear",disabled:"linear"!==it.interpolate()},{key:"Basis",disabled:"basis"!==it.interpolate()},{key:"Monotone",disabled:"monotone"!==it.interpolate()},{key:"Cardinal",disabled:"cardinal"!==it.interpolate()},{key:"Line",disabled:!0===it.isArea()()},{key:"Area",disabled:!1===it.isArea()()}];function A(t,e){var n=t&&t.length&&t.filter(function(t){return!t.disabled&&Array.isArray(t.values)&&t.values.length}).length,r=(m-X.left-X.right)/2+X.left,a=(v-X.top-X.bottom)/2+X.top;return zt.displayNoData(n,g,e||J.noData,r,a)}if(dt.update=function(){g.transition().duration(Z).call(dt)},dt.setActiveState=function(t,e){t.active=e,t.values.forEach(function(t){t.active=e})},dt.clearActive=function(e){a.forEach(function(t){dt.setActiveState(t,e||"")}),delete $.active},dt.cellActivate=function(t){var e=a[t.seriesIndex].values[t.pointIndex],n;e&&(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"",dt.clearActive(),e.active=n)},dt.seriesActivate=function(t){var e=t.series||a[t.seriesIndex],n;e&&(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"",dt.clearActive("active"===n?"inactive":""),dt.setActiveState(e,n),$.active=a.map(function(t){return"active"===t.active}))},dt.dataSeriesActivate=function(t){var e=t.series||a[t.seriesIndex],n;e&&("active"===(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"inactive")?dt.seriesActivate(t):dt.clearActive())},dt.container=this,A(a))return dt;if(et=dt.locality(),a.forEach(function(t,e){t.seriesIndex=e,t.key=t.key||J.noLabel,t.total=Nt.sum(t.values,function(t,e){return t.group=c?t.x-1:e,t.y}),t.disabled=t.disabled||0===t.total}),h=(x=a.filter(function(t){return!t.disabled}).map(function(t,e){return t.seri=e,t})).length,A(x))return dt;function I(t){u=t.map(function(t){return t.label}),d=u.length,f=0<d}c?(s.forEach(function(n,r){var t=void 0===n.label||""===n.label?J.noLabel:o?zt.isNumeric(n.label)||-1!==n.label.indexOf("GMT")?new Date(n.label):new Date(n.label+" GMT"):n.label;n.group=r,n.label=t,n.total=0,x.forEach(function(t,e){t.values.filter(function(t,e){return t.group===r}).forEach(function(t,e){n.total+=t.y})})}),I(s),p=Nt.sum(s,function(t){return t.total})):(u=Nt.merge(x.map(function(t){return t.values})).reduce(function(t,e){return-1===t.indexOf(e.x)&&t.push(e.x),t},[]).map(function(t,e){return o?new Date(t):t}),d=Math.min(Math.ceil(innerWidth/100),u.length),p=Nt.sum(x,function(t){return t.total}));var C=75,S=null,F=null,D=null,L={axis:null,maxmin:null};function T(t,e){var n=e.map(function(t){return Nt.select(t).datum()}),r=Nt.max(Nt.extent(n),function(t){return zt.siDecimal(Math.abs(t))}),a=Nt.max(n,function(t){var e=Nt.formatPrefix(".2s",r)(t);return zt.countSigFigsAfter(e)});return"maxmin"===t&&L.axis&&(a=Math.max(L.axis.precision,a)),L[t]={decimal:r,precision:a},L[t]}o&&(S=zt.getDateFormatUTC(u)),F=function(t,e,n,r){var a=f?u[e]:t,i=nt(t,e,a,o,S);return"no-ellipsis"===r?i:zt.stringEllipsify(i,g,C)},D=function(t,e,n,r){var a=L[r]||T(r,n);return rt(t,e,l,a.precision,a.decimal)},$.disabled=x.map(function(t){return!!t.disabled}),$.interpolate=it.interpolate(),$.isArea=it.isArea()(),ot.chart(dt).title(r.title).controlsData(M).legendData(a),k=1===Nt.max(x,function(t){return t.values.length});var E=Math.pow(tt,2)*Math.PI*(k?3:1);if(it.xScale(o?Nt.scaleTime():Nt.scaleLinear()).singlePoint(k).size(E).sizeRange([E,E]).sizeDomain([E,E]),k){var N=Nt.merge(x.map(function(t){return t.values.map(function(t,e){return it.x()(t,e)})})).reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[]).sort(function(t,e){return t-e}),z=Nt.extent(N),P=1*(o&&!u.length?864e5:1),O=Nt.merge(x.map(function(t){return t.values.map(function(t,e){return it.y()(t,e)})})),_=Nt.extent(O),H=1===x.length?2:Math.min((_[1]-_[0])/x.length,_[0]);it.xDomain([z[0]-P,z[1]+P]).yDomain([_[0]-H,_[1]+H]),lt.orient("bottom").ticks(N.length).tickValues(N).highlightZero(!1).showMaxMin(!1),st.orient("left").ticks(k?5:null).highlightZero(!1).showMaxMin(!1)}else it.xDomain(null).yDomain(null),lt.orient("bottom").tickValues(f?Nt.range(1,d+1):null).ticks(f?d:null).highlightZero(!1).showMaxMin(!f),st.orient("left").ticks(null).highlightZero(!0).showMaxMin(!0);lt.scale(it.xScale()).tickPadding(6).valueFormat(F),st.scale(it.yScale()).tickPadding(6).valueFormat(D);var B,R=g.selectAll("g.sc-chart-wrap").data([x]).enter().append("g").attr("class","sc-chart-wrap sc-chart-line"),V=g.select(".sc-chart-wrap").merge(R);R.append("defs"),R.append("g").attr("class","sc-background-wrap");var G=V.select(".sc-background-wrap");R.append("g").attr("class","sc-title-wrap"),R.append("g").attr("class","sc-axis-wrap sc-axis-x");var W=V.select(".sc-axis-wrap.sc-axis-x");R.append("g").attr("class","sc-axis-wrap sc-axis-y");var Y=V.select(".sc-axis-wrap.sc-axis-y");R.append("g").attr("class","sc-line-wrap");var q=V.select(".sc-line-wrap");R.append("g").attr("class","sc-controls-wrap"),R.append("g").attr("class","sc-legend-wrap"),V.attr("transform",zt.translation(X.left,X.top)),R.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-X.left).attr("y",-X.top).attr("fill","#FFF"),dt.render=function(){var t,e,n,r,a,i,o=0,l=0;if(m=parseInt(g.style("width"),10),v=parseInt(g.style("height"),10),e=K||v||400,y=(t=j||m||960)-X.left-X.right,b=e-X.top-X.bottom,r=y-(n={top:0,right:0,bottom:0,left:0}).left-n.right,a=b-n.top-n.bottom,G.select(".sc-background").attr("width",t).attr("height",e),C=Math.max(.2*y,75),ot.width(y).height(b),g.call(ot),i=ot.getHeight(),n.top+=i,(a=b-n.top-n.bottom)<100)return A(null,J.displayError),dt;function s(t){return"width"===t?r:"height"===t?a:0}it.width(s("width")).height(s("height")),q.datum(x).call(it);var c={top:0,right:0,bottom:0,left:0},u={top:0,right:0,bottom:0,left:0};function d(){u=lt.margin(),c=st.margin(),n.left=Math.max(u.left,c.left),n.right=Math.max(u.right,c.right),n.top=Math.max(u.top,c.top),n.bottom=Math.max(u.bottom,c.bottom),f()}function f(){r=y-n.left-n.right,a=b-i-n.top-n.bottom,it.resetDimensions(s("width"),s("height"))}function h(){st.tickSize(w-r,0).margin(n),Y.call(st),d()}function p(){lt.tickSize(w-a,0).margin(n),W.call(lt),d()}h(),p(),h(),p(),h(),q.transition().duration(Z).call(it),n.top+=i,o=n.left,l=n.top+("bottom"===lt.orient()?a:0),W.attr("transform",zt.translation(o,l)),o=n.left+("left"===st.orient()?0:r),l=n.top,Y.attr("transform",zt.translation(o,l)),q.attr("transform",zt.translation(n.left,n.top))},dt.render(),ot.legend.dispatch.on("legendClick",function(t,e){t.disabled=!t.disabled,a.filter(function(t){return!t.disabled}).length||a.forEach(function(t){t.disabled=!1}),$.disabled=a.map(function(t){return!!t.disabled}),t.active="inactive",t.values.forEach(function(t){t.active="inactive"}),a.filter(function(t){return"active"===t.active}).length||dt.clearActive(),$.active=a.map(function(t){return!!t.active}),dt.update(),Q.call("stateChange",this,$)}),ot.controls.dispatch.on("legendClick",function(t,e){if(t.disabled){switch(M.forEach(function(t){t.disabled=!0}),t.disabled=!1,t.key){case"Basis":it.interpolate("basis");break;case"Linear":it.interpolate("linear");break;case"Monotone":it.interpolate("monotone");break;case"Cardinal":it.interpolate("cardinal");break;case"Line":it.isArea(!1);break;case"Area":it.isArea(!0)}$.interpolate=it.interpolate(),$.isArea=it.isArea(),dt.update(),Q.call("stateChange",this,$)}}),Q.on("tooltipShow",function(t){U&&(f&&(t.group=s[t.groupIndex]),ct=ut(t,e.parentNode,r))}),Q.on("tooltipMove",function(t){ct&&xt.position(e.parentNode,ct,t,"s")}),Q.on("tooltipHide",function(){U&&xt.cleanup()}),Q.on("changeState",function(n){void 0!==n.disabled&&(a.forEach(function(t,e){t.disabled=n.disabled[e]}),$.disabled=n.disabled),void 0!==n.interpolate&&(it.interpolate(n.interpolate),$.interpolate=n.interpolate),void 0!==n.isArea&&(it.isArea(n.isArea),$.isArea=n.isArea),dt.update()}),Q.on("chartClick",function(){ot.controls.enabled()&&ot.controls.dispatch.call("closeMenu",this),ot.legend.enabled()&&ot.legend.dispatch.call("closeMenu",this)}),it.dispatch.on("elementClick",function(t){f&&t.groupIndex&&(t.group=s[t.groupIndex]),Q.call("chartClick",this),it.dispatch.call("elementMouseout",this,t),at(a,t,dt,u)}),g.on("click",function(){Nt.event.stopPropagation(),Q.call("chartClick",this)})}),dt}return it.clipEdge(!0),ot.showTitle(!0).showControls(!0).showLegend(!0),it.dispatch.on("elementMouseover.tooltip",function(t){Q.call("tooltipShow",this,t)}),it.dispatch.on("elementMousemove.tooltip",function(t){Q.call("tooltipMove",this,t)}),it.dispatch.on("elementMouseout.tooltip",function(t){Q.call("tooltipHide",this,t)}),dt.dispatch=Q,dt.lines=it,dt.legend=ot.legend,dt.controls=ot.controls,dt.xAxis=lt,dt.xAxisLabel=lt.axisLabel,dt.yAxis=st,dt.yAxisLabel=st.axisLabel,dt.options=zt.optionsFunc.bind(dt),zt.rebind(dt,it,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),zt.rebind(dt,it,"defined","isArea","interpolate","size","clipVoronoi","useVoronoi","interactive","nice"),zt.rebind(dt,ot,"showTitle","showControls","showLegend"),zt.rebind(dt,lt,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),dt.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t){return zt.defaultColor()(t,t.seriesIndex)},a=function(t){return"sc-series sc-series-"+t.seriesIndex};switch(e){case"graduated":n=function(t){return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(t.seriesIndex/r.l)};break;case"class":n=function(){return"inherit"},a=function(t){var e=t.seriesIndex,n=e*(r.step||1)%14;return"sc-series sc-series-"+e+" sc-fill"+(n=(9<n?"":"0")+n)+" sc-stroke"+n};break;case"data":n=function(t){return zt.defaultColor()(t,t.seriesIndex)},a=function(t){var e;return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}return it.color(n),it.fill(n),it.classes(a),ot.legend.color(n),ot.legend.classes(a),dt},dt.margin=function(t){if(!arguments.length)return X;for(var e in t)t.hasOwnProperty(e)&&(X[e]=t[e]);return dt},dt.width=function(t){return arguments.length?(j=t,dt):j},dt.height=function(t){return arguments.length?(K=t,dt):K},dt.tooltips=function(t){return arguments.length?(U=t,dt):U},dt.tooltipContent=function(t){return arguments.length?(i=t,dt):i},dt.state=function(t){return arguments.length?($=t,Q.call("stateChange",this,$),dt):$},dt.strings=function(t){return arguments.length?(J=c(t),ot.strings(J),dt):J},dt.direction=function(t){return arguments.length?(e=t,it.direction(t),lt.direction(t),st.direction(t),ot.direction(t),dt):e},dt.duration=function(t){return arguments.length?(Z=t,it.duration(t),dt):Z},dt.delay=function(t){return arguments.length?(n=t,it.delay(t),dt):n},dt.xValueFormat=function(t){return arguments.length?(nt=t,dt):nt},dt.yValueFormat=function(t){return arguments.length?(rt=t,dt):rt},dt.seriesClick=function(t){return arguments.length?(at=t,dt):at},dt.pointRadius=function(t){return arguments.length?(tt=t,dt):tt},dt}var yt=function(){function C(t){return t[0]}function S(t){return t[1]}function F(t){return t.x}function D(t){return t.y}function L(t,e){return e}function T(t){return t}function p(t){return t.hasOwnProperty("value")||t.hasOwnProperty("y")}function r(t){return Array.isArray(t.values)&&t.values.length}function g(t){return r(t)&&1===t.values.length}function E(t,e){var n;return-1!==["multibar","line","area","pie","funnel","gauge"].indexOf(t)&&Array.isArray(e)&&0<e.filter(function(t){return r(t)||p(t)}).length}function N(t,e){var n;return-1!==["multibar","line","area"].indexOf(t)&&Array.isArray(e)&&0<e.length}function z(t){return Array.isArray(t)&&0<t.length&&Array.isArray(t[0])}function P(t){return Array.isArray(t)&&0<t.length&&p(t[0])}function O(t){return void 0!==t&&String(t.hasOwnProperty("label")?t.label:t).toString()||e}function _(t){return void 0!==t&&t.hasOwnProperty("key")?String(t.key).toString()||e:O(t)}function H(t,e){t.hasOwnProperty("disabled")&&(e.disabled=t.disabled),t.hasOwnProperty("color")&&(e.color=t.color),t.hasOwnProperty("classes")&&(e.classes=t.classes)}var e=c().translate("noLabel"),t=function(t,e,n){var r=t.properties?Array.isArray(t.properties)?t.properties[0]:t.properties:{},a=[],i=[],o=[],l=!1,s=!1,c=!1,u="datetime"===r.xDataType||!1,d="numeric"===r.xDataType||!1,f=!1,h,p,g,m;function v(t,e){var n={group:e+1,label:O(t)};return t.values&&(n.total=y(t)),n}function y(t){var e=0;return t.hasOwnProperty("value")?e=t.value:t.hasOwnProperty("y")?e=t.y:t.hasOwnProperty("values")?e=Nt.sum(t.values,m):zt.isNumeric(t)&&(e=t),e}function b(t,e){var n=s?t:{};return n.x=g(t,e),n.y=m(t,e),n}function x(a,t){return t.values.map(function(t,e){var n=s?t:{},r=p(t,e)+p(a.values[e],e);return n.x=g(t,e),n.y=parseFloat(r),n})}function w(t){var e,n;return n=t.values.map(b),H(t,e={key:_(t),values:n}),e}function k(t,r,e){var n,a;return a=e.map(function(t,e){var n=t.values[0];return r===e?b(n,e):{x:g(n,e),y:0}}),H(t,n={key:_(t),values:a}),n}function M(t,e){var n,r;return r=[b(t.values[e]||t.values[0],e)],H(t,n={key:_(t),values:r}),n}function A(t,e){var n,r;n=t.keys||e.shift().splice(1),o=[],r=Nt.transpose(e.map(function(t,e){var n=t.shift();return u||d||o.push(v(n,e)),t.map(function(t){return u||d?[n,t]:[e+1,t]})})),a=n.map(function(t,e){return{key:t,values:r[e]}})}if(z(t.values)?A(r,t.values):t.values?(a=t.values,o=t.label||[]):(a=t.data,o=r.groups||r.labels||r.label||[]),f=N(e,o),E(e,a)){switch(l=z(a[0].values),s=P(a[0].values),c=B(a,o,h=l?C:s?F:L,p=l?S:s?D:T),g=f?function(t,e){return e+1}:u?function(t,e){var n,r,a;return"string"==typeof(r=4===(n=h(t,e)).toString().length?"1/1/"+n.toString():n)&&-1===r.indexOf("GMT")&&(r+=" GMT"),(a=new Date(r)).valueOf()}:d?function(t,e){return parseFloat(h(t,e))}:function(t,e){return h(t,e)},m=function(t,e){return parseFloat(p(t,e))},e){case"multibar":"basic"===n?(i=1===a.length?a.map(w):[{key:r.key||"Series 0",values:a.reduce(x)}],r.colorLength=i[0].values.length):i=c?a.map(M):a.map(w);break;case"gauge":case"pie":i=a.map(function(t){var e;return H(t,e={key:_(t),value:y(t)}),e});break;case"funnel":i=a.reverse().map(function(t,e){var n,r;return n=Nt.sum(t.values,p),H(t,r={key:_(t),values:[{series:e,x:0,y:n,y0:0}]}),r});break;case"area":case"line":i=a.map(w)}h=F,p=D,N(e,o)?r.groups=o.map(v):delete r.groups,r.hasOwnProperty("colorLength")||(r.colorLength=i.length),i.forEach(function(t,e){t.seriesIndex=e,t.total=y(t),t.total||(t.disabled=!0)})}else switch(e){case"bubble":if(t.data)r=t.properties,i=t.data;else{var I={"Negotiation/Review":"Negotiat./Review","Perception Analysis":"Percept. Analysis","Proposal/Price Quote":"Proposal/Quote","Id. Decision Makers":"Id. Deciders"};r={title:"Bubble Chart Data",yDataType:"string",xDataType:"datetime",colorLength:t.records.length},i=t.records.map(function(t){return{id:t.id,x:t.date_closed,y:Math.round(parseInt(t.likely_case,10)/parseFloat(t.base_rate)),shape:"circle",account_name:t.account_name,assigned_user_name:t.assigned_user_name,sales_stage:t.sales_stage,sales_stage_short:I[t.sales_stage]||t.sales_stage,probability:parseInt(t.probability,10),base_amount:parseInt(t.likely_case,10),currency_symbol:"$"}})}break;case"pareto":r=t.properties,i=t.data}return{properties:r,data:i}},B=function(r,a,i,o){var n=null,l=null,s=Array.isArray(a)&&0<a.length&&a.length===r.length;function c(t,r){return t.reduce(function(t,e){return e.values.reduce(function(t,e){var n=r(e);return-1===t.indexOf(n)&&t.push(n),t},t)},[]).length===t.length}function u(t,e){return t.length===t[0].values.length&&t.filter(function(t){return t.values.filter(function(t){return 0!==e(t)}).length<=1}).length===t.length}function d(t,e,n){return _(t)===O(e[n])}function f(t,e){return null===n?c(t,e):n}function h(t,e){return null===l?u(t,e):l}return r.reduce(function(t,e,n){return!!t&&(p(e)||g(e)&&(s&&d(e,a,n)||f(r,i))||(!s||d(e,a,n))&&h(r,o))},!0)};return t.areValuesDiscrete=B,t}();function k(){var q={top:10,right:10,bottom:10,left:10},X=null,j=null,e="ltr",n=0,K=0,Z=!0,U={},$=c(),J=Nt.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),Q=!0,tt=!0,et=!0,nt=function(t){},rt={},at=function(t,e,n,r,a){var i=n||t,o;return r?(o=a&&0===a.indexOf("%")?a:"%x",zt.dateFormat(i,o,rt)):i},it=function(t,e,n,r,a){return zt.numberFormatSIFixed(t,r,n,rt,a)},ot=function(t,e,n,r){return n||zt.numberFormatSI(t,0,r,rt)},i=function(t,e){var n=t.group||{},r=t.point.x,a=t.point.y,i="datetime"===e.xDataType,o="currency"===e.yDataType,l={seriesName:e.seriesName||$.tooltip.key,seriesLabel:t.series.key,groupName:e.groupName||(i?$.tooltip.date:$.tooltip.group),groupLabel:at(r,t.pointIndex,n.label,i,"%x"),valueName:o?$.tooltip.amount:$.tooltip.count,valueLabel:zt.numberFormat(a,null,o,rt)},s;return t.group&&zt.isNumeric(t.group._height)&&(s=Math.abs(100*a/t.group._height).toFixed(1),l.percent=zt.numberFormat(s,2,!1,rt)),xt.multi(l,$)},lt=function(t,e,n,r){},st=b(),ct=s(),ut=v(),dt=v(),ft=!1,ht=0,pt=d().id(st.id()),gt=null,mt=function(t,e,n){var r=i(t,n),a=t.value<0?Q?"n":"e":Q?"s":"w";return xt.show(t.e,r,a,null,e)};function vt(t){return t.each(function(t){var e=this,x=Nt.select(this),n=Q?"multibar":"multibar-horizontal",r=t&&t.properties||{},w=t&&t.data||null,k=parseInt(x.style("width"),10),M=parseInt(x.style("height"),10),A=X,I=j,o="datetime"===r.xDataType||!1,a="numeric"===r.xDataType||!1,i="currency"===r.yDataType||!1,l=r.groups,s=Array.isArray(l)&&0<l.length,c=[],C=0,u=!1,d=!1,S=[],F=0,f=0,D=st.stacked()&&Q?72:32,h=[{key:"Grouped",disabled:st.stacked()},{key:"Stacked",disabled:!st.stacked()}];function L(t,e){var n=t&&t.length&&t.filter(function(t){return!t.disabled&&Array.isArray(t.values)&&t.values.length}).length,r=(k-q.left-q.right)/2+q.left,a=(M-q.top-q.bottom)/2+q.top;return zt.displayNoData(n,x,e||$.noData,r,a)}if(vt.update=function(){x.transition().duration(K).call(vt)},vt.setActiveState=function(t,e){t.active=e,t.values.forEach(function(t){t.active=e})},vt.clearActive=function(e){w.forEach(function(t){vt.setActiveState(t,e||"")}),delete U.active},vt.cellActivate=function(t){var e=w[t.seriesIndex].values[t.pointIndex],n;e&&(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"",vt.clearActive(),e.active=n)},vt.seriesActivate=function(t){var e=t.series||w[t.seriesIndex],n;e&&(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"",vt.clearActive("active"===n?"inactive":""),vt.setActiveState(e,n),U.active=w.map(function(t){return"active"===t.active}))},vt.dataSeriesActivate=function(t){var e=t.series||w[t.seriesIndex],n;e&&("active"===(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"inactive")?vt.seriesActivate(t):vt.clearActive())},vt.container=this,L(w))return vt;function p(t,e){var n={x:t.x,y:t.y};return void 0!==t.label&&(n.label=t.label),t.active&&(n.active=t.active),n}if(rt=vt.locality(),w.forEach(function(t,e){t._values||(t._values=t.values.map(p)),t.seriesIndex=e,t.key=t.key||$.noLabel,t.total=Nt.sum(t._values,function(t,e){return t.y}),t.disabled=t.disabled||0===t.total}),S=w.filter(function(t){return!t.disabled}).map(function(r,t){return r.seri=t,r.values=r._values.map(function(t,e){var n=p(t,e);return n.groupIndex=o||a?e:t.x-1,n.seriesIndex=r.seriesIndex,n.seri=r.seri,n.color=r.color||"",n}),r}),F=S.length,L(S))return vt;function g(t){c=t.map(function(t){return t.label}),C=c.length,u=0<C}if(s?l.forEach(function(t,e){var n=void 0===t.label||""===t.label?$.noLabel:o?zt.isNumeric(t.label)||-1!==t.label.indexOf("GMT")?new Date(t.label):new Date(t.label+" GMT"):t.label;t.group=e,t.label=n,t.total=0,t._height=0}):l=S[0].values.map(function(t,e){return{group:e,label:o?new Date(t.x):t.x,total:0,_height:0}}),g(l),d=yt.areValuesDiscrete(S,l,st.x(),st.y()),l.forEach(function(n,r){var a=0,i=0;S.forEach(function(t,e){t.values.filter(function(t,e){return t.groupIndex===r}).forEach(function(t,e){t.size=Math.abs(t.y),n._height+=t.size,n.total+=t.y,t.y<0?(t.y0=(d?0:i)-(Q?0:t.size),i-=t.size):(t.y0=(d?0:a)+(Q?t.size:0),a+=t.size)})}),n.neg={label:ot(i),y:i},n.pos={label:ot(a),y:a}}),et&&(g(l.filter(function(t,e){return 0!==t._height})),S.forEach(function(t,e){return t.values=t.values.filter(function(t,e){return 0!==l[t.groupIndex]._height}).map(function(t,e){return t}),t}),L(S)))return vt;f=Nt.sum(l,function(t){return t.total});var T=75,m=null,v=null,y=null,b=null,E=0,N=0===Nt.max(Nt.merge(S.map(function(t){return t.values.map(function(t){var e=st.y()(t);return zt.countSigFigsAfter(e)})})));N&&(E=Nt.max(l,function(t){return t.total}));var z={axis:null,maxmin:null};function P(t,e){var n=e.map(function(t){return Nt.select(t).datum()}),r=Nt.max(Nt.extent(n),function(t){return zt.siDecimal(Math.abs(t))}),a=Nt.max(n,function(t){var e=Nt.formatPrefix(".2s",r)(t);return zt.countSigFigsAfter(e)});return"maxmin"===t&&z.axis&&(a=Math.max(z.axis.precision,a)),z[t]={decimal:r,precision:a},z[t]}o&&(m=zt.getDateFormatUTC(c)),v=function(t,e,n,r){var a=u?c[e]:t,i=at(t,e,a,o,m);return"no-ellipsis"===r?i:zt.stringEllipsify(i,x,T)},y=function(t,e,n,r){var a=z[r]||P(r,n);return it(t,e,i,a.precision,a.decimal)},b=function(t,e,n){return ot(t,e,n,i)},U.disabled=S.map(function(t){return!!t.disabled}),U.active=S.map(function(t){return"active"===t.active}),U.stacked=st.stacked(),ct.chart(vt).title(r.title).controlsData(h).legendData(w),st.valueFormat(b),ut.orient(Q?"bottom":"left").scale(st.xScale()).valueFormat(v).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),dt.orient(Q?"left":"bottom").scale(st.yScale()).valueFormat(y).tickPadding(4).showMaxMin(!0);var O,_=x.selectAll("g.sc-chart-wrap").data([S]).enter().append("g").attr("class","sc-chart-wrap sc-chart-"+n),H=x.select(".sc-chart-wrap").merge(_);_.append("defs");var B=H.select("defs");_.append("g").attr("class","sc-background-wrap");var R=H.select(".sc-background-wrap");_.append("g").attr("class","sc-title-wrap"),_.append("g").attr("class","sc-axis-wrap sc-axis-y");var V=H.select(".sc-axis-wrap.sc-axis-y");_.append("g").attr("class","sc-scroll-wrap");var G=H.select(".sc-scroll-wrap");_.select(".sc-scroll-wrap").append("g").attr("class","sc-axis-wrap sc-axis-x");var W=H.select(".sc-axis-wrap.sc-axis-x");_.select(".sc-scroll-wrap").append("g").attr("class","sc-bars-wrap");var Y=H.select(".sc-bars-wrap");_.append("g").attr("class","sc-controls-wrap"),_.append("g").attr("class","sc-legend-wrap"),H.attr("transform",zt.translation(q.left,q.top)),tt?pt(H,_,G,ut):_.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-q.left).attr("y",-q.top).attr("fill","#FFF"),vt.render=function(){var t,e,n,r,a,i,o=0,l=0;if(k=parseInt(x.style("width"),10),M=parseInt(x.style("height"),10),e=j||M||400,A=(t=X||k||960)-q.left-q.right,I=e-q.top-q.bottom,r=A-(n={top:0,right:0,bottom:0,left:0}).left-n.right,a=I-n.top-n.bottom,R.select(".sc-background").attr("width",t).attr("height",e),ct.width(A).height(I),x.call(ct),i=ct.getHeight(),n.top+=i,(a=I-n.top-n.bottom)<100)return L(null,$.displayError),vt;var s=U.stacked?D:D*F+D,c=D*(U.stacked?.25:1),u=C*s+c;function d(t){return"width"===t?Q&&tt?Math.max(r,u):r:"height"===t?!Q&&tt?Math.max(a,u):a:0}T=Math.max(Q?2*D:.2*A,75),st.vertical(Q).baseDimension(D).disabled(w.map(function(t){return t.disabled})).width(d("width")).height(d("height")),Y.datum(S).call(st);var f={top:0,right:0,bottom:0,left:0},h={top:0,right:0,bottom:0,left:0};function p(){h=ut.margin(),f=dt.margin(),n.left=Math.max(h.left,f.left),n.right=Math.max(h.right,f.right),n.top=Math.max(h.top,f.top),n.bottom=Math.max(h.bottom,f.bottom),g()}function g(){r=A-n.left-n.right,a=I-i-n.top-n.bottom,st.resetDimensions(d("width"),d("height"))}function m(){dt.ticks(N&&E<10?E:a/48).tickSize(Q?-r:-a,0).margin(n),V.call(dt),p()}function v(){ut.tickSize(0).margin(n),W.call(ut),p()}if(m(),v(),m(),v(),m(),Y.transition().duration(K).call(st),n.top+=i,o=Q||"left"===ut.orient()?0:r,l=Q&&"bottom"===ut.orient()?a+2:-2,W.attr("transform",zt.translation(o,l)),o=n.left+(Q||"bottom"===dt.orient()?0:r),l=n.top+(Q||"left"===dt.orient()?0:a),V.attr("transform",zt.translation(o,l)),G.attr("transform",zt.translation(n.left,n.top)),tt){ft=(Q?r:a)<u,W.select(".sc-axislabel").attr("x",(Q?r:-a)/2);var y=(Q?r:a)-u,b=function(){var t;J.call("tooltipHide",this),ht=pt.pan(y),t=Q?r-2*ht:2*ht-a,t/=2,W.select(".sc-axislabel").attr("x",t)};pt.enable(ft).width(r).height(a).margin(n).minDimension(u).vertical(Q).panHandler(b).resize(ht,nt),pt.panHandler()()}},vt.render(),ct.legend.dispatch.on("legendClick",function(t,e){t.disabled=!t.disabled,w.filter(function(t){return!t.disabled}).length||w.forEach(function(t){t.disabled=!1}),U.disabled=w.map(function(t){return!!t.disabled}),t.active="inactive",t.values.forEach(function(t){t.active="inactive"}),w.filter(function(t){return"active"===t.active}).length||vt.clearActive(),U.active=w.map(function(t){return!!t.active}),vt.update(),J.call("stateChange",this,U)}),ct.controls.dispatch.on("legendClick",function(t,e){t.disabled&&(h.forEach(function(t){t.disabled=!0}),t.disabled=!1,st.stacked("Grouped"!==t.key),U.stacked=st.stacked(),vt.update(),J.call("stateChange",this,U))}),J.on("tooltipShow",function(t){Z&&(u&&(t.group=l[t.groupIndex]),gt=mt(t,e.parentNode,r))}),J.on("tooltipMove",function(t){gt&&xt.position(e.parentNode,gt,t,Q?"s":"w")}),J.on("tooltipHide",function(){Z&&xt.cleanup()}),J.on("changeState",function(n){void 0!==n.disabled&&(w.forEach(function(t,e){t.disabled=n.disabled[e]}),U.disabled=n.disabled),void 0!==n.active&&(w.forEach(function(e,t){e.active=n.active[t]?"active":"inactive",e.values.forEach(function(t){t.active=e.active})}),U.active=n.active,w.filter(function(t){return"active"===t.active}).length||vt.clearActive()),void 0!==n.stacked&&(st.stacked(n.stacked),U.stacked=n.stacked),vt.update()}),J.on("chartClick",function(){ct.controls.enabled()&&ct.controls.dispatch.call("closeMenu",this),ct.legend.enabled()&&ct.legend.dispatch.call("closeMenu",this)}),st.dispatch.on("elementClick",function(t){u&&t.groupIndex&&(t.group=l[t.groupIndex]),J.call("chartClick",this),lt(w,t,vt,c)}),x.on("click",function(){Nt.event.stopPropagation(),J.call("chartClick",this)})}),vt}return ct.showTitle(!0).showControls(!0).showLegend(!0),st.dispatch.on("elementMouseover.tooltip",function(t){J.call("tooltipShow",this,t)}),st.dispatch.on("elementMousemove.tooltip",function(t){J.call("tooltipMove",this,t)}),st.dispatch.on("elementMouseout.tooltip",function(t){J.call("tooltipHide",this,t)}),vt.dispatch=J,vt.multibar=st,vt.legend=ct.legend,vt.controls=ct.controls,vt.xAxis=ut,vt.xAxisLabel=ut.axisLabel,vt.yAxis=dt,vt.yAxisLabel=dt.axisLabel,vt.options=zt.optionsFunc.bind(vt),zt.rebind(vt,st,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),zt.rebind(vt,st,"stacked","showValues","nice","textureFill"),zt.rebind(vt,ct,"showTitle","showControls","showLegend"),zt.rebind(vt,ut,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),vt.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t){return zt.defaultColor()(t,t.seriesIndex)},a=function(t){return"sc-series sc-series-"+t.seriesIndex};switch(e){case"graduated":n=function(t){return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(t.seriesIndex/r.l)};break;case"class":n=function(){return"inherit"},a=function(t){var e=t.seriesIndex,n=e*(r.step||1)%14;return"sc-series sc-series-"+e+" sc-fill"+(n=(9<n?"":"0")+n)+" sc-stroke"+n};break;case"data":n=function(t){return zt.defaultColor()(t,t.seriesIndex)},a=function(t){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var i=r.gradient?function(t){var e={orientation:r.orientation||(Q?"vertical":"horizontal"),position:r.position||"middle"};return st.gradientFill(t,t.seriesIndex,e)}:n;return st.color(n),st.fill(i),st.classes(a),ct.legend.color(n),ct.legend.classes(a),vt},vt.margin=function(t){if(!arguments.length)return q;for(var e in t)t.hasOwnProperty(e)&&(q[e]=t[e]);return vt},vt.width=function(t){return arguments.length?(X=t,vt):X},vt.height=function(t){return arguments.length?(j=t,vt):j},vt.tooltips=function(t){return arguments.length?(Z=t,vt):Z},vt.tooltipContent=function(t){return arguments.length?(i=t,vt):i},vt.state=function(t){return arguments.length?(U=t,J.call("stateChange",this,U),vt):U},vt.strings=function(t){return arguments.length?($=c(t),ct.strings($),vt):$},vt.direction=function(t){return arguments.length?(e=t,st.direction(t),ut.direction(t),dt.direction(t),ct.direction(t),vt):e},vt.duration=function(t){return arguments.length?(K=t,st.duration(t),vt):K},vt.delay=function(t){return arguments.length?(n=t,st.delay(t),vt):n},vt.valueFormat=function(t){return arguments.length?(ot=t,vt):ot},vt.xValueFormat=function(t){return arguments.length?(at=t,vt):at},vt.yValueFormat=function(t){return arguments.length?(it=t,vt):it},vt.seriesClick=function(t){return arguments.length?(lt=t,vt):lt},vt.vertical=function(t){return arguments.length?(Q=t,vt):Q},vt.allowScroll=function(t){return arguments.length?(tt=t,vt):tt},vt.hideEmptyGroups=function(t){return arguments.length?(et=t,vt):et},vt.overflowHandler=function(t){return arguments.length?(nt=zt.functor(t),vt):nt},vt}function M(){var e={barLegend:{close:"Hide bar legend",open:"Show bar legend",noLabel:"undefined"},lineLegend:{close:"Hide line legend",open:"Show line legend",noLabel:"undefined"}},tt={top:10,right:10,bottom:10,left:10},et=null,nt=null,rt=!1,at=!0,it="ltr",ot=!0,n=!1,r=0,a=0,u={},lt=c(e),d=function(t){return t.x},f=function(t){return t.y},i=zt.buildLocality(),st=Nt.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),h=function(t,e,n,r){return r?zt.dateFormat(n,"%x",bt.locality()):n},p=function(t,e,n,r){var a=2;return zt.numberFormatSI(t,2,r,bt.locality())},ct=p,ut=b().stacked(!0).clipEdge(!1).withLine(!0).nice(!1),dt=y().color(function(t,e){return"#FFF"}).fill(function(t,e){return"#FFF"}).useVoronoi(!1).nice(!1),ft=y().useVoronoi(!1).color("data").nice(!1),ht=v(),pt=v(),gt=z().align("left").position("middle"),mt=z().align("right").position("middle"),vt=null,l=function(t,e,n,r,a){return"<p><b>"+t+"</b></p><p><b>"+n+"</b></p><p><b>"+e+"%</b></p>"},s=function(t,e,n,r,a){return"<p><p>"+t+": <b>"+n+"</b></p>"},o=function(t,e,n,r,a){return"<p>"+r.key+": <b>"+n+"</b></p>"},g=function(t,e,n){var r=t.series.key,a=(100*t.point.y/n[t.pointIndex].t).toFixed(1),i=ft.y()(t.point,t.pointIndex),o="bar"===t.series.type?l(r,a,i,t,bt):s(r,a,i,t,bt);return xt.show(t.e,o,"s",null,e)},yt=function(t,e){var n=o(t.key,0,t.val,t,bt);return xt.show(t.e,n,"s",null,e)},m=function(t,e,n,r){};function bt(t){return t.each(function(t){var P=this,O=Nt.select(this),_="pareto",H=t&&t.properties||{},B=t&&t.data||null,R=parseInt(O.style("width"),10),V=parseInt(O.style("height"),10),G=Math.pow(6,2)*Math.PI,l="datetime"===H.xDataType||!1,a="currency"===H.yDataType||!1,s=ut.stacked()?72:32,e=function(t,e,n,r){var a=c&&Array.isArray(c)&&c[e]||t,i=h(t,e,a,l),o=Math.max(2*s,75);return r?i:zt.stringEllipsify(i,O,o)},n=function(t,e,n,r){return p(t,e,null,a)},W,Y;function r(t,e){var n=t&&t.length&&t.filter(function(t){return!t.disabled&&Array.isArray(t.values)&&t.values.length}).length,r=(R-tt.left-tt.right)/2+tt.left,a=(V-tt.top-tt.bottom)/2+tt.top;return zt.displayNoData(n,O,e||lt.noData,r,a)}if(bt.update=function(){O.transition().call(bt)},bt.container=this,r(B))return bt;bt.dataSeriesActivate=function(t){var e=t.series;e.active=e.active&&"inactive"!==e.active?"inactive":"active",e.values.map(function(t){t.active=e.active}),"active"===e.active&&B.filter(function(t){return"active"!==t.active}).map(function(t){return t.active="inactive",t.values.map(function(t){t.active="inactive"}),t}),B.filter(function(t){return"active"===t.active}).length||B.map(function(t){return t.active="",t.values.map(function(t){t.active=""}),O.selectAll(".sc-series").classed("sc-inactive",!1),t}),O.call(bt)},B.forEach(function(t,e){t._values||(t._values=t.values.map(function(t,e){return{x:Array.isArray(t)?t[0]:t.x,y:Array.isArray(t)?t[1]:t.y}}))});var q=B.filter(function(t){return!t.type||"bar"===t.type}).map(function(n,r){return n.seriesIndex=r,n.values=n._values.map(function(t,e){return{group:e,seriesIndex:n.seriesIndex,color:void 0!==n.color?n.color:"",x:ut.x()(t,e),y:ut.y()(t,e),y0:t.y+(0<r?B[n.seriesIndex-1].values[e].y0:0),active:void 0!==n.active?n.active:""}}),n.key=n.key||lt.noLabel,n.total=Nt.sum(n._values,function(t,e){return t.y}),n.disabled=n.disabled||0===n.total,n}).filter(function(t){return!t.disabled}).map(function(n,t){return n.seri=t,n.values.forEach(function(t,e){t.seri=n.seri}),n});if(r(q))return bt;var X=B.filter(function(t){return"line"===t.type}).map(function(n,t){return n.seriesIndex=t,ut.stacked()?(n.values.forEach(function(t){t.y=0}),q.map(function(t){t.values.map(function(t,e){n.values[e].y+=ut.y()(t,e)})}),n.values.forEach(function(t,e){0<e&&(t.y+=n.values[e-1].y)})):n.values=n._values.map(function(t,e){return{seriesIndex:n.seriesIndex,color:void 0!==n.color?n.color:"",x:ft.x()(t,e)+.25*(n.seriesIndex-e),y:ft.y()(t,e)}}),n}).filter(function(t){return!t.disabled}).map(function(n,t){return n.seri=t,n.values.forEach(function(t,e){t.seri=n.seri}),n}),i=H.groupData,c=i.map(function(t){return[].concat(t.l)[0]||lt.noLabel}),j=H.quota||0,K=H.quotaLabel||"",Z=H.targetQuota||0,U=H.targetQuotaLabel||"",$=B.filter(function(t){return!t.type||"bar"===t.type}),J=B.filter(function(t){return"line"===t.type});J.push({key:K,type:"dash",color:"#444",seriesIndex:J.length,values:{seriesIndex:J.length,x:0,y:0}}),0<Z&&J.push({key:U,type:"dash",color:"#777",seriesIndex:J.length,values:{seriesIndex:J.length+1,x:0,y:0}});var o=B.filter(function(t){return!t.disabled}).map(function(t){return t._values.map(function(t,e){return d(t,e)})}),Q=B.map(function(t){return t._values.map(function(t,e){return f(t,e)})});rt=rt&&H.title&&H.title.length,W=ut.xScale(),Y=ut.yScale(),ht.orient("bottom").scale(W).valueFormat(e).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),pt.orient("left").scale(Y).valueFormat(n).tickPadding(7).showMaxMin(!0),bt.render=function(){var t,e,n,r,a,i,o;R=parseInt(O.style("width"),10),V=parseInt(O.style("height"),10),e=nt||V||400,n=(t=et||R||960)-tt.left-tt.right,r=e-tt.top-tt.bottom,o=r-(a={top:0,right:0,bottom:0,left:0}).top-a.bottom,i=n-a.left-a.right;var l=0,s=0,c=0,u=0,d={width:0,height:0},f,h=O.selectAll("g.sc-chart-wrap").data([B]).enter().append("g").attr("class","sc-chart-wrap sc-chart-"+_),p=O.select(".sc-chart-wrap").merge(h);h.append("defs"),h.append("g").attr("class","sc-background-wrap");var g=p.select(".sc-background-wrap");h.append("g").attr("class","sc-title-wrap");var m=p.select(".sc-title-wrap");h.append("g").attr("class","sc-axis-wrap sc-axis-x");var v=p.select(".sc-axis-wrap.sc-axis-x");h.append("g").attr("class","sc-axis-wrap sc-axis-y");var y=p.select(".sc-axis-wrap.sc-axis-y");h.append("g").attr("class","sc-bars-wrap");var b=p.select(".sc-bars-wrap");h.append("g").attr("class","sc-quota-wrap");var x=p.select(".sc-quota-wrap");h.append("g").attr("class","sc-lines-wrap1");var w=p.select(".sc-lines-wrap1");h.append("g").attr("class","sc-lines-wrap2");var k=p.select(".sc-lines-wrap2");h.append("g").attr("class","sc-legend-wrap sc-bar-legend");var M=p.select(".sc-legend-wrap.sc-bar-legend");h.append("g").attr("class","sc-legend-wrap sc-line-legend");var A=p.select(".sc-legend-wrap.sc-line-legend");p.attr("transform",zt.translation(tt.left,tt.top)),h.select(".sc-background-wrap").append("rect").attr("x",-tt.left).attr("y",-tt.top).attr("width",t).attr("height",e).attr("fill","#FFF"),m.select(".sc-title").remove(),rt&&(m.append("text").attr("class","sc-title").attr("x","rtl"===it?n:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(H.title),d=zt.getTextBBox(m.select(".sc-title")),u+=d.height),at&&(gt.id("barlegend_"+bt.id()).strings(lt.barLegend).align("left").height(r-a.top),M.datum($).call(gt),l=gt.calcMaxWidth(),mt.id("linelegend_"+bt.id()).strings(lt.lineLegend).align("right").height(r-a.top),A.datum(J).call(mt),s=mt.calcMaxWidth(),c=n/(l+s),gt.arrange(Math.floor(c*l)),mt.arrange(Math.floor(c*s)),M.attr("transform","translate("+("rtl"===it?n-gt.width():0)+","+a.top+")"),A.attr("transform","translate("+("rtl"===it?0:n-mt.width())+","+a.top+")")),u+=Math.max(gt.height(),mt.height())+4,o=r-u-a.top-a.bottom;var I=Math.max(Nt.max(Nt.merge(Q)),j,Z||0),C=[0,10*Math.ceil(.1*I)];ut.width(i).height(o).forceY(C).id(bt.id()),b.datum(q).call(ut);var S=W(1)+W.bandwidth()/(ut.stacked()||1===X.length?2:4);dt.margin({top:0,right:S,bottom:0,left:S}).width(i).height(o).forceY(C).useVoronoi(!1).id("outline_"+bt.id()),ft.margin({top:0,right:S,bottom:0,left:S}).width(i).height(o).forceY(C).useVoronoi(!1).size(G).sizeRange([G,G]).sizeDomain([G,G]).id("foreground_"+bt.id()),w.datum(X).call(dt),k.datum(X).call(ft),v.call(ht),y.style("opacity",q.length?1:0).call(pt);var F=ht.margin(),D=pt.margin(),L=0,T=14;function E(){a.left=Math.max(L,F.left,D.left),a.right=Math.max(F.right,D.right),a.top=Math.max(F.top,D.top)+u,a.bottom=Math.max(F.bottom,D.bottom),N()}function N(){i=n-a.left-a.right,o=r-a.top-a.bottom,ut.resetDimensions(i,o)}x.selectAll("line").remove(),y.selectAll("text.sc-quota-value").remove(),y.selectAll("text.sc-target-quota-value").remove(),0<Z&&(x.append("line").attr("class","sc-quota-target").attr("x1",0).attr("y1",0).attr("x2",i).attr("y2",0).attr("transform","translate(0,"+Y(Z)+")").style("stroke-dasharray","8, 8"),x.append("line").datum({key:U,val:Z}).attr("class","sc-quota-target sc-quota-background").attr("x1",0).attr("y1",0).attr("x2",i).attr("y2",0).attr("transform","translate(0,"+Y(Z)+")"),y.append("text").text(ct(Z,2,!0)).attr("class","sc-target-quota-value").attr("dy",".36em").attr("dx","0").attr("text-anchor","rtl"===it?"start":"end").attr("transform","translate("+(0-pt.tickPadding())+","+Y(Z)+")"),L=Math.round(p.select("text.sc-target-quota-value").node().getBoundingClientRect().width+pt.tickPadding())),0<j&&(x.append("line").attr("class","sc-quota-line").attr("x1",0).attr("y1",0).attr("x2",i).attr("y2",0).attr("transform","translate(0,"+Y(j)+")").style("stroke-dasharray","8, 8"),x.append("line").datum({key:K,val:j}).attr("class","sc-quota-line sc-quota-background").attr("x1",0).attr("y1",0).attr("x2",i).attr("y2",0).attr("transform","translate(0,"+Y(j)+")"),y.append("text").text(ct(j,2,!0)).attr("class","sc-quota-value").attr("dy",".36em").attr("dx","0").attr("text-anchor","rtl"===it?"start":"end").attr("transform","translate("+-pt.tickPadding()+","+Y(j)+")"),L=Math.max(L,Math.round(p.select("text.sc-quota-value").node().getBoundingClientRect().width+pt.tickPadding()))),E(),ut.width(i).height(o),b.call(ut),v.call(ht),y.call(pt),S=W(1)+W.bandwidth()/(ut.stacked()?2:2*X.length),F=ht.margin(),D=pt.margin(),E();var z=zt.translation(a.left,a.top);ut.width(i).height(o),b.attr("transform",z).call(ut),dt.margin({top:0,right:S,bottom:0,left:S}).width(i).height(o),ft.margin({top:0,right:S,bottom:0,left:S}).width(i).height(o),w.attr("transform",z).call(dt),k.attr("transform",z).call(ft),x.attr("transform",z).selectAll("line").attr("x2",i),v.attr("transform","translate("+a.left+","+("bottom"===ht.orient()?o+a.top:a.top)+")").call(ht),pt.ticks(Math.ceil(o/48)).tickSize(-i,0),y.attr("transform","translate("+("left"===pt.orient()?a.left:a.left+i)+","+a.top+")").call(pt),0<Z&&(x.selectAll("line.sc-quota-target").attr("x2",i).attr("transform","translate(0,"+Y(Z)+")"),y.select("text.sc-target-quota-value").attr("transform","translate("+(0-pt.tickPadding())+","+Y(Z)+")"),T=Math.round(parseInt(p.select("text.sc-target-quota-value").node().getBoundingClientRect().height,10)/1.15),y.selectAll("g.tick, g.sc-axisMaxMin").each(function(t,e){Math.abs(Y(t)-Y(Z))<=T&&Nt.select(this).style("opacity",0)})),0<j&&(x.selectAll("line.sc-quota-line").attr("x2",i).attr("transform","translate(0,"+Y(j)+")"),y.select("text.sc-quota-value").attr("transform","translate("+(0-pt.tickPadding())+","+Y(j)+")"),T=Math.round(parseInt(p.select("text.sc-quota-value").node().getBoundingClientRect().height,10)/1.15),y.selectAll("g.tick, g.sc-axisMaxMin").each(function(t,e){Math.abs(Y(t)-Y(j))<=T&&Nt.select(this).style("opacity",0)}),0<Z&&Math.abs(Y(j)-Y(Z))<=T&&y.select(".sc-target-quota-value").style("opacity",0)),x.selectAll("line.sc-quota-background").on("mouseover",function(t){if(ot){var e={val:t.val,key:t.key,e:Nt.event};vt=yt(e,P.parentNode)}}).on("mousemove",function(){var t=Nt.event;st.call("tooltipMove",this,t)}).on("mouseout",function(){st.call("tooltipHide",this)})},bt.render(),gt.dispatch.on("legendClick",function(t,e){var n=t.seriesIndex;t.disabled=!t.disabled,bt.stacked()||B.filter(function(t){return t.seriesIndex===n&&"line"===t.type}).map(function(t){return t.disabled=!t.disabled,t}),B.filter(function(t){return!t.disabled&&"bar"===t.type}).length||B.map(function(t){return t.disabled=!1,t}),O.call(bt)}),st.on("tooltipShow",function(t){ot&&(vt=g(t,P.parentNode,i))}),st.on("tooltipMove",function(t){vt&&xt.position(P.parentNode,vt,t,"s")}),st.on("tooltipHide",function(){ot&&xt.cleanup()}),st.on("changeState",function(n){void 0!==n.disabled&&(B.forEach(function(t,e){t.disabled=n.disabled[e]}),u.disabled=n.disabled),void 0!==n.stacked&&(ut.stacked(n.stacked),u.stacked=n.stacked),O.transition().call(bt)}),st.on("chartClick",function(){gt.enabled()&&gt.dispatch.call("closeMenu",this),mt.enabled()&&mt.dispatch.call("closeMenu",this)}),ut.dispatch.on("elementClick",function(t){st.call("chartClick",this),m(B,t,bt,O)})}),bt}return ft.dispatch.on("elementMouseover.tooltip",function(t){st.call("tooltipShow",this,t)}),ft.dispatch.on("elementMousemove.tooltip",function(t){st.call("tooltipMove",this,t)}),ft.dispatch.on("elementMouseout.tooltip",function(){st.call("tooltipHide",this)}),ut.dispatch.on("elementMouseover.tooltip",function(t){st.call("tooltipShow",this,t)}),ut.dispatch.on("elementMousemove.tooltip",function(t){st.call("tooltipMove",this,t)}),ut.dispatch.on("elementMouseout.tooltip",function(){st.call("tooltipHide",this)}),bt.dispatch=st,bt.linesBackground=dt,bt.lines=ft,bt.multibar=ut,bt.barLegend=gt,bt.lineLegend=mt,bt.xAxis=ht,bt.xAxisLabel=ht.axisLabel,bt.yAxis=pt,bt.yAxisLabel=pt.axisLabel,bt.options=zt.optionsFunc.bind(bt),zt.rebind(bt,ut,"id","xScale","yScale","xDomain","yDomain","forceY","color","fill","classes","gradient"),zt.rebind(bt,ut,"stacked","showValues","valueFormat","nice","textureFill"),zt.rebind(bt,ht,"rotateTicks","staggerTicks","wrapTicks","reduceXTicks"),bt.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t){return zt.defaultColor()(t,t.seriesIndex)},a=function(t,e){return"sc-series sc-series-"+t.seriesIndex},i=function(t,e){var n=r.lineColor?r.lineColor:{c1:"#1A8221",c2:"#62B464",l:1};return t.color||Nt.interpolateHsl(Nt.rgb(n.c1),Nt.rgb(n.c2))(t.seriesIndex/2)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(e){case"graduated":n=function(t){return Nt.interpolateHsl(Nt.rgb(r.barColor.c1),Nt.rgb(r.barColor.c2))(t.seriesIndex/r.barColor.l)};break;case"class":n=function(){return"inherit"},a=function(t){var e=t.seriesIndex,n=e*(r.step||1)%14;return"sc-series sc-series-"+e+" sc-fill"+(n=(9<n?"":"0")+n)},o=function(t){var e=t.seriesIndex,n=e*(r.step||1)%14;return"sc-series sc-series-"+e+" sc-fill"+(n=(9<n?"":"0")+n)+" sc-stroke"+n};break;case"data":n=function(t){return t.classes?"inherit":t.color||zt.defaultColor()(t,t.seriesIndex)},a=function(t){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")},o=function(t){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var l=r.gradient?function(t){var e={orientation:r.orientation||"vertical",position:r.position||"middle"};return ut.gradientFill(t,t.seriesIndex,e)}:n;return ut.color(n),ut.fill(l),ut.classes(a),ft.color(i),ft.fill(i),ft.classes(o),gt.color(n),gt.classes(a),mt.color(i),mt.classes(o),bt},bt.x=function(t){return arguments.length?(d=t,ft.x(t),ut.x(t),bt):d},bt.y=function(t){return arguments.length?(f=t,ft.y(t),ut.y(t),bt):f},bt.margin=function(t){if(!arguments.length)return tt;for(var e in t)t.hasOwnProperty(e)&&(tt[e]=t[e]);return bt},bt.width=function(t){return arguments.length?(et=t,bt):et},bt.height=function(t){return arguments.length?(nt=t,bt):nt},bt.showTitle=function(t){return arguments.length?(rt=t,bt):rt},bt.showLegend=function(t){return arguments.length?(at=t,bt):at},bt.tooltipBar=function(t){return arguments.length?(l=t,bt):l},bt.tooltipLine=function(t){return arguments.length?(s=t,bt):s},bt.tooltipQuota=function(t){return arguments.length?(o=t,bt):o},bt.tooltips=function(t){return arguments.length?(ot=t,bt):ot},bt.clipEdge=function(t){return arguments.length?(n=t,ut.clipEdge(t),dt.clipEdge(t),ft.clipEdge(t),bt):n},bt.state=function(t){return arguments.length?(u=t,bt):u},bt.strings=function(t){return arguments.length?(t.barLegend||(t.barLegend=e.barLegend),t.lineLegend||(t.lineLegend=e.lineLegend),lt=c(t),gt.strings(lt.barLegend),mt.strings(lt.lineLegend),bt):lt},bt.direction=function(t){return arguments.length?(it=t,ut.direction(t),ht.direction(t),pt.direction(t),gt.direction(t),mt.direction(t),bt):it},bt.duration=function(t){return arguments.length?(a=t,ut.duration(t),dt.duration(t),ft.duration(t),bt):a},bt.delay=function(t){return arguments.length?(r=t,ut.delay(t),dt.delay(t),ft.delay(t),bt):r},bt.seriesClick=function(t){return arguments.length?(m=t,bt):m},bt.colorFill=function(t){return bt},bt.xValueFormat=function(t){return arguments.length?(h=t,bt):h},bt.yValueFormat=function(t){return arguments.length?(p=t,bt):p},bt.quotaValueFormat=function(t){return arguments.length?(ct=t,bt):ct},bt.locality=function(t){return arguments.length?(i=zt.buildLocality(t),ut.locality(t),dt.locality(t),bt):i},bt}function A(){var y={top:10,right:10,bottom:10,left:10},b=null,x=null,e="ltr",n=0,w=0,k=!0,M={},A=!0,I=c(),C=Nt.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),S=u(),F=s(),D=[],L=null,a=function(t,e){var n=S.getValue()(t),r=e.total?(100*n/e.total).toFixed(1):100,a="currency"===e.yDataType,i={key:S.fmtKey()(t),label:a?I.tooltip.amount:I.tooltip.count,value:zt.numberFormat(n,2,a,N.locality()),percent:zt.numberFormat(r,2,!1,N.locality())};return xt.single(i,I)},T=function(t,e,n){var r=a(t,n);return xt.show(t.e,r,null,null,e)},E=function(t,e,n){};function N(t){return t.each(function(t){var e=this,s=Nt.select(this),n="pie",r=t&&t.properties||{},a=t&&t.data||null,c=parseInt(s.style("width"),10),u=parseInt(s.style("height"),10),i="datetime"===r.xDataType||!1,o="currency"===r.yDataType||!1;function d(t,e){var n=t&&t.length,r=(c-y.left-y.right)/2+y.left,a=(u-y.top-y.bottom)/2+y.top;return zt.displayNoData(n,s,e||I.noData,r,a)}if(N.update=function(){s.transition().duration(w).call(N)},N.container=this,d(a))return N;N.setActiveState=function(t,e){t.active=e},N.clearActive=function(e){a.forEach(function(t){N.setActiveState(t,e||"")}),delete M.active},N.seriesActivate=function(t){var e=t.series||a[t.seriesIndex],n;e&&(A?(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"",N.clearActive("active"===n?"inactive":""),N.setActiveState(e,n),M.active=a.map(function(t){return"active"===t.active})):N.dataSeriesActivate({series:e}))},N.dataSeriesActivate=function(t){var e=t.series;e.active=e.active&&"inactive"!==e.active?"inactive":"active","active"===e.active&&a.filter(function(t){return"active"!==t.active}).forEach(function(t){return t.active="inactive",t}),a.filter(function(t){return"active"===t.active}).length||N.clearActive()},a.forEach(function(n,r){n.seriesIndex=r,n.values||(n.value?isNaN(n.value)||(n.values=[{x:0,y:parseInt(n.value,10)}]):n.values=[]),n.values.forEach(function(t,e){t.index=r,t.series=n,void 0===t.value&&(t.value=t.y)}),n.key=n.key||I.noLabel,n.value=n.value||Nt.sum(n.values,function(t){return t.value}),n.count=n.count||n.values.length,n.disabled=n.disabled||0===n.value});var f=a.filter(function(t){return!t.disabled});if(f.length||(f=[{values:[]}]),r.count=Nt.sum(f,function(t){return t.count}),r.total=Nt.sum(f,function(t){return t.value}),M.disabled=a.map(function(t){return!!t.disabled}),!r.total)return d(),N;F.chart(N).title(r.title).controlsData(D).legendData(a);var l,h=s.selectAll("g.sc-chart-wrap").data([f]).enter().append("g").attr("class","sc-chart-wrap sc-chart-pie"),p=s.select(".sc-chart-wrap").merge(h);h.append("defs");var g=p.select("defs");h.append("g").attr("class","sc-background-wrap");var m=p.select(".sc-background-wrap");h.append("g").attr("class","sc-title-wrap"),h.append("g").attr("class","sc-pie-wrap");var v=p.select(".sc-pie-wrap");h.append("g").attr("class","sc-controls-wrap"),h.append("g").attr("class","sc-legend-wrap"),p.attr("transform",zt.translation(y.left,y.top)),h.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-y.left).attr("y",-y.top).attr("fill","#FFF"),N.render=function(){var t,e,n,r,a,i,o,l;if(c=parseInt(s.style("width"),10),u=parseInt(s.style("height"),10),e=x||u||400,n=(t=b||c||960)-y.left-y.right,r=e-y.top-y.bottom,i=n-(a={top:0,right:0,bottom:0,left:0}).left-a.right,o=r-a.top-a.bottom,m.select(".sc-background").attr("width",t).attr("height",e),F.width(n).height(r),s.call(F),l=F.getHeight(),a.top+=l,(o=r-a.top-a.bottom)<100)return d(null,I.displayError),N;S.width(i).height(o),v.datum(f).attr("transform",zt.translation(a.left,a.top)).transition().duration(w).call(S)},N.render(),F.legend.dispatch.on("legendClick",function(t,e){t.disabled=!t.disabled,t.active=!1,a.filter(function(t){return!t.disabled}).length||a.forEach(function(t){t.disabled=!1}),a.filter(function(t){return"active"===t.active}).length||a.forEach(function(t){t.active=""}),M.disabled=a.map(function(t){return!!t.disabled}),C.call("stateChange",this,M),N.update()}),C.on("tooltipShow",function(t){k&&(L=T(t,e.parentNode,r))}),C.on("tooltipMove",function(t){L&&xt.position(e.parentNode,L,t)}),C.on("tooltipHide",function(){k&&xt.cleanup()}),C.on("changeState",function(n){void 0!==n.disabled&&(f.forEach(function(t,e){t.disabled=n.disabled[e]}),M.disabled=n.disabled),N.update()}),C.on("chartClick",function(){F.controls.enabled()&&F.controls.dispatch.call("closeMenu",this),F.legend.enabled()&&F.legend.dispatch.call("closeMenu",this)}),S.dispatch.on("elementClick",function(t){C.call("chartClick",this),E(a,t,N)})}),N}return F.showTitle(!0).showControls(!1).showLegend(!0).alignLegend("center"),S.dispatch.on("elementMouseover.tooltip",function(t){C.call("tooltipShow",this,t)}),S.dispatch.on("elementMousemove.tooltip",function(t){C.call("tooltipMove",this,t)}),S.dispatch.on("elementMouseout.tooltip",function(){C.call("tooltipHide",this)}),N.dispatch=C,N.pie=S,N.legend=F.legend,N.controls=F.controls,N.options=zt.optionsFunc.bind(N),zt.rebind(N,S,"id","color","fill","classes","gradient","locality","textureFill"),zt.rebind(N,S,"getKey","getValue","getCount","fmtKey","fmtValue","fmtCount"),zt.rebind(N,S,"showLabels","showLeaders","donutLabelsOutside","pieLabelsOutside","labelThreshold"),zt.rebind(N,S,"arcDegrees","rotateDegrees","minRadius","maxRadius","fixedRadius","startAngle","endAngle","donut","hole","holeFormat","donutRatio"),zt.rebind(N,F,"showTitle","showControls","showLegend"),N.colorData=function(t){var e=t,r=arguments[1]||{},n=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},a=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(e){case"graduated":n=function(t,e){return Nt.interpolateHsl(Nt.rgb(r.c1),Nt.rgb(r.c2))(t.seriesIndex/r.l)};break;case"class":n=function(){return"inherit"},a=function(t,e){var n=t.seriesIndex*(r.step||1)%14;return n=(9<n?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n+" sc-stroke"+n};break;case"data":n=function(t,e){return zt.defaultColor()(t,t.seriesIndex)},a=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var i=r.gradient?function(t,e){return S.gradientFill(t,t.seriesIndex)}:n;return S.color(n),S.fill(i),S.classes(a),F.legend.color(n),F.legend.classes(a),N},N.margin=function(t){if(!arguments.length)return y;for(var e in t)t.hasOwnProperty(e)&&(y[e]=t[e]);return N},N.width=function(t){return arguments.length?(b=t,N):b},N.height=function(t){return arguments.length?(x=t,N):x},N.tooltips=function(t){return arguments.length?(k=t,N):k},N.tooltipContent=function(t){return arguments.length?(a=t,N):a},N.state=function(t){return arguments.length?(M=t,N):M},N.strings=function(t){return arguments.length?(I=c(t),F.strings(I),N):I},N.direction=function(t){return arguments.length?(e=t,S.direction(t),F.direction(t),N):e},N.duration=function(t){return arguments.length?(w=t,S.duration(t),N):w},N.delay=function(t){return arguments.length?(n=t,S.delay(t),N):n},N.seriesClick=function(t){return arguments.length?(E=t,N):E},N}function I(){var p={top:10,right:10,bottom:10,left:10},e=null,n=null,L=6,T=0,g={min:.25,max:2},E={width:100,height:50},r="../img/",N=function(t){return'<div class="sc-tree-node"></div>'},z=function(t){},P=function(t){},O=function(t){},_=!1,H=Math.floor(1e4*Math.random()),a=function(t,e){return zt.defaultColor()(t,e)},i=function(t,e){return a(t,e)},B=function(t,e){t.y=e},R=function(t,e){t.data.x0=e},V=function(t,e){t.data.y0=e},G=function(t){return _?t.y:t.x},W=function(t){return _?t.x:t.y},Y=function(t){return _?t.data.y0:t.data.x0},q=function(t){return _?t.data.x0:t.data.y0},X=function(t){return t.id||t.data.id},j=function(t){return"card-"+X(t)},o=!1,K=!0,l=!0,t=Nt.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");function Z(t){return t.each(function(t){var s=Nt.select(this),m=t,v=Nt.transition("tree").duration(T).ease(Nt.easeLinear),y=null,b=null,x=null,d=null,e=Nt.tree().size([null,null]).nodeSize([_?E.height:E.width,1]).separation(function t(e,n){return e.parent,n.parent,1}),c={width:parseInt(s.style("width"),10)-p.left-p.right,height:parseInt(s.style("height"),10)-p.top-p.bottom},n,r=s.selectAll("g.sc-chart-wrap").data([1]).enter().append("g").attr("class","sc-chart-wrap sc-chart-tree"),f=s.select(".sc-chart-wrap").merge(r),a=r.append("defs"),w=f.select("defs").merge(a),k=zt.dropShadow("node_back_"+H,w,{blur:2});a.append("clipPath").attr("id","sc-edge-clip-"+H).append("rect");var u=w.select("#sc-edge-clip-"+H+" rect");u.attr("width",c.width).attr("height",c.height).attr("x",p.left).attr("y",p.top),f.attr("clip-path",K?"url(#sc-edge-clip-"+H+")":""),r.append("rect").attr("class","sc-chart-background").attr("width",c.width).attr("height",c.height).attr("transform",zt.translation(p.left,p.top)).style("fill","transparent");var h=f.select(".sc-chart-background"),i=r.append("g").attr("class","sc-tree-wrap"),o=f.select(".sc-tree-wrap");i.append("g").attr("class","sc-wrap sc-tree");var M=f.select(".sc-wrap.sc-tree");function A(t){y=Nt.hierarchy(t,function(t){return t.children}),e(y),(b=y.descendants()).forEach(function(t){B(t,2*t.depth*(_?E.width:E.height))}),x=b.slice(1)}function I(t){R(t,G(t)),V(t,W(t)),t.children&&t.children.length&&t.children.forEach(I)}function C(t,e){var n=W(t)-(_?0:E.height-3*L),r=G(t)-(_?E.width-2*L:0),a=W(e),i=G(e),o,l,s,c;return"M"+r+","+n+"C"+(_?(r+i)/2:r)+","+(_?n:(n+a)/2)+" "+(_?(r+i)/2:i)+","+(_?a:(n+a)/2)+" "+i+","+a}function l(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null)}function S(t){l(t.data),Z.update(t)}function F(t){var e;return"node-"+X(t)}function D(t){var e;return"link-"+(t.parent?X(t.parent):0)+"-"+X(t)}Z.setZoom=function(){d=Nt.zoom().scaleExtent([g.min,g.max]).on("zoom",function(){o.attr("transform","translate("+Nt.event.transform.x+","+Nt.event.transform.y+")scale("+Nt.event.transform.k+")"),z(Nt.event.transform.k)})},Z.unsetZoom=function(t){d.on("zoom",null)},Z.resetZoom=function(){f.call(d.transform,Nt.zoomIdentity)},Z.orientation=function(t){_="horizontal"===t||!_,e.nodeSize([_?E.height:E.width,1]),Z.update(y)},Z.showall=function(){function e(t){t._children&&t._children.length&&(t.children=t._children,t._children=null),t.children&&t.children.length&&t.children.forEach(e)}e(m=t),Z.update(y)},Z.zoomStep=function(t){var e,n=Nt.zoomTransform(f.node()).k+t;return this.zoomLevel(n)},Z.zoomLevel=function(t){var e=Nt.zoomTransform(f.node()),n=Math.min(Math.max(t,g.min),g.max),r=e.k,a=[e.x,e.y],i=h.node().getBoundingClientRect(),o=[i.width,i.height],l=[(o[0]-o[0]*n)/2,(o[1]-o[1]*n)/2],s=[n*(a[0]-(o[0]-o[0]*r)/2)/r,n*(a[1]-(o[1]-o[1]*r)/2)/r],c=[l[0]+s[0],l[1]+s[1]],u=Nt.zoomIdentity.translate(c[0],c[1]).scale(n);return f.call(d.transform,u),n},Z.zoomScale=function(){var t;return Nt.zoomTransform(f.node()).k},Z.filter=function(e){var n=!1;function r(t){X(t)===e?(m=t,n=!0):!n&&t.children&&t.children.forEach(r)}r(t),Z.update(y)},Z.update=function(n){var e={x:0,y:0};function t(t){if(X(n)===X(y))return C(y,y);var e={x:Y(n),y:q(n)};return C(e,e)}function r(t){return C(t,t.parent)}function a(){return C(e,e)}A(m);var i=(_?L-E.width:E.width/-2)+"px",o=(_?(L-E.height)/2:2*L-E.height)+"px",l=M.selectAll("g.sc-card").data(b,X),s,c,u,d,f;(s=l.enter().insert("g").attr("class","sc-card").attr("id",F).attr("opacity",function(t){return X(n)===X(t)?1:0}).attr("transform",function(t){return X(n)===X(y)?"translate("+G(y)+","+W(y)+")":"translate("+(_?q(n):Y(n))+","+(_?Y(n):q(n))+")"})).each(function(t){var e,n;w.select("#"+j(t)).empty()&&(n=(e=w.append("svg").attr("class","sc-foreign-object").attr("id",j(t)).attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("x",i).attr("y",o).attr("width",E.width+"px").attr("height",E.height+"px").attr("viewBox","0 0 "+E.width+" "+E.height).attr("xml:space","preserve")).append("g").attr("class","sc-tree-node-content").attr("transform","translate("+L+","+L+")"),N(n,t,E.width-2*L,E.height-3*L))}),s.append("use").attr("xlink:href",function(t){return"#"+j(t)}).attr("filter",k).on("click",O),(c=M.selectAll("g.sc-card").merge(s)).transition(v).duration(T).attr("opacity",1).attr("transform",function(t){return X(n)===X(t)&&(e={x:_?W(t):G(t),y:_?G(t):W(t)}),"translate("+G(t)+","+W(t)+")"}).on("end",P),(u=l.exit().transition(v).duration(T).attr("opacity",0).attr("transform",function(t){return"translate("+Y(n)+","+q(n)+")"}).remove()).selectAll(".sc-expcoll").style("stroke-opacity",1e-6),w.selectAll(".sc-foreign-object").attr("x",i).attr("y",o),(d=s.append("g").attr("class","sc-expcoll").style("opacity",1e-6).on("click",S)).append("circle").attr("class","sc-circ-back").attr("r",L),d.append("line").attr("class","sc-line-vert").attr("x1",0).attr("y1",.5-L).attr("x2",0).attr("y2",L-.5).style("stroke","#bbb"),d.append("line").attr("class","sc-line-hrzn").attr("x1",.5-L).attr("y1",0).attr("x2",L-.5).attr("y2",0).style("stroke","#fff"),(f=M.selectAll("g.sc-expcoll").merge(d)).style("opacity",function(t){return t.data.children&&t.data.children.length||t.data._children&&t.data._children.length?1:0}),f.select(".sc-circ-back").style("fill",function(t){return t.data._children&&t.data._children.length?"#777":t.data.children?"#bbb":"none"}),f.select(".sc-line-vert").style("stroke",function(t){return t.data._children&&t.data._children.length?"#fff":"#bbb"});var h=M.selectAll("path.link").data(x,D),p=h.enter().insert("path","g").attr("d",t).attr("class","link").attr("id",D).attr("opacity",0),g;(g=M.selectAll("path.link").merge(p)).transition(v).duration(T).attr("d",r).attr("opacity",1),h.exit().transition(v).duration(T).attr("d",a).attr("opacity",0).remove(),I(y),Z.resize(X(n)===X(y))},Z.render=function(){Z.resize(!0)},Z.resize=function(t){t=void 0===t||t,Z.resetZoom(),c={width:parseInt(s.style("width"),10)-p.left-p.right,height:parseInt(s.style("height"),10)-p.top-p.bottom};var e=[Math.abs(Nt.min(b,G))+Math.abs(Nt.max(b,G))+E.width,Math.abs(Nt.min(b,W))+Math.abs(Nt.max(b,W))+E.height],n=c.width/e[0],r=c.height/e[1],a=Nt.min([n,r]),i=[Math.abs(Nt.min(b,G))+(n<r?0:(c.width/a-e[0])/2),Math.abs(Nt.min(b,W))+(n<r?(c.height/a-e[1])/2:0)],o=[E.width/(_?1:2),E.height/(_?2:1)],l=[(i[0]+o[0])*a+p.left/(_?2:1),(i[1]+o[1])*a+p.top/(_?1:2)];u.attr("width",c.width).attr("height",c.height),h.attr("width",c.width).attr("height",c.height),M.transition(v).duration(t?0:T).attr("transform","translate("+l+")scale("+a+")")},Z.setZoom(),f.call(d),A(m),I(y),Z.update(y)}),Z}return Z.dispatch=t,Z.options=zt.optionsFunc.bind(Z),Z.id=function(t){return arguments.length?(H=t,Z):H},Z.margin=function(t){return arguments.length?(p=t,Z):p},Z.width=function(t){return arguments.length?(e=t,Z):e},Z.height=function(t){return arguments.length?(n=t,Z):n},Z.x=function(t){return arguments.length?(G=t,Z):G},Z.y=function(t){return arguments.length?(W=zt.functor(t),Z):W},Z.showLabels=function(t){return arguments.length?(l=t,Z):l},Z.color=function(t){return arguments.length?(a=t,Z):a},Z.fill=function(t){return arguments.length?(i=t,Z):i},Z.useClass=function(t){return arguments.length?(o=t,Z):o},Z.radius=function(t){return arguments.length?(L=t,Z):L},Z.duration=function(t){return arguments.length?(T=t,Z):T},Z.zoomExtents=function(t){return arguments.length?(g=t,Z):g},Z.zoomCallback=function(t){return arguments.length?(z=t,Z):z},Z.nodeSize=function(t){return arguments.length?(E=t,Z):E},Z.nodeImgPath=function(t){return arguments.length?(r=t,Z):r},Z.nodeRenderer=function(t){return arguments.length?(N=t,Z):N},Z.nodeCallback=function(t){return arguments.length?(P=t,Z):P},Z.nodeClick=function(t){return arguments.length?(O=t,Z):O},Z.horizontal=function(t){return arguments.length?(_=t,Z):_},Z.getId=function(t){return arguments.length?(X=t,Z):X},Z.getCardId=function(t){return arguments.length?(j=t,Z):j},Z}function C(){var g={top:10,right:10,bottom:10,left:10},m=null,v=null,e="ltr",n=0,y=0,b=!0,o="default",l=Nt.scaleOrdinal(Nt.schemeCategory20).range().map(zt.identity),x=c(),w=Nt.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","elementMousemove"),a=function(t,e){var n;return"<h3>"+t.data.name+"</h3><p>"+zt.numberFormatSI(t.value)+"</p>"},k=function(t,e,n){},M=f(),A=s(),I=[],C=null,S=function(t,e,n){var r=a(t.point,n);return xt.show(t.e,r,null,null,e)};function F(t){return t.each(function(t){var e=this,s=Nt.select(this),n="treemap",r={},a=[t],c=parseInt(s.style("width"),10),u=parseInt(s.style("height"),10);function d(t,e){var n=t&&t.length&&t.filter(function(t){return t&&t.children&&t.children.length}).length,r=(c-g.left-g.right)/2+g.left,a=(u-g.top-g.bottom)/2+g.top;return zt.displayNoData(n,s,e||x.noData,r,a)}if(F.update=function(){s.transition().duration(y).call(F)},F.setActiveState=function(t,e){t.active=e},F.clearActive=function(t){var e=t||a;e.children&&e.children.forEach(function(t){F.setActiveState(t,"")})},F.cellActivate=function(t){var e=t.d,n;e&&(n=void 0===e.active||"inactive"===e.active||""===e.active?"active":"",F.clearActive(e.parent),e.active=n,F.render())},F.container=this,d(a))return F;var f=a.filter(function(t){return!t.disabled});if(!f.length)return d(),F;A.chart(F).title(r.title).controlsData(I).legendData(a);var i,o=s.selectAll("g.sc-chart-wrap").data([f]).enter().append("g").attr("class","sc-chart-wrap sc-chart-"+n),l=s.select(".sc-chart-wrap").merge(o);o.append("defs"),o.append("g").attr("class","sc-background-wrap");var h=l.select(".sc-background-wrap");o.append("g").attr("class","sc-title-wrap"),o.append("g").attr("class","sc-treemap-wrap");var p=l.select(".sc-treemap-wrap");o.append("g").attr("class","sc-controls-wrap"),o.append("g").attr("class","sc-legend-wrap"),l.attr("transform",zt.translation(g.left,g.top)),o.select(".sc-background-wrap").append("rect").attr("class","sc-background").attr("x",-g.left).attr("y",-g.top).attr("fill","#FFF"),F.render=function(){var t,e,n,r,a,i,o,l;if(c=parseInt(s.style("width"),10),u=parseInt(s.style("height"),10),e=v||u||400,n=(t=m||c||960)-g.left-g.right,r=e-g.top-g.bottom,i=n-(a={top:0,right:0,bottom:0,left:0}).left-a.right,o=r-a.top-a.bottom,h.select(".sc-background").attr("width",t).attr("height",e),A.width(n).height(r),s.call(A),l=A.getHeight(),(o=r-a.top-a.bottom)<100)return d(null,x.displayError),F;M.width(i).height(o),p.datum(f).attr("transform",zt.translation(a.left,a.top)).transition().duration(y).call(M)},F.render(),A.legend.dispatch.on("legendClick",function(t,e){t.disabled=!t.disabled,a.filter(function(t){return!t.disabled}).length||a.forEach(function(t){t.disabled=!1}),F.update()}),w.on("tooltipShow",function(t){b&&(C=S(t,e.parentNode))}),w.on("tooltipMove",function(t){C&&xt.position(e.parentNode,C,t)}),w.on("tooltipHide",function(){b&&xt.cleanup()}),M.dispatch.on("chartClick",function(t){t.children&&F.clearActive(t)}),M.dispatch.on("elementClick",function(t){k(a,t,F)})}),F}return A.showTitle(!0).showControls(!1).showLegend(!1),M.dispatch.on("elementMouseover.tooltip",function(t){w.call("tooltipShow",this,t)}),M.dispatch.on("elementMousemove.tooltip",function(t){w.call("tooltipMove",this,t)}),M.dispatch.on("elementMouseout.tooltip",function(){w.call("tooltipHide",this)}),F.dispatch=w,F.treemap=M,F.legend=A.legend,F.options=zt.optionsFunc.bind(F),zt.rebind(F,M,"id","color","fill","classes","gradient"),zt.rebind(F,M,"leafClick","getValue","getKey","textureFill"),zt.rebind(F,A,"showTitle","showControls","showLegend"),F.colorData=function(t){if(!arguments.length)return o;var r=t,a=arguments[1]||{},e=function(t,e){var n="data"===r&&t.color?{color:t.color}:{};return zt.getColor(l)(n,e)},n=function(t,e){return"sc-child"};switch(r){case"graduated":e=function(t,e,n){return Nt.interpolateHsl(Nt.rgb(a.c1),Nt.rgb(a.c2))(e/n)};break;case"class":e=function(){return"inherit"},n=function(t,e){var n=e*(a.step||1)%14;return n=(9<n?"":"0")+n,"sc-child "+(t.className||"sc-fill"+n)}}var i=a.gradient?function(t,e){var n={orientation:a.orientation||"horizontal",position:a.position||"base"};return M.gradientFill(t,e,n)}:e;return M.color(e),M.fill(i),M.classes(n),A.legend.color(e),A.legend.classes(n),o=t,F},F.margin=function(t){if(!arguments.length)return g;for(var e in t)t.hasOwnProperty(e)&&(g[e]=t[e]);return F},F.width=function(t){return arguments.length?(m=t,F):m},F.height=function(t){return arguments.length?(v=t,F):v},F.tooltips=function(t){return arguments.length?(b=t,F):b},F.tooltipContent=function(t){return arguments.length?(a=t,F):a},F.strings=function(t){return arguments.length?(x=c(t),A.strings(x),F):x},F.direction=function(t){return arguments.length?(e=t,M.direction(t),A.direction(t),F):e},F.duration=function(t){return arguments.length?(y=t,M.duration(t),F):y},F.delay=function(t){return arguments.length?(n=t,M.delay(t),F):n},F.seriesClick=function(t){return arguments.length?(k=t,F):k},F}var S={areaChart:h,bubbleChart:p,funnelChart:g,gaugeChart:m,globeChart:x,lineChart:w,multibarChart:k,paretoChart:M,pieChart:A,treeChart:I,treemapChart:C},F="0.8.2",D="scr",L=!1;t.version=F,t.build=D,t.development=L,t.utility=zt,t.tooltip=xt,t.language=c,t.models=n,t.charts=S,t.transform=yt,Object.defineProperty(t,"__esModule",{value:!0})});
